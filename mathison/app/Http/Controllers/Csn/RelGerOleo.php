<?php

namespace App\Http\Controllers\Csn;

use App\Http\Controllers\Controller;
use Illuminate\Support\Facades\Request;
use Illuminate\Support\Collection;
use App\Http\Requests;
use DB;
use App\Models\Tecnica;
use App\Models\Preditiva_analises;
use App\Models\Negocios;
use App\Models\Status;
use App\Models\Diagnosticos;
use App\Models\Preditiva_atividades;
use Carbon\Carbon;
use App\Http\Controllers\Csn\AuxFunc as aux;

class RelGerOleo extends Controller {
  /**
   * Display a listing of the resource.
   *
   * @return \Illuminate\Http\Response
  */
    public function GeralPerfil() {

    $title = 'Perfil | GGOP PR';
    $atual1 = Carbon::now()->subMonths(-1)->format('Y-m-01');

    // ============================================================ GGOP PR
    $manutencao = aux::GeralAnormalidadesTE($atual1)->where('status_id', '=', 1)->count();
    $standBy = aux::GeralAnormalidadesTE($atual1)->where('status_id', '=', 2)->count();
    $normal = aux::GeralAnormalidadesTE($atual1)->where('status_id', '=', 3)->count();
    $alarme = aux::GeralAnormalidadesTE($atual1)->where('status_id', '=', 4)->count();
    $critico = aux::GeralAnormalidadesTE($atual1)->where('status_id', '=', 5)->count();

    if($manutencao == null){$manutencao = 0;}
    if($standBy == null){$standBy = 0;}
    if($normal == null){$normal = 0;}
    if($alarme == null){$alarme = 0;}
    if($critico == null){$critico = 0;}

    $sum = Preditiva_atividades::where('tecnicas_id', '=', 4)->count();
    $manutencaoP_format = ($manutencao / $sum)*100;
    $manutencaoP = number_format($manutencaoP_format,2,".",",");
    $standByP_format = ($standBy / $sum)*100;
    $standByP = number_format($standByP_format,2,".",",");
    $normalP_format = ($normal / $sum)*100;
    $normalP = number_format($normalP_format,2,".",",");
    $alarmeP_format = ($alarme / $sum)*100;
    $alarmeP = number_format($alarmeP_format,2,".",",");
    $criticoP_format = ($critico / $sum)*100;
    $criticoP = number_format($criticoP_format,2,".",",");

    // ============================================================ UNIDADE DE REGENERAÇÃO DE ÁCIDO
    $ura_linha1 = 11;
    $ura_linha2 = 0;

    $ura_manutencao = aux::GeralPorLinhaTE($atual1, 1, $ura_linha1, $ura_linha2);
    $ura_standBy = aux::GeralPorLinhaTE($atual1, 2, $ura_linha1, $ura_linha2);
    $ura_normal = aux::GeralPorLinhaTE($atual1, 3, $ura_linha1, $ura_linha2);
    $ura_alarme = aux::GeralPorLinhaTE($atual1, 4, $ura_linha1, $ura_linha2);
    $ura_critico = aux::GeralPorLinhaTE($atual1, 5, $ura_linha1, $ura_linha2);
    if($ura_manutencao == null){$ura_manutencao = 0;}
    if($ura_standBy == null){$ura_standBy = 0;}
    if($ura_normal == null){$ura_normal = 0;}
    if($ura_alarme == null){$ura_alarme = 0;}
    if($ura_critico == null){$ura_critico = 0;}

    $ura_sum1 = DB::table('preditiva_atividades')
               ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
               ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
               ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
               ->where('negocios.id','=',11)
               ->where('preditiva_atividades.tecnicas_id', '=', 1)
               ->count('preditiva_atividades.id');

    $ura_sum2 = DB::table('preditiva_atividades')
               ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
               ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
               ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
               ->where('negocios.id','=',0)
               ->where('preditiva_atividades.tecnicas_id', '=', 1)
               ->count('preditiva_atividades.id');

    $ura_sum = $ura_sum1+$ura_sum2;
    $ura_manutencaoP_format = ($ura_manutencao / $ura_sum)*100;
    $ura_manutencaoP = number_format($ura_manutencaoP_format,2,".",",");
    $ura_standByP_format = ($ura_standBy / $ura_sum)*100;
    $ura_standByP = number_format($ura_standByP_format,2,".",",");
    $ura_normalP_format = ($ura_normal / $ura_sum)*100;
    $ura_normalP = number_format($ura_normalP_format,2,".",",");
    $ura_alarmeP_format = ($ura_alarme / $ura_sum)*100;
    $ura_alarmeP = number_format($ura_alarmeP_format,2,".",",");
    $ura_criticoP_format = ($ura_critico / $ura_sum)*100;
    $ura_criticoP = number_format($ura_criticoP_format,2,".",",");

    // ============================================================ LINHA DE DECAPAGEM SEMICONTÍNUA
    $lds_linha1 = 10;
    $lds_linha2 = 22;

    $lds_manutencao = aux::GeralPorLinhaTE($atual1, 1, $lds_linha1, $lds_linha2);
    $lds_standBy = aux::GeralPorLinhaTE($atual1, 2, $lds_linha1, $lds_linha2);
    $lds_normal = aux::GeralPorLinhaTE($atual1, 3, $lds_linha1, $lds_linha2);
    $lds_alarme = aux::GeralPorLinhaTE($atual1, 4, $lds_linha1, $lds_linha2);
    $lds_critico = aux::GeralPorLinhaTE($atual1, 5, $lds_linha1, $lds_linha2);
    if($lds_manutencao == null){$lds_manutencao = 0;}
    if($lds_standBy == null){$lds_standBy = 0;}
    if($lds_normal == null){$lds_normal = 0;}
    if($lds_alarme == null){$lds_alarme = 0;}
    if($lds_critico == null){$lds_critico = 0;}

    $lds_sum1 = DB::table('preditiva_atividades')
                ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                ->where('negocios.id','=', 10)
                ->where('preditiva_atividades.tecnicas_id', '=', 4)
                ->count('preditiva_atividades.id');

    $lds_sum2 = DB::table('preditiva_atividades')
                ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                ->where('negocios.id','=', 22)
                ->where('preditiva_atividades.tecnicas_id', '=', 4)
                ->count('preditiva_atividades.id');

    $lds_sum = $lds_sum1+$lds_sum2;

    $lds_manutencaoP_format = ($lds_manutencao / $lds_sum)*100;
    $lds_manutencaoP = number_format($lds_manutencaoP_format,2,".",",");
    $lds_standByP_format = ($lds_standBy / $lds_sum)*100;
    $lds_standByP = number_format($lds_standByP_format,2,".",",");
    $lds_normalP_format = ($lds_normal / $lds_sum)*100;
    $lds_normalP = number_format($lds_normalP_format,2,".",",");
    $lds_alarmeP_format = ($lds_alarme / $lds_sum)*100;
    $lds_alarmeP = number_format($lds_alarmeP_format,2,".",",");
    $lds_criticoP_format = ($lds_critico / $lds_sum)*100;
    $lds_criticoP = number_format($lds_criticoP_format,2,".",",");

    // ============================================================ LINHA DE LAMINAÇÃO A FRIO
    $lrf_linha1 = 12;
    $lrf_linha2 = 0;

    $lrf_manutencao = aux::GeralPorLinhaTE($atual1, 1, $lrf_linha1, $lrf_linha2);
    $lrf_standBy = aux::GeralPorLinhaTE($atual1, 2, $lrf_linha1, $lrf_linha2);
    $lrf_normal = aux::GeralPorLinhaTE($atual1, 3, $lrf_linha1, $lrf_linha2);
    $lrf_alarme = aux::GeralPorLinhaTE($atual1, 4, $lrf_linha1, $lrf_linha2);
    $lrf_critico = aux::GeralPorLinhaTE($atual1, 5, $lrf_linha1, $lrf_linha2);
    if($lrf_manutencao == null){$lrf_manutencao = 0;}
    if($lrf_standBy == null){$lrf_standBy = 0;}
    if($lrf_normal == null){$lrf_normal = 0;}
    if($lrf_alarme == null){$lrf_alarme = 0;}
    if($lrf_critico == null){$lrf_critico = 0;}

    $lrf_sum1 = DB::table('preditiva_atividades')
               ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
               ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
               ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
               ->where('negocios.id','=', 12)
               ->where('preditiva_atividades.tecnicas_id', '=', 4)
               ->count('preditiva_atividades.id');

    $lrf_sum2 = DB::table('preditiva_atividades')
               ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
               ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
               ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
               ->where('negocios.id','=', 0)
               ->where('preditiva_atividades.tecnicas_id', '=', 4)
               ->count('preditiva_atividades.id');

    $lrf_sum = $lrf_sum1+$lrf_sum2;
    $lrf_manutencaoP_format = ($lrf_manutencao / $lrf_sum)*100;
    $lrf_manutencaoP = number_format($lrf_manutencaoP_format,2,".",",");
    $lrf_standByP_format = ($lrf_standBy / $lrf_sum)*100;
    $lrf_standByP = number_format($lrf_standByP_format,2,".",",");
    $lrf_normalP_format = ($lrf_normal / $lrf_sum)*100;
    $lrf_normalP = number_format($lrf_normalP_format,2,".",",");
    $lrf_alarmeP_format = ($lrf_alarme / $lrf_sum)*100;
    $lrf_alarmeP = number_format($lrf_alarmeP_format,2,".",",");
    $lrf_criticoP_format = ($lrf_critico / $lrf_sum)*100;
    $lrf_criticoP = number_format($lrf_criticoP_format,2,".",",");

    // ============================================================ UTILIDADES
    $uti_parent = 7;
    $uti_manutencao = aux::GeralPorLinha2TE($atual1, 1, $uti_parent);
    $uti_standBy = aux::GeralPorLinha2TE($atual1, 2, $uti_parent);
    $uti_normal = aux::GeralPorLinha2TE($atual1, 3, $uti_parent);
    $uti_alarme = aux::GeralPorLinha2TE($atual1, 4, $uti_parent);
    $uti_critico = aux::GeralPorLinha2TE($atual1, 5, $uti_parent);
    if($uti_manutencao == null){$uti_manutencao = 0;}
    if($uti_standBy == null){$uti_standBy = 0;}
    if($uti_normal == null){$uti_normal = 0;}
    if($uti_alarme == null){$uti_alarme = 0;}
    if($uti_critico == null){$uti_critico = 0;}

   $uti_sum = DB::table('preditiva_atividades')
               ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
               ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
               ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
               ->where('negocios.parent_id', '=', 7)
               ->where('preditiva_atividades.tecnicas_id', '=', 4)
               ->count('preditiva_atividades.id');

   $uti_manutencaoP_format = ($uti_manutencao / $uti_sum)*100;
   $uti_manutencaoP = number_format($uti_manutencaoP_format,2,".",",");
   $uti_standByP_format = ($uti_standBy / $uti_sum)*100;
   $uti_standByP = number_format($uti_standByP_format,2,".",",");
   $uti_normalP_format = ($uti_normal / $uti_sum)*100;
   $uti_normalP = number_format($uti_normalP_format,2,".",",");
   $uti_alarmeP_format = ($uti_alarme / $uti_sum)*100;
   $uti_alarmeP = number_format($uti_alarmeP_format,2,".",",");
   $uti_criticoP_format = ($uti_critico / $uti_sum)*100;
   $uti_criticoP = number_format($uti_criticoP_format,2,".",",");

    // ============================================================ LINHA DE GALVANIZAÇÃO CONTÍNUA
    $lgc_linha1 = 13;
    $lgc_linha2 = 0;

    $lgc_manutencao = aux::GeralPorLinhaTE($atual1, 1, $lgc_linha1, $lgc_linha2);
    $lgc_standBy = aux::GeralPorLinhaTE($atual1, 2, $lgc_linha1, $lgc_linha2);
    $lgc_normal = aux::GeralPorLinhaTE($atual1, 3, $lgc_linha1, $lgc_linha2);
    $lgc_alarme = aux::GeralPorLinhaTE($atual1, 4, $lgc_linha1, $lgc_linha2);
    $lgc_critico = aux::GeralPorLinhaTE($atual1, 5, $lgc_linha1, $lgc_linha2);
    if($lgc_manutencao == null){$lgc_manutencao = 0;}
    if($lgc_standBy == null){$lgc_standBy = 0;}
    if($lgc_normal == null){$lgc_normal = 0;}
    if($lgc_alarme == null){$lgc_alarme = 0;}
    if($lgc_critico == null){$lgc_critico = 0;}

    $lgc_sum1 = DB::table('preditiva_atividades')
              ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
              ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
              ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
              ->where('negocios.id','=',13)
              ->where('preditiva_atividades.tecnicas_id', '=', 4)
              ->count('preditiva_atividades.id');

    $lgc_sum2 = DB::table('preditiva_atividades')
              ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
              ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
              ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
              ->where('negocios.id','=',0)
              ->where('preditiva_atividades.tecnicas_id', '=', 4)
              ->count('preditiva_atividades.id');

    $lgc_sum = $lgc_sum1+$lgc_sum2;
    $lgc_manutencaoP_format = ($lgc_manutencao / $lgc_sum)*100;
    $lgc_manutencaoP = number_format($lgc_manutencaoP_format,2,".",",");
    $lgc_standByP_format = ($lgc_standBy / $lgc_sum)*100;
    $lgc_standByP = number_format($lgc_standByP_format,2,".",",");
    $lgc_normalP_format = ($lgc_normal / $lgc_sum)*100;
    $lgc_normalP = number_format($lgc_normalP_format,2,".",",");
    $lgc_alarmeP_format = ($lgc_alarme / $lgc_sum)*100;
    $lgc_alarmeP = number_format($lgc_alarmeP_format,2,".",",");
    $lgc_criticoP_format = ($lgc_critico / $lgc_sum)*100;
    $lgc_criticoP = number_format($lgc_criticoP_format,2,".",",");

    // ============================================================ LINHA DE PINTURA CONTÍNUA
    $lpc_linha1 = 14;
    $lpc_linha2 = 0;

    $lpc_manutencao = aux::GeralPorLinhaTE($atual1, 1, $lpc_linha1, $lpc_linha2);
    $lpc_standBy = aux::GeralPorLinhaTE($atual1, 2, $lpc_linha1, $lpc_linha2);
    $lpc_normal = aux::GeralPorLinhaTE($atual1, 3, $lpc_linha1, $lpc_linha2);
    $lpc_alarme = aux::GeralPorLinhaTE($atual1, 4, $lpc_linha1, $lpc_linha2);
    $lpc_critico = aux::GeralPorLinhaTE($atual1, 5, $lpc_linha1, $lpc_linha2);
    if($lpc_manutencao == null){$lpc_manutencao = 0;}
    if($lpc_standBy == null){$lpc_standBy = 0;}
    if($lpc_normal == null){$lpc_normal = 0;}
    if($lpc_alarme == null){$lpc_alarme = 0;}
    if($lpc_critico == null){$lpc_critico = 0;}

   $lpc_sum1 = DB::table('preditiva_atividades')
               ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
               ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
               ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
               ->where('negocios.id','=',14)
               ->where('preditiva_atividades.tecnicas_id', '=', 4)
               ->count('preditiva_atividades.id');

   $lpc_sum2 = DB::table('preditiva_atividades')
               ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
               ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
               ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
               ->where('negocios.id','=',0)
               ->where('preditiva_atividades.tecnicas_id', '=', 4)
               ->count('preditiva_atividades.id');

   $lpc_sum = $lpc_sum1+$lpc_sum2;
   $lpc_manutencaoP_format = ($lpc_manutencao / $lpc_sum)*100;
   $lpc_manutencaoP = number_format($lpc_manutencaoP_format,2,".",",");
   $lpc_standByP_format = ($lpc_standBy / $lpc_sum)*100;
   $lpc_standByP = number_format($lpc_standByP_format,2,".",",");
   $lpc_normalP_format = ($lpc_normal / $lpc_sum)*100;
   $lpc_normalP = number_format($lpc_normalP_format,2,".",",");
   $lpc_alarmeP_format = ($lpc_alarme / $lpc_sum)*100;
   $lpc_alarmeP = number_format($lpc_alarmeP_format,2,".",",");
   $lpc_criticoP_format = ($lpc_critico / $lpc_sum)*100;
   $lpc_criticoP = number_format($lpc_criticoP_format,2,".",",");

   // ============================================================ CENTRO DE SERVIÇOS
   $cs_parent = 6;
   $cs_manutencao = aux::GeralPorLinha2TE($atual1, 1, $cs_parent);
   $cs_standBy = aux::GeralPorLinha2TE($atual1, 2, $cs_parent);
   $cs_normal = aux::GeralPorLinha2TE($atual1, 3, $cs_parent);
   $cs_alarme = aux::GeralPorLinha2TE($atual1, 4, $cs_parent);
   $cs_critico = aux::GeralPorLinha2TE($atual1, 5, $cs_parent);
   if($cs_manutencao == null){$cs_manutencao = 0;}
   if($cs_standBy == null){$cs_standBy = 0;}
   if($cs_normal == null){$cs_normal = 0;}
   if($cs_alarme == null){$cs_alarme = 0;}
   if($cs_critico == null){$cs_critico = 0;}

  $cs_sum = DB::table('preditiva_atividades')
              ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
              ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
              ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
              ->where('negocios.parent_id', '=', 6)
              ->where('preditiva_atividades.tecnicas_id', '=', 4)
              ->count('preditiva_atividades.id');

  $cs_manutencaoP_format = ($cs_manutencao / $cs_sum)*100;
  $cs_manutencaoP = number_format($cs_manutencaoP_format,2,".",",");
  $cs_standByP_format = ($cs_standBy / $cs_sum)*100;
  $cs_standByP = number_format($cs_standByP_format,2,".",",");
  $cs_normalP_format = ($cs_normal / $cs_sum)*100;
  $cs_normalP = number_format($cs_normalP_format,2,".",",");
  $cs_alarmeP_format = ($cs_alarme / $cs_sum)*100;
  $cs_alarmeP = number_format($cs_alarmeP_format,2,".",",");
  $cs_criticoP_format = ($cs_critico / $cs_sum)*100;
  $cs_criticoP = number_format($cs_criticoP_format,2,".",",");

    // ============================================================ PONTES Rolantes
  $pr_parent = 8;
  $pr_manutencao = aux::GeralPorLinha2TE($atual1, 1, $pr_parent);
  $pr_standBy = aux::GeralPorLinha2TE($atual1, 2, $pr_parent);
  $pr_normal = aux::GeralPorLinha2TE($atual1, 3, $pr_parent);
  $pr_alarme = aux::GeralPorLinha2TE($atual1, 4, $pr_parent);
  $pr_critico = aux::GeralPorLinha2TE($atual1, 5, $pr_parent);
  if($pr_manutencao == null){$pr_manutencao = 0;}
  if($pr_standBy == null){$pr_standBy = 0;}
  if($pr_normal == null){$pr_normal = 0;}
  if($pr_alarme == null){$pr_alarme = 0;}
  if($pr_critico == null){$pr_critico = 0;}

 $pr_sum = DB::table('preditiva_atividades')
             ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
             ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
             ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
             ->where('negocios.parent_id', '=', 8)
             ->where('preditiva_atividades.tecnicas_id', '=', 4)
             ->count('preditiva_atividades.id');

 $pr_manutencaoP_format = ($pr_manutencao / $pr_sum)*100;
 $pr_manutencaoP = number_format($pr_manutencaoP_format,2,".",",");
 $pr_standByP_format = ($pr_standBy / $pr_sum)*100;
 $pr_standByP = number_format($pr_standByP_format,2,".",",");
 $pr_normalP_format = ($pr_normal / $pr_sum)*100;
 $pr_normalP = number_format($pr_normalP_format,2,".",",");
 $pr_alarmeP_format = ($pr_alarme / $pr_sum)*100;
 $pr_alarmeP = number_format($pr_alarmeP_format,2,".",",");
 $pr_criticoP_format = ($pr_critico / $pr_sum)*100;
 $pr_criticoP = number_format($pr_criticoP_format,2,".",",");

 // ============================================================ TABELAS RELATÓRIO GERENCIAL
 // TABELA ANORMALIDADES - ALARME E CRITICO
 $tabela = aux::GeralAnormalidadesTE($atual1)->where('status_id', '>', 3);
 $indice_tg = 0;
 $tb_anormalidades[0] = (['indice_tg' => $indice_tg,
                           'data' => "",
                           'idLaudo' => "",
                           'descAtividade' => "de Atividade ",
                           'descAtivo' => "Registro ",
                           'descSistema' => "Sem ",
                           'descNegocio' => "S/L",
                           'status' => "",
                           'colorStatus' => ""]);
 foreach ($tabela as $key => $value) {
  $dateAnalise = $value->date_analise;
  $datef = json_encode($dateAnalise);
  $data_analise = substr($datef, 1, 11);
  $statusAnalise = $value->status_id;
  if ($statusAnalise == 4) {
    $statusAnalise = 'Alarme';
    $colorStatus = '#fff000';
  }
  if ($statusAnalise == 5) {
    $statusAnalise = 'Crítico';
    $colorStatus = '#ff0000';

  }
  $dado1 = $value->atividade_id;
  $dado2 = $value->id;
  $idLaudo = DB::table('laudos')->where('analise_id', '=', $dado2)->value('id');
  $descAtividade = DB::table('preditiva_atividades')->where('id', '=', $dado1)->value('description_ativ');
  $idAtivo = DB::table('preditiva_atividades')->where('id', '=', $dado1)->value('ativo_id');
  $descAtivo = DB::table('ativos')->where('id', '=', $idAtivo)->value('name_ativo');
  $idSistema = DB::table('ativos')->where('id', '=', $idAtivo)->value('sistema_id');
  $idNegocio = DB::table('sistemas')->where('id', '=', $idSistema)->value('negocio_id');
  $nameSistema = DB::table('sistemas')->where('id', '=', $idSistema)->value('name_sistema');
  $nameNegocio = DB::table('negocios')->where('id', '=', $idNegocio)->value('name_negocio');
  if ($nameNegocio == "UNIDADE DE REGENERACAO DE ACIDO 1") { $nameNegocio = "URA"; }
  if ($nameNegocio == "LAMINADOR REVERSIVEL DE TIRAS A FRIO 01") { $nameNegocio = "LRF"; }
  if ($nameNegocio == "DECAPAGEM 1") { $nameNegocio = "LDS"; }
  if ($nameNegocio == "GALVANIZACAO 1") { $nameNegocio = "LGC"; }
  if ($nameNegocio == "UNIDADE REGENERACAO DE ACIDO 1") { $nameNegocio = "URA"; }
  if ($nameNegocio == "ESTACAO DE TRATAMENTO DE AFLUENTES (ETA)") { $nameNegocio = "ETA"; }
  if ($nameNegocio == "ESTACAO DE TRATAMENTO DE EFLUENTES (ETE)") { $nameNegocio = "ETE"; }
  if ($nameNegocio == "LCC 1") { $nameNegocio = "LCC1"; }
  if ($nameNegocio == "LCL 1") { $nameNegocio = "LCL1"; }
  if ($nameNegocio == "PINTURA 1") { $nameNegocio = "LPC"; }
  if ($nameNegocio == "PRODUCAO DE AR COMPRIMIDO") { $nameNegocio = "UTI"; }
  if ($nameNegocio == "PRODUCAO DE VAPOR") { $nameNegocio = "UTI"; }
  if ($nameNegocio == "PONTE ROLANTE 01") { $nameNegocio = "PR01"; }
  if ($nameNegocio == "PONTE ROLANTE 02") { $nameNegocio = "PR02"; }
  if ($nameNegocio == "PONTE ROLANTE 03") { $nameNegocio = "PR03"; }
  if ($nameNegocio == "PONTE ROLANTE 04") { $nameNegocio = "PR04"; }
  if ($nameNegocio == "PONTE ROLANTE 05") { $nameNegocio = "PR05"; }
  if ($nameNegocio == "PONTE ROLANTE 06") { $nameNegocio = "PR06"; }
  if ($nameNegocio == "PONTE ROLANTE 07") { $nameNegocio = "PR07"; }
  if ($nameNegocio == "PONTE ROLANTE 08") { $nameNegocio = "PR08"; }
  if ($nameNegocio == "PONTE ROLANTE 09") { $nameNegocio = "PR09"; }
  if ($nameNegocio == "PONTE ROLANTE 10") { $nameNegocio = "PR10"; }
  if ($nameNegocio == "PONTE ROLANTE 11") { $nameNegocio = "PR11"; }
  if ($nameNegocio == "PONTE ROLANTE 12") { $nameNegocio = "PR12"; }
  if ($nameNegocio == "PONTE ROLANTE 13") { $nameNegocio = "PR13"; }
  if ($nameNegocio == "PONTE ROLANTE 14") { $nameNegocio = "PR14"; }
  if ($nameNegocio == "PONTE ROLANTE 15") { $nameNegocio = "PR15"; }
  if ($nameNegocio == "PONTE ROLANTE 16") { $nameNegocio = "PR16"; }
  if ($nameNegocio == "PONTE ROLANTE 17") { $nameNegocio = "PR17"; }
  if ($nameNegocio == "PONTE ROLANTE 18") { $nameNegocio = "PR18"; }
  if ($nameNegocio == "PONTE ROLANTE 19") { $nameNegocio = "PR19"; }
  if ($nameNegocio == "PONTE ROLANTE 20") { $nameNegocio = "PR20"; }
  if ($nameNegocio == "PONTE ROLANTE 21") { $nameNegocio = "PR21"; }
  if ($nameNegocio == "PONTE ROLANTE 22") { $nameNegocio = "PR22"; }
  if ($nameNegocio == "PONTE ROLANTE 23") { $nameNegocio = "PR23"; }
  if ($nameNegocio == null) {$nameNegocio = ""; }
  if ($nameSistema == null) {$nameSistema = ""; } else {$nameSistema = $nameSistema." - ";}
  if ($descAtivo == null) {$descAtivo = ""; } else {$descAtivo = $descAtivo." - ";}
  $tb_anormalidades[$indice_tg] = array(
                           'indice_tg' => $indice_tg,
                           'data' => $data_analise,
                           'idLaudo' => $idLaudo,
                           'descAtividade' => $descAtividade,
                           'descAtivo' => $descAtivo,
                           'descSistema' => $nameSistema,
                           'descNegocio' => $nameNegocio,
                           'status' => $statusAnalise,
                           'colorStatus' => $colorStatus
                           );
  $indice_tg++;
 }
 $tb_anormalidades = collect($tb_anormalidades)->sortBy('data')->reverse()->toArray();

 // TABELA STATUS NORMAL
 $tabela_normal = aux::GeralAnormalidadesTE($atual1)->where('status_id', '=', 3);
 $indice_normal = 0;
 $tb_normal[0] = (['indice_normal' => $indice_normal,
                           'data' => $atual1,
                           'idLaudo' => "",
                           'descAtividade' => "de Atividade ",
                           'descAtivo' => "Registro ",
                           'descSistema' => "Sem ",
                           'descNegocio' => "S/L",
                           'status' => "",
                           'colorStatus' => ""]);
 foreach ($tabela_normal as $key => $value) {
  $dateAnalise = $value->date_analise;
  $datef = json_encode($dateAnalise);
  $data_analise = substr($datef, 1, 11);
  $statusAnalise = $value->status_id;
  if ($statusAnalise == 3) {
    $statusAnalise = 'Normal';
    $colorStatus = '#00cc00';
  }
  $dado1 = $value->atividade_id;
  $dado2 = $value->id;
  $idLaudo = DB::table('laudos')->where('analise_id', '=', $dado2)->value('id');
  $descAtividade = DB::table('preditiva_atividades')->where('id', '=', $dado1)->value('description_ativ');
  $idAtivo = DB::table('preditiva_atividades')->where('id', '=', $dado1)->value('ativo_id');
  $descAtivo = DB::table('ativos')->where('id', '=', $idAtivo)->value('name_ativo');
  $idSistema = DB::table('ativos')->where('id', '=', $idAtivo)->value('sistema_id');
  $idNegocio = DB::table('sistemas')->where('id', '=', $idSistema)->value('negocio_id');
  $nameSistema = DB::table('sistemas')->where('id', '=', $idSistema)->value('name_sistema');
  $nameNegocio = DB::table('negocios')->where('id', '=', $idNegocio)->value('name_negocio');
  if ($nameNegocio == "UNIDADE DE REGENERACAO DE ACIDO 1") { $nameNegocio = "URA"; }
  if ($nameNegocio == "LAMINADOR REVERSIVEL DE TIRAS A FRIO 01") { $nameNegocio = "LRF"; }
  if ($nameNegocio == "DECAPAGEM 1") { $nameNegocio = "LDS"; }
  if ($nameNegocio == "GALVANIZACAO 1") { $nameNegocio = "LGC"; }
  if ($nameNegocio == "UNIDADE REGENERACAO DE ACIDO 1") { $nameNegocio = "URA"; }
  if ($nameNegocio == "ESTACAO DE TRATAMENTO DE AFLUENTES (ETA)") { $nameNegocio = "ETA"; }
  if ($nameNegocio == "ESTACAO DE TRATAMENTO DE EFLUENTES (ETE)") { $nameNegocio = "ETE"; }
  if ($nameNegocio == "LCC 1") { $nameNegocio = "LCC1"; }
  if ($nameNegocio == "LCL 1") { $nameNegocio = "LCL1"; }
  if ($nameNegocio == "PINTURA 1") { $nameNegocio = "LPC"; }
  if ($nameNegocio == "PRODUCAO DE AR COMPRIMIDO") { $nameNegocio = "UTI"; }
  if ($nameNegocio == "PRODUCAO DE VAPOR") { $nameNegocio = "UTI"; }
  if ($nameNegocio == "PONTE ROLANTE 01") { $nameNegocio = "PR01"; }
  if ($nameNegocio == "PONTE ROLANTE 02") { $nameNegocio = "PR02"; }
  if ($nameNegocio == "PONTE ROLANTE 03") { $nameNegocio = "PR03"; }
  if ($nameNegocio == "PONTE ROLANTE 04") { $nameNegocio = "PR04"; }
  if ($nameNegocio == "PONTE ROLANTE 05") { $nameNegocio = "PR05"; }
  if ($nameNegocio == "PONTE ROLANTE 06") { $nameNegocio = "PR06"; }
  if ($nameNegocio == "PONTE ROLANTE 07") { $nameNegocio = "PR07"; }
  if ($nameNegocio == "PONTE ROLANTE 08") { $nameNegocio = "PR08"; }
  if ($nameNegocio == "PONTE ROLANTE 09") { $nameNegocio = "PR09"; }
  if ($nameNegocio == "PONTE ROLANTE 10") { $nameNegocio = "PR10"; }
  if ($nameNegocio == "PONTE ROLANTE 11") { $nameNegocio = "PR11"; }
  if ($nameNegocio == "PONTE ROLANTE 12") { $nameNegocio = "PR12"; }
  if ($nameNegocio == "PONTE ROLANTE 13") { $nameNegocio = "PR13"; }
  if ($nameNegocio == "PONTE ROLANTE 14") { $nameNegocio = "PR14"; }
  if ($nameNegocio == "PONTE ROLANTE 15") { $nameNegocio = "PR15"; }
  if ($nameNegocio == "PONTE ROLANTE 16") { $nameNegocio = "PR16"; }
  if ($nameNegocio == "PONTE ROLANTE 17") { $nameNegocio = "PR17"; }
  if ($nameNegocio == "PONTE ROLANTE 18") { $nameNegocio = "PR18"; }
  if ($nameNegocio == "PONTE ROLANTE 19") { $nameNegocio = "PR19"; }
  if ($nameNegocio == "PONTE ROLANTE 20") { $nameNegocio = "PR20"; }
  if ($nameNegocio == "PONTE ROLANTE 21") { $nameNegocio = "PR21"; }
  if ($nameNegocio == "PONTE ROLANTE 22") { $nameNegocio = "PR22"; }
  if ($nameNegocio == "PONTE ROLANTE 23") { $nameNegocio = "PR23"; }
  if ($nameNegocio == null) {$nameNegocio = ""; }
  if ($nameSistema == null) {$nameSistema = ""; } else {$nameSistema = $nameSistema." - ";}
  if ($descAtivo == null) {$descAtivo = ""; } else {$descAtivo = $descAtivo." - ";}
  $tb_normal[$indice_normal] = array(
                           'indice_normal' => $indice_normal,
                           'data' => $data_analise,
                           'idLaudo' => $idLaudo,
                           'descAtividade' => $descAtividade,
                           'descAtivo' => $descAtivo,
                           'descSistema' => $nameSistema,
                           'descNegocio' => $nameNegocio,
                           'status' => $statusAnalise,
                           'colorStatus' => $colorStatus
                           );
  $indice_normal++;
 }
 $tb_normal = collect($tb_normal)->sortBy('data')->reverse()->toArray();

 // TABELA STATUS ALARME
 $tabela_alarme = aux::GeralAnormalidadesTE($atual1)->where('status_id', '=', 4);
 $indice_alarme = 0;
 $tb_alarme[0] = (['indice_alarme' => $indice_alarme,
                           'data' => $atual1,
                           'idLaudo' => "",
                           'descAtividade' => "de Atividade ",
                           'descAtivo' => "Registro ",
                           'descSistema' => "Sem ",
                           'descNegocio' => "S/L",
                           'status' => "",
                           'colorStatus' => ""]);
 foreach ($tabela_alarme as $key => $value) {
  $dateAnalise = $value->date_analise;
  $datef = json_encode($dateAnalise);
  $data_analise = substr($datef, 1, 11);
  $statusAnalise = $value->status_id;
  if ($statusAnalise == 4) {
    $statusAnalise = 'Alarme';
    $colorStatus = '#fff000';
  }
  $dado1 = $value->atividade_id;
  $dado2 = $value->id;
  $idLaudo = DB::table('laudos')->where('analise_id', '=', $dado2)->value('id');
  $descAtividade = DB::table('preditiva_atividades')->where('id', '=', $dado1)->value('description_ativ');
  $idAtivo = DB::table('preditiva_atividades')->where('id', '=', $dado1)->value('ativo_id');
  $descAtivo = DB::table('ativos')->where('id', '=', $idAtivo)->value('name_ativo');
  $idSistema = DB::table('ativos')->where('id', '=', $idAtivo)->value('sistema_id');
  $idNegocio = DB::table('sistemas')->where('id', '=', $idSistema)->value('negocio_id');
  $nameSistema = DB::table('sistemas')->where('id', '=', $idSistema)->value('name_sistema');
  $nameNegocio = DB::table('negocios')->where('id', '=', $idNegocio)->value('name_negocio');
  if ($nameNegocio == "UNIDADE DE REGENERACAO DE ACIDO 1") { $nameNegocio = "URA"; }
  if ($nameNegocio == "LAMINADOR REVERSIVEL DE TIRAS A FRIO 01") { $nameNegocio = "LRF"; }
  if ($nameNegocio == "DECAPAGEM 1") { $nameNegocio = "LDS"; }
  if ($nameNegocio == "GALVANIZACAO 1") { $nameNegocio = "LGC"; }
  if ($nameNegocio == "UNIDADE REGENERACAO DE ACIDO 1") { $nameNegocio = "URA"; }
  if ($nameNegocio == "ESTACAO DE TRATAMENTO DE AFLUENTES (ETA)") { $nameNegocio = "ETA"; }
  if ($nameNegocio == "ESTACAO DE TRATAMENTO DE EFLUENTES (ETE)") { $nameNegocio = "ETE"; }
  if ($nameNegocio == "LCC 1") { $nameNegocio = "LCC1"; }
  if ($nameNegocio == "LCL 1") { $nameNegocio = "LCL1"; }
  if ($nameNegocio == "PINTURA 1") { $nameNegocio = "LPC"; }
  if ($nameNegocio == "PRODUCAO DE AR COMPRIMIDO") { $nameNegocio = "UTI"; }
  if ($nameNegocio == "PRODUCAO DE VAPOR") { $nameNegocio = "UTI"; }
  if ($nameNegocio == "PONTE ROLANTE 01") { $nameNegocio = "PR01"; }
  if ($nameNegocio == "PONTE ROLANTE 02") { $nameNegocio = "PR02"; }
  if ($nameNegocio == "PONTE ROLANTE 03") { $nameNegocio = "PR03"; }
  if ($nameNegocio == "PONTE ROLANTE 04") { $nameNegocio = "PR04"; }
  if ($nameNegocio == "PONTE ROLANTE 05") { $nameNegocio = "PR05"; }
  if ($nameNegocio == "PONTE ROLANTE 06") { $nameNegocio = "PR06"; }
  if ($nameNegocio == "PONTE ROLANTE 07") { $nameNegocio = "PR07"; }
  if ($nameNegocio == "PONTE ROLANTE 08") { $nameNegocio = "PR08"; }
  if ($nameNegocio == "PONTE ROLANTE 09") { $nameNegocio = "PR09"; }
  if ($nameNegocio == "PONTE ROLANTE 10") { $nameNegocio = "PR10"; }
  if ($nameNegocio == "PONTE ROLANTE 11") { $nameNegocio = "PR11"; }
  if ($nameNegocio == "PONTE ROLANTE 12") { $nameNegocio = "PR12"; }
  if ($nameNegocio == "PONTE ROLANTE 13") { $nameNegocio = "PR13"; }
  if ($nameNegocio == "PONTE ROLANTE 14") { $nameNegocio = "PR14"; }
  if ($nameNegocio == "PONTE ROLANTE 15") { $nameNegocio = "PR15"; }
  if ($nameNegocio == "PONTE ROLANTE 16") { $nameNegocio = "PR16"; }
  if ($nameNegocio == "PONTE ROLANTE 17") { $nameNegocio = "PR17"; }
  if ($nameNegocio == "PONTE ROLANTE 18") { $nameNegocio = "PR18"; }
  if ($nameNegocio == "PONTE ROLANTE 19") { $nameNegocio = "PR19"; }
  if ($nameNegocio == "PONTE ROLANTE 20") { $nameNegocio = "PR20"; }
  if ($nameNegocio == "PONTE ROLANTE 21") { $nameNegocio = "PR21"; }
  if ($nameNegocio == "PONTE ROLANTE 22") { $nameNegocio = "PR22"; }
  if ($nameNegocio == "PONTE ROLANTE 23") { $nameNegocio = "PR23"; }
  if ($nameNegocio == null) {$nameNegocio = ""; }
  if ($nameSistema == null) {$nameSistema = ""; } else {$nameSistema = $nameSistema." - ";}
  if ($descAtivo == null) {$descAtivo = ""; } else {$descAtivo = $descAtivo." - ";}
  $tb_alarme[$indice_alarme] = array(
                           'indice_alarme' => $indice_alarme,
                           'data' => $data_analise,
                           'idLaudo' => $idLaudo,
                           'descAtividade' => $descAtividade,
                           'descAtivo' => $descAtivo,
                           'descSistema' => $nameSistema,
                           'descNegocio' => $nameNegocio,
                           'status' => $statusAnalise,
                           'colorStatus' => $colorStatus
                           );
  $indice_alarme++;
 }
 $tb_alarme = collect($tb_alarme)->sortBy('data')->reverse()->toArray();

 // TABELA STATUS CRITICO
 $tabela_critico = aux::GeralAnormalidadesTE($atual1)->where('status_id', '=', 5);
 $indice_critico = 0;
 $tb_critico[0] = (['indice_critico' => $indice_critico,
                           'data' => $atual1,
                           'idLaudo' => "",
                           'descAtividade' => "de Atividade ",
                           'descAtivo' => "Registro ",
                           'descSistema' => "Sem ",
                           'descNegocio' => "S/L",
                           'status' => "",
                           'colorStatus' => ""]);
 foreach ($tabela_critico as $key => $value) {
  $dateAnalise = $value->date_analise;
  $datef = json_encode($dateAnalise);
  $data_analise = substr($datef, 1, 11);
  $statusAnalise = $value->status_id;
  if ($statusAnalise == 5) {
    $statusAnalise = 'Crítico';
    $colorStatus = '#ff0000';
  }
  $dado1 = $value->atividade_id;
  $dado2 = $value->id;
  $idLaudo = DB::table('laudos')->where('analise_id', '=', $dado2)->value('id');
  $descAtividade = DB::table('preditiva_atividades')->where('id', '=', $dado1)->value('description_ativ');
  $idAtivo = DB::table('preditiva_atividades')->where('id', '=', $dado1)->value('ativo_id');
  $descAtivo = DB::table('ativos')->where('id', '=', $idAtivo)->value('name_ativo');
  $idSistema = DB::table('ativos')->where('id', '=', $idAtivo)->value('sistema_id');
  $idNegocio = DB::table('sistemas')->where('id', '=', $idSistema)->value('negocio_id');
  $nameSistema = DB::table('sistemas')->where('id', '=', $idSistema)->value('name_sistema');
  $nameNegocio = DB::table('negocios')->where('id', '=', $idNegocio)->value('name_negocio');
  if ($nameNegocio == "UNIDADE DE REGENERACAO DE ACIDO 1") { $nameNegocio = "URA"; }
  if ($nameNegocio == "LAMINADOR REVERSIVEL DE TIRAS A FRIO 01") { $nameNegocio = "LRF"; }
  if ($nameNegocio == "DECAPAGEM 1") { $nameNegocio = "LDS"; }
  if ($nameNegocio == "GALVANIZACAO 1") { $nameNegocio = "LGC"; }
  if ($nameNegocio == "UNIDADE REGENERACAO DE ACIDO 1") { $nameNegocio = "URA"; }
  if ($nameNegocio == "ESTACAO DE TRATAMENTO DE AFLUENTES (ETA)") { $nameNegocio = "ETA"; }
  if ($nameNegocio == "ESTACAO DE TRATAMENTO DE EFLUENTES (ETE)") { $nameNegocio = "ETE"; }
  if ($nameNegocio == "LCC 1") { $nameNegocio = "LCC1"; }
  if ($nameNegocio == "LCL 1") { $nameNegocio = "LCL1"; }
  if ($nameNegocio == "PINTURA 1") { $nameNegocio = "LPC"; }
  if ($nameNegocio == "PRODUCAO DE AR COMPRIMIDO") { $nameNegocio = "UTI"; }
  if ($nameNegocio == "PRODUCAO DE VAPOR") { $nameNegocio = "UTI"; }
  if ($nameNegocio == "PONTE ROLANTE 01") { $nameNegocio = "PR01"; }
  if ($nameNegocio == "PONTE ROLANTE 02") { $nameNegocio = "PR02"; }
  if ($nameNegocio == "PONTE ROLANTE 03") { $nameNegocio = "PR03"; }
  if ($nameNegocio == "PONTE ROLANTE 04") { $nameNegocio = "PR04"; }
  if ($nameNegocio == "PONTE ROLANTE 05") { $nameNegocio = "PR05"; }
  if ($nameNegocio == "PONTE ROLANTE 06") { $nameNegocio = "PR06"; }
  if ($nameNegocio == "PONTE ROLANTE 07") { $nameNegocio = "PR07"; }
  if ($nameNegocio == "PONTE ROLANTE 08") { $nameNegocio = "PR08"; }
  if ($nameNegocio == "PONTE ROLANTE 09") { $nameNegocio = "PR09"; }
  if ($nameNegocio == "PONTE ROLANTE 10") { $nameNegocio = "PR10"; }
  if ($nameNegocio == "PONTE ROLANTE 11") { $nameNegocio = "PR11"; }
  if ($nameNegocio == "PONTE ROLANTE 12") { $nameNegocio = "PR12"; }
  if ($nameNegocio == "PONTE ROLANTE 13") { $nameNegocio = "PR13"; }
  if ($nameNegocio == "PONTE ROLANTE 14") { $nameNegocio = "PR14"; }
  if ($nameNegocio == "PONTE ROLANTE 15") { $nameNegocio = "PR15"; }
  if ($nameNegocio == "PONTE ROLANTE 16") { $nameNegocio = "PR16"; }
  if ($nameNegocio == "PONTE ROLANTE 17") { $nameNegocio = "PR17"; }
  if ($nameNegocio == "PONTE ROLANTE 18") { $nameNegocio = "PR18"; }
  if ($nameNegocio == "PONTE ROLANTE 19") { $nameNegocio = "PR19"; }
  if ($nameNegocio == "PONTE ROLANTE 20") { $nameNegocio = "PR20"; }
  if ($nameNegocio == "PONTE ROLANTE 21") { $nameNegocio = "PR21"; }
  if ($nameNegocio == "PONTE ROLANTE 22") { $nameNegocio = "PR22"; }
  if ($nameNegocio == "PONTE ROLANTE 23") { $nameNegocio = "PR23"; }
  if ($nameNegocio == null) {$nameNegocio = ""; }
  if ($nameSistema == null) {$nameSistema = ""; } else {$nameSistema = $nameSistema." - ";}
  if ($descAtivo == null) {$descAtivo = ""; } else {$descAtivo = $descAtivo." - ";}
  $tb_critico[$indice_critico] = array(
                           'indice_critico' => $indice_critico,
                           'data' => $data_analise,
                           'idLaudo' => $idLaudo,
                           'descAtividade' => $descAtividade,
                           'descAtivo' => $descAtivo,
                           'descSistema' => $nameSistema,
                           'descNegocio' => $nameNegocio,
                           'status' => $statusAnalise,
                           'colorStatus' => $colorStatus
                           );
  $indice_critico++;
 }
 $tb_critico = collect($tb_critico)->sortBy('data')->reverse()->toArray();

 // TABELA STATUS MANUTENCAO
 $tabela_manutencao = aux::GeralAnormalidadesTE($atual1)->where('status_id', '=', 1);
 $indice_manutencao = 0;
 $tb_manutencao[0] = (['indice_manutencao' => $indice_manutencao,
                           'data' => $atual1,
                           'idLaudo' => "",
                           'descAtividade' => "de Atividade ",
                           'descAtivo' => "Registro ",
                           'descSistema' => "Sem ",
                           'descNegocio' => "S/L",
                           'status' => "",
                           'colorStatus' => ""]);
 foreach ($tabela_manutencao as $key => $value) {
  $dateAnalise = $value->date_analise;
  $datef = json_encode($dateAnalise);
  $data_analise = substr($datef, 1, 11);
  $statusAnalise = $value->status_id;
  if ($statusAnalise == 1) {
    $statusAnalise = 'Manutenção';
    $colorStatus = '#c0c2c6';
  }
  $dado1 = $value->atividade_id;
  $dado2 = $value->id;
  $idLaudo = DB::table('laudos')->where('analise_id', '=', $dado2)->value('id');
  $descAtividade = DB::table('preditiva_atividades')->where('id', '=', $dado1)->value('description_ativ');
  $idAtivo = DB::table('preditiva_atividades')->where('id', '=', $dado1)->value('ativo_id');
  $descAtivo = DB::table('ativos')->where('id', '=', $idAtivo)->value('name_ativo');
  $idSistema = DB::table('ativos')->where('id', '=', $idAtivo)->value('sistema_id');
  $idNegocio = DB::table('sistemas')->where('id', '=', $idSistema)->value('negocio_id');
  $nameSistema = DB::table('sistemas')->where('id', '=', $idSistema)->value('name_sistema');
  $nameNegocio = DB::table('negocios')->where('id', '=', $idNegocio)->value('name_negocio');
  if ($nameNegocio == "UNIDADE REGENERACAO DE ACIDO 1") { $nameNegocio = "URA"; }
  if ($nameNegocio == "LAMINADOR REVERSIVEL DE TIRAS A FRIO 01") { $nameNegocio = "LRF"; }
  if ($nameNegocio == "DECAPAGEM 1") { $nameNegocio = "LDS"; }
  if ($nameNegocio == "GALVANIZACAO 1") { $nameNegocio = "LGC"; }
  if ($nameNegocio == "UNIDADE DE REGENERACAO DE ACIDO 1") { $nameNegocio = "URA"; }
  if ($nameNegocio == "ESTACAO DE TRATAMENTO DE AFLUENTES (ETA)") { $nameNegocio = "ETA"; }
  if ($nameNegocio == "ESTACAO DE TRATAMENTO DE EFLUENTES (ETE)") { $nameNegocio = "ETE"; }
  if ($nameNegocio == "LCC 1") { $nameNegocio = "LCC1"; }
  if ($nameNegocio == "LCL 1") { $nameNegocio = "LCL1"; }
  if ($nameNegocio == "PINTURA 1") { $nameNegocio = "LPC"; }
  if ($nameNegocio == "PRODUCAO DE AR COMPRIMIDO") { $nameNegocio = "UTI"; }
  if ($nameNegocio == "PRODUCAO DE VAPOR") { $nameNegocio = "UTI"; }
  if ($nameNegocio == "PONTE ROLANTE 01") { $nameNegocio = "PR01"; }
  if ($nameNegocio == "PONTE ROLANTE 02") { $nameNegocio = "PR02"; }
  if ($nameNegocio == "PONTE ROLANTE 03") { $nameNegocio = "PR03"; }
  if ($nameNegocio == "PONTE ROLANTE 04") { $nameNegocio = "PR04"; }
  if ($nameNegocio == "PONTE ROLANTE 05") { $nameNegocio = "PR05"; }
  if ($nameNegocio == "PONTE ROLANTE 06") { $nameNegocio = "PR06"; }
  if ($nameNegocio == "PONTE ROLANTE 07") { $nameNegocio = "PR07"; }
  if ($nameNegocio == "PONTE ROLANTE 08") { $nameNegocio = "PR08"; }
  if ($nameNegocio == "PONTE ROLANTE 09") { $nameNegocio = "PR09"; }
  if ($nameNegocio == "PONTE ROLANTE 10") { $nameNegocio = "PR10"; }
  if ($nameNegocio == "PONTE ROLANTE 11") { $nameNegocio = "PR11"; }
  if ($nameNegocio == "PONTE ROLANTE 12") { $nameNegocio = "PR12"; }
  if ($nameNegocio == "PONTE ROLANTE 13") { $nameNegocio = "PR13"; }
  if ($nameNegocio == "PONTE ROLANTE 14") { $nameNegocio = "PR14"; }
  if ($nameNegocio == "PONTE ROLANTE 15") { $nameNegocio = "PR15"; }
  if ($nameNegocio == "PONTE ROLANTE 16") { $nameNegocio = "PR16"; }
  if ($nameNegocio == "PONTE ROLANTE 17") { $nameNegocio = "PR17"; }
  if ($nameNegocio == "PONTE ROLANTE 18") { $nameNegocio = "PR18"; }
  if ($nameNegocio == "PONTE ROLANTE 19") { $nameNegocio = "PR19"; }
  if ($nameNegocio == "PONTE ROLANTE 20") { $nameNegocio = "PR20"; }
  if ($nameNegocio == "PONTE ROLANTE 21") { $nameNegocio = "PR21"; }
  if ($nameNegocio == "PONTE ROLANTE 22") { $nameNegocio = "PR22"; }
  if ($nameNegocio == "PONTE ROLANTE 23") { $nameNegocio = "PR23"; }
  if ($nameNegocio == null) {$nameNegocio = ""; }
  if ($nameSistema == null) {$nameSistema = ""; } else {$nameSistema = $nameSistema." - ";}
  if ($descAtivo == null) {$descAtivo = ""; } else {$descAtivo = $descAtivo." - ";}
  $tb_manutencao[$indice_manutencao] = array(
                           'indice_manutencao' => $indice_manutencao,
                           'data' => $data_analise,
                           'idLaudo' => $idLaudo,
                           'descAtividade' => $descAtividade,
                           'descAtivo' => $descAtivo,
                           'descSistema' => $nameSistema,
                           'descNegocio' => $nameNegocio,
                           'status' => $statusAnalise,
                           'colorStatus' => $colorStatus
                           );
  $indice_manutencao++;
 }
 $tb_manutencao = collect($tb_manutencao)->sortBy('data')->reverse()->toArray();

 // TABELA STATUS STANDBY
 $tabela_standBy = aux::GeralAnormalidadesTE($atual1)->where('status_id', '=', 2);
 $indice_standBy = 0;
 $tb_standBy[0] = (['indice_standBy' => $indice_standBy,
                           'data' => $atual1,
                           'idLaudo' => "",
                           'descAtividade' => "de Atividade ",
                           'descAtivo' => "Registro ",
                           'descSistema' => "Sem ",
                           'descNegocio' => "S/L",
                           'status' => "",
                           'colorStatus' => ""]);
 foreach ($tabela_standBy as $key => $value) {
  $dateAnalise = $value->date_analise;
  $datef = json_encode($dateAnalise);
  $data_analise = substr($datef, 1, 11);
  $statusAnalise = $value->status_id;
  if ($statusAnalise == 2) {
    $statusAnalise = 'StandBy';
    $colorStatus = '#0066cc';
  }
  $dado1 = $value->atividade_id;
  $dado2 = $value->id;
  $idLaudo = DB::table('laudos')->where('analise_id', '=', $dado2)->value('id');
  $descAtividade = DB::table('preditiva_atividades')->where('id', '=', $dado1)->value('description_ativ');
  $idAtivo = DB::table('preditiva_atividades')->where('id', '=', $dado1)->value('ativo_id');
  $descAtivo = DB::table('ativos')->where('id', '=', $idAtivo)->value('name_ativo');
  $idSistema = DB::table('ativos')->where('id', '=', $idAtivo)->value('sistema_id');
  $idNegocio = DB::table('sistemas')->where('id', '=', $idSistema)->value('negocio_id');
  $nameSistema = DB::table('sistemas')->where('id', '=', $idSistema)->value('name_sistema');
  $nameNegocio = DB::table('negocios')->where('id', '=', $idNegocio)->value('name_negocio');
  if ($nameNegocio == "UNIDADE DE REGENERACAO DE ACIDO 1") { $nameNegocio = "URA"; }
  if ($nameNegocio == "LAMINADOR REVERSIVEL DE TIRAS A FRIO 01") { $nameNegocio = "LRF"; }
  if ($nameNegocio == "DECAPAGEM 1") { $nameNegocio = "LDS"; }
  if ($nameNegocio == "GALVANIZACAO 1") { $nameNegocio = "LGC"; }
  if ($nameNegocio == "UNIDADE REGENERACAO DE ACIDO 1") { $nameNegocio = "URA"; }
  if ($nameNegocio == "ESTACAO DE TRATAMENTO DE AFLUENTES (ETA)") { $nameNegocio = "ETA"; }
  if ($nameNegocio == "ESTACAO DE TRATAMENTO DE EFLUENTES (ETE)") { $nameNegocio = "ETE"; }
  if ($nameNegocio == "LCC 1") { $nameNegocio = "LCC1"; }
  if ($nameNegocio == "LCL 1") { $nameNegocio = "LCL1"; }
  if ($nameNegocio == "PINTURA 1") { $nameNegocio = "LPC"; }
  if ($nameNegocio == "PRODUCAO DE AR COMPRIMIDO") { $nameNegocio = "UTI"; }
  if ($nameNegocio == "PRODUCAO DE VAPOR") { $nameNegocio = "UTI"; }
  if ($nameNegocio == "PONTE ROLANTE 01") { $nameNegocio = "PR01"; }
  if ($nameNegocio == "PONTE ROLANTE 02") { $nameNegocio = "PR02"; }
  if ($nameNegocio == "PONTE ROLANTE 03") { $nameNegocio = "PR03"; }
  if ($nameNegocio == "PONTE ROLANTE 04") { $nameNegocio = "PR04"; }
  if ($nameNegocio == "PONTE ROLANTE 05") { $nameNegocio = "PR05"; }
  if ($nameNegocio == "PONTE ROLANTE 06") { $nameNegocio = "PR06"; }
  if ($nameNegocio == "PONTE ROLANTE 07") { $nameNegocio = "PR07"; }
  if ($nameNegocio == "PONTE ROLANTE 08") { $nameNegocio = "PR08"; }
  if ($nameNegocio == "PONTE ROLANTE 09") { $nameNegocio = "PR09"; }
  if ($nameNegocio == "PONTE ROLANTE 10") { $nameNegocio = "PR10"; }
  if ($nameNegocio == "PONTE ROLANTE 11") { $nameNegocio = "PR11"; }
  if ($nameNegocio == "PONTE ROLANTE 12") { $nameNegocio = "PR12"; }
  if ($nameNegocio == "PONTE ROLANTE 13") { $nameNegocio = "PR13"; }
  if ($nameNegocio == "PONTE ROLANTE 14") { $nameNegocio = "PR14"; }
  if ($nameNegocio == "PONTE ROLANTE 15") { $nameNegocio = "PR15"; }
  if ($nameNegocio == "PONTE ROLANTE 16") { $nameNegocio = "PR16"; }
  if ($nameNegocio == "PONTE ROLANTE 17") { $nameNegocio = "PR17"; }
  if ($nameNegocio == "PONTE ROLANTE 18") { $nameNegocio = "PR18"; }
  if ($nameNegocio == "PONTE ROLANTE 19") { $nameNegocio = "PR19"; }
  if ($nameNegocio == "PONTE ROLANTE 20") { $nameNegocio = "PR20"; }
  if ($nameNegocio == "PONTE ROLANTE 21") { $nameNegocio = "PR21"; }
  if ($nameNegocio == "PONTE ROLANTE 22") { $nameNegocio = "PR22"; }
  if ($nameNegocio == "PONTE ROLANTE 23") { $nameNegocio = "PR23"; }
  if ($nameNegocio == null) {$nameNegocio = ""; }
  if ($nameSistema == null) {$nameSistema = ""; } else {$nameSistema = $nameSistema." - ";}
  if ($descAtivo == null) {$descAtivo = ""; } else {$descAtivo = $descAtivo." - ";}
  $tb_standBy[$indice_standBy] = array(
                           'indice_standBy' => $indice_standBy,
                           'data' => $data_analise,
                           'idLaudo' => $idLaudo,
                           'descAtividade' => $descAtividade,
                           'descAtivo' => $descAtivo,
                           'descSistema' => $nameSistema,
                           'descNegocio' => $nameNegocio,
                           'status' => $statusAnalise,
                           'colorStatus' => $colorStatus
                           );
  $indice_standBy++;
 }
 $tb_standBy = collect($tb_standBy)->sortBy('data')->reverse()->toArray();

 // ============================================================ STATUS DOS PONTOS
 $atual2 = Carbon::now()->subMonths(0)->format('Y-m-01');
 $atual3 = Carbon::now()->subMonths(1)->format('Y-m-01');
 $atual4 = Carbon::now()->subMonths(2)->format('Y-m-01');
 $atual5 = Carbon::now()->subMonths(3)->format('Y-m-01');
 $atual6 = Carbon::now()->subMonths(4)->format('Y-m-01');
 $atual7 = Carbon::now()->subMonths(5)->format('Y-m-01');
 $atual8 = Carbon::now()->subMonths(6)->format('Y-m-01');
 $atual9 = Carbon::now()->subMonths(7)->format('Y-m-01');
 $atual10 = Carbon::now()->subMonths(8)->format('Y-m-01');
 $atual11 = Carbon::now()->subMonths(9)->format('Y-m-01');
 $atual12 = Carbon::now()->subMonths(10)->format('Y-m-01');

 $normal1 = aux::GeralAnormalidadesTE($atual1)->where('status_id', '=', 3)->count();
 $alarme1 = aux::GeralAnormalidadesTE($atual1)->where('status_id', '=', 4)->count();
 $critico1 = aux::GeralAnormalidadesTE($atual1)->where('status_id', '=', 5)->count();
 $normal2 = aux::GeralAnormalidadesTE($atual2)->where('status_id', '=', 3)->count();
 $alarme2 = aux::GeralAnormalidadesTE($atual2)->where('status_id', '=', 4)->count();
 $critico2 = aux::GeralAnormalidadesTE($atual2)->where('status_id', '=', 5)->count();
 $normal3 = aux::GeralAnormalidadesTE($atual3)->where('status_id', '=', 3)->count();
 $alarme3 = aux::GeralAnormalidadesTE($atual3)->where('status_id', '=', 4)->count();
 $critico3 = aux::GeralAnormalidadesTE($atual3)->where('status_id', '=', 5)->count();
 $normal4 = aux::GeralAnormalidadesTE($atual4)->where('status_id', '=', 3)->count();
 $alarme4 = aux::GeralAnormalidadesTE($atual4)->where('status_id', '=', 4)->count();
 $critico4 = aux::GeralAnormalidadesTE($atual4)->where('status_id', '=', 5)->count();
 $normal5 = aux::GeralAnormalidadesTE($atual5)->where('status_id', '=', 3)->count();
 $alarme5 = aux::GeralAnormalidadesTE($atual5)->where('status_id', '=', 4)->count();
 $critico5 = aux::GeralAnormalidadesTE($atual5)->where('status_id', '=', 5)->count();
 $normal6 = aux::GeralAnormalidadesTE($atual6)->where('status_id', '=', 3)->count();
 $alarme6 = aux::GeralAnormalidadesTE($atual6)->where('status_id', '=', 4)->count();
 $critico6 = aux::GeralAnormalidadesTE($atual6)->where('status_id', '=', 5)->count();
 $normal7 = aux::GeralAnormalidadesTE($atual7)->where('status_id', '=', 3)->count();
 $alarme7 = aux::GeralAnormalidadesTE($atual7)->where('status_id', '=', 4)->count();
 $critico7 = aux::GeralAnormalidadesTE($atual7)->where('status_id', '=', 5)->count();
 $normal8 = aux::GeralAnormalidadesTE($atual8)->where('status_id', '=', 3)->count();
 $alarme8 = aux::GeralAnormalidadesTE($atual8)->where('status_id', '=', 4)->count();
 $critico8 = aux::GeralAnormalidadesTE($atual8)->where('status_id', '=', 5)->count();
 $normal9 = aux::GeralAnormalidadesTE($atual9)->where('status_id', '=', 3)->count();
 $alarme9 = aux::GeralAnormalidadesTE($atual9)->where('status_id', '=', 4)->count();
 $critico9 = aux::GeralAnormalidadesTE($atual9)->where('status_id', '=', 5)->count();
 $normal10 = aux::GeralAnormalidadesTE($atual10)->where('status_id', '=', 3)->count();
 $alarme10 = aux::GeralAnormalidadesTE($atual10)->where('status_id', '=', 4)->count();
 $critico10 = aux::GeralAnormalidadesTE($atual10)->where('status_id', '=', 5)->count();
 $normal11 = aux::GeralAnormalidadesTE($atual11)->where('status_id', '=', 3)->count();
 $alarme11 = aux::GeralAnormalidadesTE($atual11)->where('status_id', '=', 4)->count();
 $critico11 = aux::GeralAnormalidadesTE($atual11)->where('status_id', '=', 5)->count();
 $normal12 = aux::GeralAnormalidadesTE($atual12)->where('status_id', '=', 3)->count();
 $alarme12 = aux::GeralAnormalidadesTE($atual12)->where('status_id', '=', 4)->count();
 $critico12 = aux::GeralAnormalidadesTE($atual12)->where('status_id', '=', 5)->count();

// ============================================================ ANORMALIDADES
 $atualf1 = aux::FormatDateMonth(0);
 $atualf2 = aux::FormatDateMonth(1);
 $atualf3 = aux::FormatDateMonth(2);
 $atualf4 = aux::FormatDateMonth(3);
 $atualf5 = aux::FormatDateMonth(4);
 $atualf6 = aux::FormatDateMonth(5);
 $atualf7 = aux::FormatDateMonth(6);
 $atualf8 = aux::FormatDateMonth(7);
 $atualf9 = aux::FormatDateMonth(8);
 $atualf10 = aux::FormatDateMonth(9);
 $atualf11 = aux::FormatDateMonth(10);
 $atualf12 = aux::FormatDateMonth(11);

 if($alarme1 == null){$alarme1 = 0;}
 if($critico1 == null){$critico1 = 0;}
 $alarme1P_format = ($alarme1 / $sum)*100;
 $critico1P_format = ($critico1 / $sum)*100;
 $alarme1_anorm = number_format($alarme1P_format,2,".",",");
 $critico1_anorm = number_format($critico1P_format,2,".",",");

 if($alarme2 == null){$alarme2 = 0;}
 if($critico2 == null){$critico2 = 0;}
 $alarme2P_format = ($alarme2 / $sum)*100;
 $critico2P_format = ($critico2 / $sum)*100;
 $alarme2_anorm = number_format($alarme2P_format,2,".",",");
 $critico2_anorm = number_format($critico2P_format,2,".",",");

 if($alarme3 == null){$alarme3 = 0;}
 if($critico3 == null){$critico3 = 0;}
 $alarme3P_format = ($alarme3 / $sum)*100;
 $critico3P_format = ($critico3 / $sum)*100;
 $alarme3_anorm = number_format($alarme3P_format,2,".",",");
 $critico3_anorm = number_format($critico3P_format,2,".",",");

 if($alarme4 == null){$alarme4P = 0;}
 if($critico4 == null){$critico4P = 0;}
 $alarme4P_format = ($alarme4 / $sum)*100;
 $critico4P_format = ($critico4 / $sum)*100;
 $alarme4_anorm = number_format($alarme4P_format,2,".",",");
 $critico4_anorm = number_format($critico4P_format,2,".",",");

 if($alarme5 == null){$alarme5 = 0;}
 if($critico5 == null){$critico5 = 0;}
 $alarme5P_format = ($alarme5 / $sum)*100;
 $critico5P_format = ($critico5 / $sum)*100;
 $alarme5_anorm = number_format($alarme5P_format,2,".",",");
 $critico5_anorm = number_format($critico5P_format,2,".",",");

 if($alarme6 == null){$alarme6 = 0;}
 if($critico6 == null){$critico6 = 0;}
 $alarme6P_format = ($alarme6 / $sum)*100;
 $critico6P_format = ($critico6 / $sum)*100;
 $alarme6_anorm = number_format($alarme6P_format,2,".",",");
 $critico6_anorm = number_format($critico6P_format,2,".",",");

 if($alarme7 == null){$alarme7 = 0;}
 if($critico7 == null){$critico7 = 0;}
 $alarme7P_format = ($alarme7 / $sum)*100;
 $critico7P_format = ($critico7 / $sum)*100;
 $alarme7_anorm = number_format($alarme7P_format,2,".",",");
 $critico7_anorm = number_format($critico7P_format,2,".",",");

 if($alarme8 == null){$alarme8 = 0;}
 if($critico8 == null){$critico8 = 0;}
 $alarme8P_format = ($alarme8 / $sum)*100;
 $critico8P_format = ($critico8 / $sum)*100;
 $alarme8_anorm = number_format($alarme8P_format,2,".",",");
 $critico8_anorm = number_format($critico8P_format,2,".",",");

 if($alarme9 == null){$alarme9 = 0;}
 if($critico9 == null){$critico9 = 0;}
 $alarme9P_format = ($alarme9 / $sum)*100;
 $critico9P_format = ($critico9 / $sum)*100;
 $alarme9_anorm = number_format($alarme9P_format,2,".",",");
 $critico9_anorm = number_format($critico9P_format,2,".",",");

 if($alarme10 == null){$alarme10 = 0;}
 if($critico10 == null){$critico10 = 0;}
 $alarme10P_format = ($alarme10 / $sum)*100;
 $critico10P_format = ($critico10 / $sum)*100;
 $alarme10_anorm = number_format($alarme10P_format,2,".",",");
 $critico10_anorm = number_format($critico10P_format,2,".",",");

 if($alarme11 == null){$alarme11 = 0;}
 if($critico11 == null){$critico11 = 0;}
 $alarme11P_format = ($alarme11 / $sum)*100;
 $critico11P_format = ($critico11 / $sum)*100;
 $alarme11_anorm = number_format($alarme11P_format,2,".",",");
 $critico11_anorm = number_format($critico11P_format,2,".",",");

 if($alarme12 == null){$alarme12 = 0;}
 if($critico12 == null){$critico12 = 0;}
 $alarme12P_format = ($alarme12 / $sum)*100;
 $critico12P_format = ($critico12 / $sum)*100;
 $alarme12_anorm = number_format($alarme12P_format,2,".",",");
 $critico12_anorm = number_format($critico12P_format,2,".",",");

 // ============================================================ PROBLEMAS ENCONTRADOS
 $faltaAperto1 = aux::GeralAnormalidadesTE($atual1)->where('diagnostico_id', '=', 1)->count('diagnostico_id');
 $desbalDeFase1 = aux::GeralAnormalidadesTE($atual1)->where('diagnostico_id', '=', 2)->count('diagnostico_id');
 $compMalDim1 = aux::GeralAnormalidadesTE($atual1)->where('diagnostico_id', '=', 3)->count('diagnostico_id');
 $caboRessecado1 = aux::GeralAnormalidadesTE($atual1)->where('diagnostico_id', '=', 4)->count('diagnostico_id');
 $defeitoComp1 = aux::GeralAnormalidadesTE($atual1)->where('diagnostico_id', '=', 5)->count('diagnostico_id');
 $conexaoTerm1 = aux::GeralAnormalidadesTE($atual1)->where('diagnostico_id', '=', 37)->count('diagnostico_id');

 $faltaAperto2 = aux::GeralAnormalidadesTE($atual2)->where('diagnostico_id', '=', 1)->count('diagnostico_id');
 $desbalDeFase2 = aux::GeralAnormalidadesTE($atual2)->where('diagnostico_id', '=', 2)->count('diagnostico_id');
 $compMalDim2 = aux::GeralAnormalidadesTE($atual2)->where('diagnostico_id', '=', 3)->count('diagnostico_id');
 $caboRessecado2 = aux::GeralAnormalidadesTE($atual2)->where('diagnostico_id', '=', 4)->count('diagnostico_id');
 $defeitoComp2 = aux::GeralAnormalidadesTE($atual2)->where('diagnostico_id', '=', 5)->count('diagnostico_id');
 $conexaoTerm2 = aux::GeralAnormalidadesTE($atual2)->where('diagnostico_id', '=', 37)->count('diagnostico_id');

 $faltaAperto3 = aux::GeralAnormalidadesTE($atual3)->where('diagnostico_id', '=', 1)->count('diagnostico_id');
 $desbalDeFase3 = aux::GeralAnormalidadesTE($atual3)->where('diagnostico_id', '=', 2)->count('diagnostico_id');
 $compMalDim3 = aux::GeralAnormalidadesTE($atual3)->where('diagnostico_id', '=', 3)->count('diagnostico_id');
 $caboRessecado3 = aux::GeralAnormalidadesTE($atual3)->where('diagnostico_id', '=', 4)->count('diagnostico_id');
 $defeitoComp3 = aux::GeralAnormalidadesTE($atual3)->where('diagnostico_id', '=', 5)->count('diagnostico_id');
 $conexaoTerm3 = aux::GeralAnormalidadesTE($atual3)->where('diagnostico_id', '=', 37)->count('diagnostico_id');

 $faltaAperto4 = aux::GeralAnormalidadesTE($atual4)->where('diagnostico_id', '=', 1)->count('diagnostico_id');
 $desbalDeFase4 = aux::GeralAnormalidadesTE($atual4)->where('diagnostico_id', '=', 2)->count('diagnostico_id');
 $compMalDim4 = aux::GeralAnormalidadesTE($atual4)->where('diagnostico_id', '=', 3)->count('diagnostico_id');
 $caboRessecado4 = aux::GeralAnormalidadesTE($atual4)->where('diagnostico_id', '=', 4)->count('diagnostico_id');
 $defeitoComp4 = aux::GeralAnormalidadesTE($atual4)->where('diagnostico_id', '=', 5)->count('diagnostico_id');
 $conexaoTerm4 = aux::GeralAnormalidadesTE($atual4)->where('diagnostico_id', '=', 37)->count('diagnostico_id');

 $faltaAperto5 = aux::GeralAnormalidadesTE($atual5)->where('diagnostico_id', '=', 1)->count('diagnostico_id');
 $desbalDeFase5 = aux::GeralAnormalidadesTE($atual5)->where('diagnostico_id', '=', 2)->count('diagnostico_id');
 $compMalDim5 = aux::GeralAnormalidadesTE($atual5)->where('diagnostico_id', '=', 3)->count('diagnostico_id');
 $caboRessecado5 = aux::GeralAnormalidadesTE($atual5)->where('diagnostico_id', '=', 4)->count('diagnostico_id');
 $defeitoComp5 = aux::GeralAnormalidadesTE($atual5)->where('diagnostico_id', '=', 5)->count('diagnostico_id');
 $conexaoTerm5 = aux::GeralAnormalidadesTE($atual5)->where('diagnostico_id', '=', 37)->count('diagnostico_id');

 $faltaAperto6 = aux::GeralAnormalidadesTE($atual6)->where('diagnostico_id', '=', 1)->count('diagnostico_id');
 $desbalDeFase6 = aux::GeralAnormalidadesTE($atual6)->where('diagnostico_id', '=', 2)->count('diagnostico_id');
 $compMalDim6 = aux::GeralAnormalidadesTE($atual6)->where('diagnostico_id', '=', 3)->count('diagnostico_id');
 $caboRessecado6 = aux::GeralAnormalidadesTE($atual6)->where('diagnostico_id', '=', 4)->count('diagnostico_id');
 $defeitoComp6 = aux::GeralAnormalidadesTE($atual6)->where('diagnostico_id', '=', 5)->count('diagnostico_id');
 $conexaoTerm6 = aux::GeralAnormalidadesTE($atual6)->where('diagnostico_id', '=', 37)->count('diagnostico_id');

 $faltaAperto7 = aux::GeralAnormalidadesTE($atual7)->where('diagnostico_id', '=', 1)->count('diagnostico_id');
 $desbalDeFase7 = aux::GeralAnormalidadesTE($atual7)->where('diagnostico_id', '=', 2)->count('diagnostico_id');
 $compMalDim7 = aux::GeralAnormalidadesTE($atual7)->where('diagnostico_id', '=', 3)->count('diagnostico_id');
 $caboRessecado7 = aux::GeralAnormalidadesTE($atual7)->where('diagnostico_id', '=', 4)->count('diagnostico_id');
 $defeitoComp7 = aux::GeralAnormalidadesTE($atual7)->where('diagnostico_id', '=', 5)->count('diagnostico_id');
 $conexaoTerm7 = aux::GeralAnormalidadesTE($atual7)->where('diagnostico_id', '=', 37)->count('diagnostico_id');

 $faltaAperto8 = aux::GeralAnormalidadesTE($atual8)->where('diagnostico_id', '=', 1)->count('diagnostico_id');
 $desbalDeFase8 = aux::GeralAnormalidadesTE($atual8)->where('diagnostico_id', '=', 2)->count('diagnostico_id');
 $compMalDim8 = aux::GeralAnormalidadesTE($atual8)->where('diagnostico_id', '=', 3)->count('diagnostico_id');
 $caboRessecado8 = aux::GeralAnormalidadesTE($atual8)->where('diagnostico_id', '=', 4)->count('diagnostico_id');
 $defeitoComp8 = aux::GeralAnormalidadesTE($atual8)->where('diagnostico_id', '=', 5)->count('diagnostico_id');
 $conexaoTerm8 = aux::GeralAnormalidadesTE($atual8)->where('diagnostico_id', '=', 37)->count('diagnostico_id');

 $faltaAperto9 = aux::GeralAnormalidadesTE($atual9)->where('diagnostico_id', '=', 1)->count('diagnostico_id');
 $desbalDeFase9 = aux::GeralAnormalidadesTE($atual9)->where('diagnostico_id', '=', 2)->count('diagnostico_id');
 $compMalDim9 = aux::GeralAnormalidadesTE($atual9)->where('diagnostico_id', '=', 3)->count('diagnostico_id');
 $caboRessecado9 = aux::GeralAnormalidadesTE($atual9)->where('diagnostico_id', '=', 4)->count('diagnostico_id');
 $defeitoComp9 = aux::GeralAnormalidadesTE($atual9)->where('diagnostico_id', '=', 5)->count('diagnostico_id');
 $conexaoTerm9 = aux::GeralAnormalidadesTE($atual9)->where('diagnostico_id', '=', 37)->count('diagnostico_id');

 $faltaAperto10 = aux::GeralAnormalidadesTE($atual10)->where('diagnostico_id', '=', 1)->count('diagnostico_id');
 $desbalDeFase10 = aux::GeralAnormalidadesTE($atual10)->where('diagnostico_id', '=', 2)->count('diagnostico_id');
 $compMalDim10 = aux::GeralAnormalidadesTE($atual10)->where('diagnostico_id', '=', 3)->count('diagnostico_id');
 $caboRessecado10 = aux::GeralAnormalidadesTE($atual10)->where('diagnostico_id', '=', 4)->count('diagnostico_id');
 $defeitoComp10 = aux::GeralAnormalidadesTE($atual10)->where('diagnostico_id', '=', 5)->count('diagnostico_id');
 $conexaoTerm10 = aux::GeralAnormalidadesTE($atual10)->where('diagnostico_id', '=', 37)->count('diagnostico_id');

 $faltaAperto11 = aux::GeralAnormalidadesTE($atual11)->where('diagnostico_id', '=', 1)->count('diagnostico_id');
 $desbalDeFase11 = aux::GeralAnormalidadesTE($atual11)->where('diagnostico_id', '=', 2)->count('diagnostico_id');
 $compMalDim11 = aux::GeralAnormalidadesTE($atual11)->where('diagnostico_id', '=', 3)->count('diagnostico_id');
 $caboRessecado11 = aux::GeralAnormalidadesTE($atual11)->where('diagnostico_id', '=', 4)->count('diagnostico_id');
 $defeitoComp11 = aux::GeralAnormalidadesTE($atual11)->where('diagnostico_id', '=', 5)->count('diagnostico_id');
 $conexaoTerm11 = aux::GeralAnormalidadesTE($atual11)->where('diagnostico_id', '=', 37)->count('diagnostico_id');

 $faltaAperto12 = aux::GeralAnormalidadesTE($atual12)->where('diagnostico_id', '=', 1)->count('diagnostico_id');
 $desbalDeFase12 = aux::GeralAnormalidadesTE($atual12)->where('diagnostico_id', '=', 2)->count('diagnostico_id');
 $compMalDim12 = aux::GeralAnormalidadesTE($atual12)->where('diagnostico_id', '=', 3)->count('diagnostico_id');
 $caboRessecado12 = aux::GeralAnormalidadesTE($atual12)->where('diagnostico_id', '=', 4)->count('diagnostico_id');
 $defeitoComp12 = aux::GeralAnormalidadesTE($atual12)->where('diagnostico_id', '=', 5)->count('diagnostico_id');
 $conexaoTerm12 = aux::GeralAnormalidadesTE($atual12)->where('diagnostico_id', '=', 37)->count('diagnostico_id');

     return view('csn.relatorioGerencial.includes.indexRelGerLB')->with('title', $title)->with('sum', $sum)
     ->with('normal', $normal)->with('alarme', $alarme)->with('critico', $critico)->with('manutencao', $manutencao)->with('standBy', $standBy)
     ->with('normalP', $normalP)->with('alarmeP', $alarmeP)->with('criticoP', $criticoP)->with('manutencaoP', $manutencaoP)->with('standByP', $standByP)
       ->with('ura_normal', $ura_normal)->with('ura_alarme', $ura_alarme)->with('ura_critico', $ura_critico)->with('ura_manutencao', $ura_manutencao)->with('ura_standBy', $standBy)
       ->with('ura_normalP', $ura_normalP)->with('ura_alarmeP', $ura_alarmeP)->with('ura_criticoP', $ura_criticoP)->with('ura_manutencaoP', $ura_manutencaoP)->with('ura_standByP', $ura_standByP)
         ->with('lds_normal', $lds_normal)->with('lds_alarme', $lds_alarme)->with('lds_critico', $lds_critico)->with('lds_manutencao', $lds_manutencao)->with('lds_standBy', $lds_standBy)
         ->with('lds_normalP', $lds_normalP)->with('lds_alarmeP', $lds_alarmeP)->with('lds_criticoP', $lds_criticoP)->with('lds_manutencaoP', $lds_manutencaoP)->with('lds_standByP', $lds_standByP)
          ->with('lrf_normal', $lrf_normal)->with('lrf_alarme', $lrf_alarme)->with('lrf_critico', $lrf_critico)->with('lrf_manutencao', $lrf_manutencao)->with('lrf_standBy', $lrf_standBy)
          ->with('lrf_normalP', $lrf_normalP)->with('lrf_alarmeP', $lrf_alarmeP)->with('lrf_criticoP', $lrf_criticoP)->with('lrf_manutencaoP', $lrf_manutencaoP)->with('lrf_standByP', $lrf_standByP)
            ->with('lgc_normal', $lgc_normal)->with('lgc_alarme', $lgc_alarme)->with('lgc_critico', $lgc_critico)->with('lgc_manutencao', $lgc_manutencao)->with('lgc_standBy', $lgc_standBy)
            ->with('lgc_normalP', $lgc_normalP)->with('lgc_alarmeP', $lgc_alarmeP)->with('lgc_criticoP', $lgc_criticoP)->with('lgc_manutencaoP', $lgc_manutencaoP)->with('lgc_standByP', $lgc_standByP)
             ->with('uti_normal', $uti_normal)->with('uti_alarme', $uti_alarme)->with('uti_critico', $uti_critico)->with('uti_manutencao', $uti_manutencao)->with('uti_standBy', $uti_standBy)
             ->with('uti_normalP', $uti_normalP)->with('uti_alarmeP', $uti_alarmeP)->with('uti_criticoP', $uti_criticoP)->with('uti_manutencaoP', $uti_manutencaoP)->with('uti_standByP', $uti_standByP)
              ->with('lpc_normal', $lpc_normal)->with('lpc_alarme', $lpc_alarme)->with('lpc_critico', $lpc_critico)->with('lpc_manutencao', $lpc_manutencao)->with('lpc_standBy', $lpc_standBy)
              ->with('lpc_normalP', $lpc_normalP)->with('lpc_alarmeP', $lpc_alarmeP)->with('lpc_criticoP', $lpc_criticoP)->with('lpc_manutencaoP', $lpc_manutencaoP)->with('lpc_standByP', $lpc_standByP)
                ->with('cs_normal', $cs_normal)->with('cs_alarme', $cs_alarme)->with('cs_critico', $cs_critico)->with('cs_manutencao', $cs_manutencao)->with('cs_standBy', $cs_standBy)
                ->with('cs_normalP', $cs_normalP)->with('cs_alarmeP', $cs_alarmeP)->with('cs_criticoP', $cs_criticoP)->with('cs_manutencaoP', $cs_manutencaoP)->with('cs_standByP', $cs_standByP)
                 ->with('pr_normal', $pr_normal)->with('pr_alarme', $pr_alarme)->with('pr_critico', $pr_critico)->with('pr_manutencao', $pr_manutencao)->with('pr_standBy', $pr_standBy)
                 ->with('pr_normalP', $pr_normalP)->with('pr_alarmeP', $pr_alarmeP)->with('pr_criticoP', $pr_criticoP)->with('pr_manutencaoP', $pr_manutencaoP)->with('pr_standByP', $pr_standByP)
                 ->with('tabela', $tabela)->with('tb_anormalidades', $tb_anormalidades)->with('tb_normal', $tb_normal)->with('tb_alarme', $tb_alarme)
                 ->with('tb_critico', $tb_critico)->with('tb_manutencao', $tb_manutencao)->with('tb_standBy', $tb_standBy)
                   ->with('atual1', $atual1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
                   ->with('atual2', $atual2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
                   ->with('atual3', $atual3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
                   ->with('atual4', $atual4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
                   ->with('atual5', $atual5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
                   ->with('atual6', $atual6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
                   ->with('atual7', $atual7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
                   ->with('atual8', $atual8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
                   ->with('atual9', $atual9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
                   ->with('atual10', $atual10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
                   ->with('atual11', $atual11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
                   ->with('atual12', $atual12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12)
                   ->with('atualf1', $atualf1)->with('alarme1_anorm', $alarme1_anorm)->with('critico1_anorm', $critico1_anorm)
                   ->with('atualf2', $atualf2)->with('alarme2_anorm', $alarme2_anorm)->with('critico2_anorm', $critico2_anorm)
                   ->with('atualf3', $atualf3)->with('alarme3_anorm', $alarme3_anorm)->with('critico3_anorm', $critico3_anorm)
                   ->with('atualf4', $atualf4)->with('alarme4_anorm', $alarme4_anorm)->with('critico4_anorm', $critico4_anorm)
                   ->with('atualf5', $atualf5)->with('alarme5_anorm', $alarme5_anorm)->with('critico5_anorm', $critico5_anorm)
                   ->with('atualf6', $atualf6)->with('alarme6_anorm', $alarme6_anorm)->with('critico6_anorm', $critico6_anorm)
                   ->with('atualf7', $atualf7)->with('alarme7_anorm', $alarme7_anorm)->with('critico7_anorm', $critico7_anorm)
                   ->with('atualf8', $atualf8)->with('alarme8_anorm', $alarme8_anorm)->with('critico8_anorm', $critico8_anorm)
                   ->with('atualf9', $atualf9)->with('alarme9_anorm', $alarme9_anorm)->with('critico9_anorm', $critico9_anorm)
                   ->with('atualf10', $atualf10)->with('alarme10_anorm', $alarme10_anorm)->with('critico10_anorm', $critico10_anorm)
                   ->with('atualf11', $atualf11)->with('alarme11_anorm', $alarme11_anorm)->with('critico11_anorm', $critico11_anorm)
                   ->with('atualf12', $atualf12)->with('alarme12_anorm', $alarme12_anorm)->with('critico12_anorm', $critico12_anorm)
                   ->with('faltaAperto1', $faltaAperto1)->with('desbalDeFase1', $desbalDeFase1)->with('compMalDim1', $compMalDim1)->with('caboRessecado1', $caboRessecado1)->with('defeitoComp1', $defeitoComp1)->with('conexaoTerm1', $conexaoTerm1)
                   ->with('faltaAperto2', $faltaAperto2)->with('desbalDeFase2', $desbalDeFase2)->with('compMalDim2', $compMalDim2)->with('caboRessecado2', $caboRessecado2)->with('defeitoComp2', $defeitoComp2)->with('conexaoTerm2', $conexaoTerm2)
                   ->with('faltaAperto3', $faltaAperto3)->with('desbalDeFase3', $desbalDeFase3)->with('compMalDim3', $compMalDim3)->with('caboRessecado3', $caboRessecado3)->with('defeitoComp3', $defeitoComp3)->with('conexaoTerm3', $conexaoTerm3)
                   ->with('faltaAperto4', $faltaAperto4)->with('desbalDeFase4', $desbalDeFase4)->with('compMalDim4', $compMalDim4)->with('caboRessecado4', $caboRessecado4)->with('defeitoComp4', $defeitoComp4)->with('conexaoTerm4', $conexaoTerm4)
                   ->with('faltaAperto5', $faltaAperto5)->with('desbalDeFase5', $desbalDeFase5)->with('compMalDim5', $compMalDim5)->with('caboRessecado5', $caboRessecado5)->with('defeitoComp5', $defeitoComp5)->with('conexaoTerm5', $conexaoTerm5)
                   ->with('faltaAperto6', $faltaAperto6)->with('desbalDeFase6', $desbalDeFase6)->with('compMalDim6', $compMalDim6)->with('caboRessecado6', $caboRessecado6)->with('defeitoComp6', $defeitoComp6)->with('conexaoTerm6', $conexaoTerm6)
                   ->with('faltaAperto7', $faltaAperto7)->with('desbalDeFase7', $desbalDeFase7)->with('compMalDim7', $compMalDim7)->with('caboRessecado7', $caboRessecado7)->with('defeitoComp7', $defeitoComp7)->with('conexaoTerm7', $conexaoTerm7)
                   ->with('faltaAperto8', $faltaAperto8)->with('desbalDeFase8', $desbalDeFase8)->with('compMalDim8', $compMalDim8)->with('caboRessecado8', $caboRessecado8)->with('defeitoComp8', $defeitoComp8)->with('conexaoTerm8', $conexaoTerm8)
                   ->with('faltaAperto9', $faltaAperto9)->with('desbalDeFase9', $desbalDeFase9)->with('compMalDim9', $compMalDim9)->with('caboRessecado9', $caboRessecado9)->with('defeitoComp9', $defeitoComp9)->with('conexaoTerm9', $conexaoTerm9)
                   ->with('faltaAperto10', $faltaAperto10)->with('desbalDeFase10', $desbalDeFase10)->with('compMalDim10', $compMalDim10)->with('caboRessecado10', $caboRessecado10)->with('defeitoComp10', $defeitoComp10)->with('conexaoTerm10', $conexaoTerm10)
                   ->with('faltaAperto11', $faltaAperto11)->with('desbalDeFase11', $desbalDeFase11)->with('compMalDim11', $compMalDim11)->with('caboRessecado11', $caboRessecado11)->with('defeitoComp11', $defeitoComp11)->with('conexaoTerm11', $conexaoTerm11)
                   ->with('faltaAperto12', $faltaAperto12)->with('desbalDeFase12', $desbalDeFase12)->with('compMalDim12', $compMalDim12)->with('caboRessecado12', $caboRessecado12)->with('defeitoComp12', $defeitoComp12)->with('conexaoTerm12', $conexaoTerm12);
  }
   public function GeralStatusPontos() {

     $title = 'Preditiva | GGOP PR';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->pluck("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();
     $normal001 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt1, $atualInicial])->where('tecnicas_id', '=', 4)->where('status_id', '=', 3)->count('status_id');
     $alarme001 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt1, $atualInicial])->where('tecnicas_id', '=', 4)->where('status_id', '=', 4)->count('status_id');
     $critico001 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt1, $atualInicial])->where('tecnicas_id', '=', 4)->where('status_id', '=', 5)->count('status_id');

     $n1 = ($normal001+$alarme001+$critico001);
     $a1 = ($normal001+$alarme001+$critico001);
     $c1 = ($normal001+$alarme001+$critico001);
     if ($n1 > 0) {
       $normal1 = number_format((($normal001/$n1)*100),0,",",".");
     } else {
      $normal1 = 0;
    }
     if ($a1 > 0) {
       $alarme1 = number_format((($alarme001/$a1)*100),0,",",".");
     } else {
      $alarme1 = 0;
    }
     if ($c1 > 0) {
       $critico1 = number_format((($critico001/$c1)*100),0,",",".");
     } else {
      $critico1 = 0;
    }

     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();
     $normal002 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])->where('tecnicas_id', '=', 4)->where('status_id', '=', 3)->count('status_id');
     $alarme002 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])->where('tecnicas_id', '=', 4)->where('status_id', '=', 4)->count('status_id');
     $critico002 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])->where('tecnicas_id', '=', 4)->where('status_id', '=', 5)->count('status_id');

     $n2 = ($normal002+$alarme002+$critico002);
     $a2 = ($normal002+$alarme002+$critico002);
     $c2 = ($normal002+$alarme002+$critico002);
     if ($n2 > 0) {
       $normal2 = number_format((($normal002/$n2)*100),0,",",".");
     } else {
      $normal2 = 0;
    }
     if ($a2 > 0) {
       $alarme2 = number_format((($alarme002/$a2)*100),0,",",".");
     } else {
      $alarme2 = 0;
    }
     if ($c2 > 0) {
       $critico2 = number_format((($critico002/$c2)*100),0,",",".");
     } else {
       $critico2 = 0;
     }

     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();
     $normal003 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])->where('tecnicas_id', '=', 4)->where('status_id', '=', 3)->count('status_id');
     $alarme003 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])->where('tecnicas_id', '=', 4)->where('status_id', '=', 4)->count('status_id');
     $critico003 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])->where('tecnicas_id', '=', 4)->where('status_id', '=', 5)->count('status_id');

     $n3 = ($normal003+$alarme003+$critico003);
     $a3 = ($normal003+$alarme003+$critico003);
     $c3 = ($normal003+$alarme003+$critico003);
     if ($n3 > 0) {
       $normal3 = number_format((($normal003/$n3)*100),0,",",".");
     } else {
      $normal3 = 0;
    }
     if ($a3 > 0) {
       $alarme3 = number_format((($alarme003/$a3)*100),0,",",".");
     } else {
      $alarme3 = 0;
    }
     if ($c3 > 0) {
       $critico3 = number_format((($critico003/$c3)*100),0,",",".");
     } else {
      $critico3 = 0;
    }

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();
     $normal004 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])->where('tecnicas_id', '=', 4)->where('status_id', '=', 3)->count('status_id');
     $alarme004 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])->where('tecnicas_id', '=', 4)->where('status_id', '=', 4)->count('status_id');
     $critico004 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])->where('tecnicas_id', '=', 4)->where('status_id', '=', 5)->count('status_id');

     $n4 = ($normal004+$alarme004+$critico004);
     $a4 = ($normal004+$alarme004+$critico004);
     $c4 = ($normal004+$alarme004+$critico004);
     if ($n4 > 0) {
       $normal4 = number_format((($normal004/$n4)*100),0,",",".");
     } else {
      $normal4 = 0;
    }
     if ($a4 > 0) {
       $alarme4 = number_format((($alarme004/$a4)*100),0,",",".");
     } else {
      $alarme4 = 0;
    }
     if ($c4 > 0) {
       $critico4 = number_format((($critico004/$c4)*100),0,",",".");
     } else {
      $critico4 = 0;
    }

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();
     $normal005 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])->where('tecnicas_id', '=', 4)->where('status_id', '=', 3)->count('status_id');
     $alarme005 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])->where('tecnicas_id', '=', 4)->where('status_id', '=', 4)->count('status_id');
     $critico005 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])->where('tecnicas_id', '=', 4)->where('status_id', '=', 5)->count('status_id');

     $n5 = ($normal005+$alarme005+$critico005);
     $a5 = ($normal005+$alarme005+$critico005);
     $c5 = ($normal005+$alarme005+$critico005);
     if ($n5 > 0) {
       $normal5 = number_format((($normal005/$n5)*100),0,",",".");
     } else {
      $normal5 = 0;
    }
     if ($a5 > 0) {
       $alarme5 = number_format((($alarme005/$a5)*100),0,",",".");
     } else {
      $alarme5 = 0;
    }
     if ($c5 > 0) {
       $critico5 = number_format((($critico005/$c5)*100),0,",",".");
     } else {
      $critico5 = 0;
    }

     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();
     $normal006 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])->where('tecnicas_id', '=', 4)->where('status_id', '=', 3)->count('status_id');
     $alarme006 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])->where('tecnicas_id', '=', 4)->where('status_id', '=', 4)->count('status_id');
     $critico006 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])->where('tecnicas_id', '=', 4)->where('status_id', '=', 5)->count('status_id');

     $n6 = ($normal006+$alarme006+$critico006);
     $a6 = ($normal006+$alarme006+$critico006);
     $c6 = ($normal006+$alarme006+$critico006);





     if ($n6 > 0) {
       $normal6 = number_format((($normal006/$n6)*100),0,",",".");
     } else {
      $normal6 = 0;
    }
     if ($a6 > 0) {
       $alarme6 = number_format((($alarme006/$a6)*100),0,",",".");
     } else {
      $alarme6 = 0;
    }
     if ($c6 > 0) {
       $critico6 = number_format((($critico006/$c6)*100),0,",",".");
     } else {
      $critico6 = 0;
    }

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();
     $normal007 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])->where('tecnicas_id', '=', 4)->where('status_id', '=', 3)->count('status_id');
     $alarme007 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])->where('tecnicas_id', '=', 4)->where('status_id', '=', 4)->count('status_id');
     $critico007 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])->where('tecnicas_id', '=', 4)->where('status_id', '=', 5)->count('status_id');

     $n7 = ($normal007+$alarme007+$critico007);
     $a7 = ($normal007+$alarme007+$critico007);
     $c7 = ($normal007+$alarme007+$critico007);

     if ($n7 > 0) {
       $normal7 = number_format((($normal007/$n7)*100),0,",",".");
     } else {
      $normal7 = 0;
    }
     if ($a7 > 0) {
       $alarme7 = number_format((($alarme007/$a7)*100),0,",",".");
     } else {
      $alarme7 = 0;
    }
     if ($c7 > 0) {
       $critico7 = number_format((($critico007/$c7)*100),0,",",".");
     } else {
      $critico7 = 0;
    }

     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();
     $normal008 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])->where('tecnicas_id', '=', 4)->where('status_id', '=', 3)->count('status_id');
     $alarme008 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])->where('tecnicas_id', '=', 4)->where('status_id', '=', 4)->count('status_id');
     $critico008 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])->where('tecnicas_id', '=', 4)->where('status_id', '=', 5)->count('status_id');

     $n8 = ($normal008+$alarme008+$critico008);
     $a8 = ($normal008+$alarme008+$critico008);
     $c8 = ($normal008+$alarme008+$critico008);

     if ($n8 > 0) {
       $normal8 = number_format((($normal008/$n8)*100),0,",",".");
     } else {
      $normal8 = 0;
    }
     if ($a8 > 0) {
       $alarme8 = number_format((($alarme008/$a8)*100),0,",",".");
     } else {
      $alarme8 = 0;
    }
     if ($c8 > 0) {
       $critico8 = number_format((($critico008/$c8)*100),0,",",".");
     } else {
      $critico8 = 0;
    }

     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();
     $normal009 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])->where('tecnicas_id', '=', 4)->where('status_id', '=', 3)->count('status_id');
     $alarme009 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])->where('tecnicas_id', '=', 4)->where('status_id', '=', 4)->count('status_id');
     $critico009 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])->where('tecnicas_id', '=', 4)->where('status_id', '=', 5)->count('status_id');

     $n9 = ($normal009+$alarme009+$critico009);
     $a9 = ($normal009+$alarme009+$critico009);
     $c9 = ($normal009+$alarme009+$critico009);

     if ($n9 > 0) {
       $normal9 = number_format((($normal009/$n9)*100),0,",",".");
     } else {
      $normal9 = 0;
    }
     if ($a9 > 0) {
       $alarme9 = number_format((($alarme009/$a9)*100),0,",",".");
     } else {
      $alarme9 = 0;
    }
     if ($c9 > 0) {
       $critico9 = number_format((($critico009/$c9)*100),0,",",".");
     } else {
      $critico9 = 0;
    }

     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();
     $normal010 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])->where('tecnicas_id', '=', 4)->where('status_id', '=', 3)->count('status_id');
     $alarme010 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])->where('tecnicas_id', '=', 4)->where('status_id', '=', 4)->count('status_id');
     $critico010 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])->where('tecnicas_id', '=', 4)->where('status_id', '=', 5)->count('status_id');

     $n10 = ($normal010+$alarme010+$critico010);
     $a10 = ($normal010+$alarme010+$critico010);
     $c10 = ($normal010+$alarme010+$critico010);

     if ($n10 > 0) {
       $normal10 = number_format((($normal010/$n10)*100),0,",",".");
     } else {
      $normal10 = 0;
    }
     if ($a10 > 0) {
       $alarme10 = number_format((($alarme010/$a10)*100),0,",",".");
     } else {
      $alarme10 = 0;
    }
     if ($c10 > 0) {
       $critico10 = number_format((($critico010/$c10)*100),0,",",".");
     } else {
      $critico10 = 0;
    }

     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();
     $normal011 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])->where('tecnicas_id', '=', 4)->where('status_id', '=', 3)->count('status_id');
     $alarme011 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])->where('tecnicas_id', '=', 4)->where('status_id', '=', 4)->count('status_id');
     $critico011 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])->where('tecnicas_id', '=', 4)->where('status_id', '=', 5)->count('status_id');

     $n11 = ($normal011+$alarme011+$critico011);
     $a11 = ($normal011+$alarme011+$critico011);
     $c11 = ($normal011+$alarme011+$critico011);

     if ($n11 > 0) {
       $normal11 = number_format((($normal011/$n11)*100),0,",",".");
     } else {
      $normal11 = 0;
    }
     if ($a11 > 0) {
       $alarme11 = number_format((($alarme011/$a11)*100),0,",",".");
     } else {
      $alarme11 = 0;
    }
     if ($c11 > 0) {
       $critico11 = number_format((($critico011/$c11)*100),0,",",".");
     } else {
      $critico11 = 0;
    }

     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();
     $normal012 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])->where('tecnicas_id', '=', 4)->where('status_id', '=', 3)->count('status_id');
     $alarme012 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])->where('tecnicas_id', '=', 4)->where('status_id', '=', 4)->count('status_id');
     $critico012 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])->where('tecnicas_id', '=', 4)->where('status_id', '=', 5)->count('status_id');

     $n12 = ($normal012+$alarme012+$critico012);
     $a12 = ($normal012+$alarme012+$critico012);
     $c12 = ($normal012+$alarme012+$critico012);

     if ($n12 > 0) {
       $normal12 = number_format((($normal012/$n12)*100),0,",",".");
     } else {
      $normal12 = 0;
    }
     if ($a12 > 0) {
       $alarme12 = number_format((($alarme012/$a12)*100),0,",",".");
     } else {
      $alarme12 = 0;
    }
     if ($c12 > 0) {
       $critico12 = number_format((($critico012/$c12)*100),0,",",".");
     } else {
       $critico12 = 0;
     }

     return view('csn.relatorioGerencial.includes.relatoriosOleo.ggoppr-statusPontos')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);
     }

   public function GeralProblemasEncontrados() {

     $title = 'Preditiva | GGOP PR';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->pluck("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $agua1 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt1, $atualInicial])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 17)->count('diagnostico_id');
     $particulado1 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt1, $atualInicial])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 18)->count('diagnostico_id');
     $viscosidade1 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt1, $atualInicial])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 19)->count('diagnostico_id');
     $demulsibilidade1 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt1, $atualInicial])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 20)->count('diagnostico_id');
     $desgaste1 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt1, $atualInicial])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 21)->count('diagnostico_id');




     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $agua2 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 17)->count('diagnostico_id');
     $particulado2 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 18)->count('diagnostico_id');
     $viscosidade2 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 19)->count('diagnostico_id');
     $demulsibilidade2 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 20)->count('diagnostico_id');
     $desgaste2 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 21)->count('diagnostico_id');


     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $agua3 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 17)->count('diagnostico_id');
     $particulado3 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 18)->count('diagnostico_id');
     $viscosidade3 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 19)->count('diagnostico_id');
     $demulsibilidade3 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 20)->count('diagnostico_id');
     $desgaste3 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 21)->count('diagnostico_id');


     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $agua4 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 17)->count('diagnostico_id');
     $particulado4 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 18)->count('diagnostico_id');
     $viscosidade4 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 19)->count('diagnostico_id');
     $demulsibilidade4 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 20)->count('diagnostico_id');
     $desgaste4 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 21)->count('diagnostico_id');


     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();

     $agua5 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 17)->count('diagnostico_id');
     $particulado5 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 18)->count('diagnostico_id');
     $viscosidade5 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 19)->count('diagnostico_id');
     $demulsibilidade5 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 20)->count('diagnostico_id');
     $desgaste5 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 21)->count('diagnostico_id');


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();

     $agua6 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 17)->count('diagnostico_id');
     $particulado6 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 18)->count('diagnostico_id');
     $viscosidade6 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 19)->count('diagnostico_id');
     $demulsibilidade6 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 20)->count('diagnostico_id');
     $desgaste6 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 21)->count('diagnostico_id');


     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();

     $agua7 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 17)->count('diagnostico_id');
     $particulado7 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 18)->count('diagnostico_id');
     $viscosidade7 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 19)->count('diagnostico_id');
     $demulsibilidade7 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 20)->count('diagnostico_id');
     $desgaste7 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 21)->count('diagnostico_id');



     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $agua8 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 17)->count('diagnostico_id');
     $particulado8 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 18)->count('diagnostico_id');
     $viscosidade8 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 19)->count('diagnostico_id');
     $demulsibilidade8 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 20)->count('diagnostico_id');
     $desgaste8 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 21)->count('diagnostico_id');



     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $agua9 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 17)->count('diagnostico_id');
     $particulado9 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 18)->count('diagnostico_id');
     $viscosidade9 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 19)->count('diagnostico_id');
     $demulsibilidade9 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 20)->count('diagnostico_id');
     $desgaste9 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 21)->count('diagnostico_id');


     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

     $agua10 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 17)->count('diagnostico_id');
     $particulado10 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 18)->count('diagnostico_id');
     $viscosidade10 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 19)->count('diagnostico_id');
     $demulsibilidade10 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 20)->count('diagnostico_id');
     $desgaste10 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 21)->count('diagnostico_id');


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

     $agua11 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 17)->count('diagnostico_id');
     $particulado11 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 18)->count('diagnostico_id');
     $viscosidade11 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 19)->count('diagnostico_id');
     $demulsibilidade11 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 20)->count('diagnostico_id');
     $desgaste11 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 21)->count('diagnostico_id');



     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();
     $agua12 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 17)->count('diagnostico_id');
     $particulado12 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 18)->count('diagnostico_id');
     $viscosidade12 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 19)->count('diagnostico_id');
     $demulsibilidade12 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 20)->count('diagnostico_id');
     $desgaste12 = Preditiva_analises::whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])->where('tecnicas_id', '=', 4)->where('diagnostico_id', '=', 21)->count('diagnostico_id');


     return view('csn.relatorioGerencial.includes.relatoriosOleo.ggoppr-problemasEncontrados')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('agua1', $agua1)->with('particulado1', $particulado1)->with('viscosidade1', $viscosidade1)
       ->with('demulsibilidade1', $demulsibilidade1)->with('desgaste1', $desgaste1)
       ->with('dataFAnt2', $dataFAnt2)->with('agua2', $agua2)->with('particulado2', $particulado2)->with('viscosidade2', $viscosidade2)
       ->with('demulsibilidade2', $demulsibilidade2)->with('desgaste2', $desgaste2)
       ->with('dataFAnt3', $dataFAnt3)->with('agua3', $agua3)->with('particulado3', $particulado3)->with('viscosidade3', $viscosidade3)
       ->with('demulsibilidade3', $demulsibilidade3)->with('desgaste3', $desgaste3)
       ->with('dataFAnt4', $dataFAnt4)->with('agua4', $agua4)->with('particulado4', $particulado4)->with('viscosidade4', $viscosidade4)
       ->with('demulsibilidade4', $demulsibilidade4)->with('desgaste4', $desgaste4)
       ->with('dataFAnt5', $dataFAnt5)->with('agua5', $agua5)->with('particulado5', $particulado5)->with('viscosidade5', $viscosidade5)
       ->with('demulsibilidade5', $demulsibilidade5)->with('desgaste5', $desgaste5)
       ->with('dataFAnt6', $dataFAnt6)->with('agua6', $agua6)->with('particulado6', $particulado6)->with('viscosidade6', $viscosidade6)
       ->with('demulsibilidade6', $demulsibilidade6)->with('desgaste6', $desgaste6)
       ->with('dataFAnt7', $dataFAnt7)->with('agua7', $agua7)->with('particulado7', $particulado7)->with('viscosidade7', $viscosidade7)
       ->with('demulsibilidade7', $demulsibilidade7)->with('desgaste7', $desgaste7)
       ->with('dataFAnt8', $dataFAnt8)->with('agua8', $agua8)->with('particulado8', $particulado8)->with('viscosidade8', $viscosidade8)
       ->with('demulsibilidade8', $demulsibilidade8)->with('desgaste8', $desgaste8)
       ->with('dataFAnt9', $dataFAnt9)->with('agua9', $agua9)->with('particulado9', $particulado9)->with('viscosidade9', $viscosidade9)
       ->with('demulsibilidade9', $demulsibilidade9)->with('desgaste9', $desgaste9)
       ->with('dataFAnt10', $dataFAnt10)->with('agua10', $agua10)->with('particulado10', $particulado10)->with('viscosidade10', $viscosidade10)
       ->with('demulsibilidade10', $demulsibilidade10)->with('desgaste10', $desgaste10)
       ->with('dataFAnt11', $dataFAnt11)->with('agua11', $agua11)->with('particulado11', $particulado11)->with('viscosidade11', $viscosidade11)
       ->with('demulsibilidade11', $demulsibilidade11)->with('desgaste11', $desgaste11)
       ->with('dataFAnt12', $dataFAnt12)->with('agua12', $agua12)->with('particulado12', $particulado12)->with('viscosidade12', $viscosidade12)
       ->with('demulsibilidade12', $demulsibilidade12)->with('desgaste12', $desgaste12);
     }

   public function UraPerfil() {


    $title = 'Perfil URA';
    $atualInicial = Carbon::today();
    $atual = Carbon::now();
    $dataAnterior = $atual->subMonths(1);

    $ura_manutencao = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',11)
                           ->where('preditiva_analises.status_id','=',1)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $ura_standBy = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',11)
                           ->where('preditiva_analises.status_id','=',2)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $ura_normal = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',11)
                           ->where('preditiva_analises.status_id','=',3)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $ura_alarme = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',11)
                           ->where('preditiva_analises.status_id','=',4)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $ura_critico = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',11)
                           ->where('preditiva_analises.status_id','=',5)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');
     return view('csn.relatorioGerencial.includes.indexRelGerLB_ura_perfil')
     ->with('title', $title)->with('manutencao', $ura_manutencao)->with('standBy', $ura_standBy)
     ->with('normal', $ura_normal)->with('alarme', $ura_alarme)->with('critico', $ura_critico);
   }

   public function UraAnormalidades() {

     $title = 'Anormalidades URA';
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();
     $normal1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();
     $normal2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $critico2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();
     $normal3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $critico3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();
     $normal4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $critico4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();
     $normal5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $critico5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();
     $normal6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $critico6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();
     $normal7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $critico7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();
     $normal8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $critico8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();
     $normal9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $critico9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();
     $normal10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $critico10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();
     $normal11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $critico11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();
     $normal12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $critico12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     return view('csn.relatorioGerencial.includes.relatoriosOleo.ura-anormalidades')
       ->with('title', $title)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);
   }

   public function UraStatusPontos() {

     $title = 'URA';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $normal001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $n1 = ($normal001+$alarme001+$critico001);
     $a1 = ($normal001+$alarme001+$critico001);
     $c1 = ($normal001+$alarme001+$critico001);

     if ($n1 > 0) {
       $normal1 = number_format((($normal001/$n1)*100),0,",",".");
     } else {
      $normal1 = 0;
    }
     if ($a1 > 0) {
       $alarme1 = number_format((($alarme001/$a1)*100),0,",",".");
     } else {
      $alarme1 = 0;
    }
     if ($c1 > 0) {
       $critico1 = number_format((($critico001/$c1)*100),0,",",".");
     } else {
      $critico1 = 0;
    }


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $normal002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $critico002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $n2 = ($normal002+$alarme002+$critico002);
     $a2 = ($normal002+$alarme002+$critico002);
     $c2 = ($normal002+$alarme002+$critico002);

     if ($n2 > 0) {
       $normal2 = number_format((($normal002/$n2)*100),0,",",".");
     } else {
      $normal2 = 0;
    }
     if ($a2 > 0) {
       $alarme2 = number_format((($alarme002/$a2)*100),0,",",".");
     } else {
      $alarme2 = 0;
    }
     if ($c2 > 0) {
       $critico2 = number_format((($critico002/$c2)*100),0,",",".");
     } else {
      $critico2 = 0;
    }



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $normal003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $critico003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $n3 = ($normal003+$alarme003+$critico003);
     $a3 = ($normal003+$alarme003+$critico003);
     $c3 = ($normal003+$alarme003+$critico003);

     if ($n3 > 0) {
       $normal3 = number_format((($normal003/$n3)*100),0,",",".");
     } else {
      $normal3 = 0;
    }
     if ($a3 > 0) {
       $alarme3 = number_format((($alarme003/$a3)*100),0,",",".");
     } else {
      $alarme3 = 0;
    }
     if ($c3 > 0) {
       $critico3 = number_format((($critico003/$c3)*100),0,",",".");
     } else {
      $critico3 = 0;
    }


     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $normal004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $critico004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $n4 = ($normal004+$alarme004+$critico004);
     $a4 = ($normal004+$alarme004+$critico004);
     $c4 = ($normal004+$alarme004+$critico004);

     if ($n4 > 0) {
       $normal4 = number_format((($normal004/$n4)*100),0,",",".");
     } else {
      $normal4 = 0;
    }
     if ($a4 > 0) {
       $alarme4 = number_format((($alarme004/$a4)*100),0,",",".");
     } else {
      $alarme4 = 0;
    }
     if ($c4 > 0) {
       $critico4 = number_format((($critico004/$c4)*100),0,",",".");
     } else {
      $critico4 = 0;
    }


     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();

     $normal005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $critico005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $n5 = ($normal005+$alarme005+$critico005);
     $a5 = ($normal005+$alarme005+$critico005);
     $c5 = ($normal005+$alarme005+$critico005);

     if ($n5 > 0) {
       $normal5 = number_format((($normal005/$n5)*100),0,",",".");
     } else {
      $normal5 = 0;
    }
     if ($a5 > 0)
     {
       $alarme5 = number_format((($alarme005/$a5)*100),0,",",".");
     }
     else
     {
        $alarme5 = 0;
     }
     if ($c5 > 0) {
       $critico5 = number_format((($critico005/$c5)*100),0,",",".");
     } else {
      $critico5 = 0;
    }


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();

     $normal006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $critico006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $n6 = ($normal006+$alarme006+$critico006);
     $a6 = ($normal006+$alarme006+$critico006);
     $c6 = ($normal006+$alarme006+$critico006);

     if ($n6 > 0) {
       $normal6 = number_format((($normal006/$n6)*100),0,",",".");
     } else {
      $normal6 = 0;
    }
     if ($a6 > 0) {
       $alarme6 = number_format((($alarme006/$a6)*100),0,",",".");
     } else {
      $alarme6 = 0;
    }
     if ($c6 > 0) {
       $critico6 = number_format((($critico006/$c6)*100),0,",",".");
     } else {
      $critico6 = 0;
    }


     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();

     $normal007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $critico007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $n7 = ($normal007+$alarme007+$critico007);
     $a7 = ($normal007+$alarme007+$critico007);
     $c7 = ($normal007+$alarme007+$critico007);

     if ($n7 > 0) {
       $normal7 = number_format((($normal007/$n7)*100),0,",",".");
     } else {
      $normal7 = 0;
    }
     if ($a7 > 0) {
       $alarme7 = number_format((($alarme007/$a7)*100),0,",",".");
     } else {
      $alarme7 = 0;
    }
     if ($c7 > 0) {
       $critico7 = number_format((($critico007/$c7)*100),0,",",".");
     } else {
      $critico7 = 0;
    }


     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $normal008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $critico008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $n8 = ($normal008+$alarme008+$critico008);
     $a8 = ($normal008+$alarme008+$critico008);
     $c8 = ($normal008+$alarme008+$critico008);

     if ($n8 > 0) {
       $normal8 = number_format((($normal008/$n8)*100),0,",",".");
     } else {
      $normal8 = 0;
    }
     if ($a8 > 0) {
       $alarme8 = number_format((($alarme008/$a8)*100),0,",",".");
     } else {
      $alarme8 = 0;
    }
     if ($c8 > 0) {
       $critico8 = number_format((($critico008/$c8)*100),0,",",".");
     } else {
      $critico8 = 0;
    }


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $normal009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $critico009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $n9 = ($normal009+$alarme009+$critico009);
     $a9 = ($normal009+$alarme009+$critico009);
     $c9 = ($normal009+$alarme009+$critico009);

     if ($n9 > 0) {
       $normal9 = number_format((($normal009/$n9)*100),0,",",".");
     } else {
      $normal9 = 0;
    }
     if ($a9 > 0) {
       $alarme9 = number_format((($alarme009/$a9)*100),0,",",".");
     } else {
      $alarme9 = 0;
    }
     if ($c9 > 0) {
       $critico9 = number_format((($critico009/$c9)*100),0,",",".");
     } else {
      $critico9 = 0;
    }


     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

     $normal010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $critico010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $n10 = ($normal010+$alarme010+$critico010);
     $a10 = ($normal010+$alarme010+$critico010);
     $c10 = ($normal010+$alarme010+$critico010);

     if ($n10 > 0) {
       $normal10 = number_format((($normal010/$n10)*100),0,",",".");
     } else {
      $normal10 = 0;
    }
     if ($a10 > 0) {
       $alarme10 = number_format((($alarme010/$a10)*100),0,",",".");
     } else {
      $alarme10 = 0;
    }
     if ($c10 > 0) {
       $critico10 = number_format((($critico010/$c10)*100),0,",",".");
     } else {
      $critico10 = 0;
    }


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

     $normal011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $critico011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $n11 = ($normal011+$alarme011+$critico011);
     $a11 = ($normal011+$alarme011+$critico011);
     $c11 = ($normal011+$alarme011+$critico011);

     if ($n11 > 0) {
       $normal11 = number_format((($normal011/$n11)*100),0,",",".");
     } else {
      $normal11 = 0;
    }
     if ($a11 > 0) {
       $alarme11 = number_format((($alarme011/$a11)*100),0,",",".");
     } else {
      $alarme11 = 0;
    }
     if ($c11 > 0) {
       $critico11 = number_format((($critico011/$c11)*100),0,",",".");
     } else {
      $critico11 = 0;
    }


     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

     $normal012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $critico012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $n12 = ($normal012+$alarme012+$critico012);
     $a12 = ($normal012+$alarme012+$critico012);
     $c12 = ($normal012+$alarme012+$critico012);

     if ($n12 > 0) {
       $normal12 = number_format((($normal012/$n12)*100),0,",",".");
     } else {
      $normal12 = 0;
    }
     if ($a12 > 0) {
       $alarme12 = number_format((($alarme012/$a12)*100),0,",",".");
     } else {
      $alarme12 = 0;
    }
     if ($c12 > 0) {
       $critico12 = number_format((($critico012/$c12)*100),0,",",".");
     } else {
      $critico12 = 0;
    }
     return view('csn.relatorioGerencial.includes.relatoriosOleo.ura-statusPontos')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);

   }

   public function UraProblemasEncontrados()
   {

     $title = 'URA';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $agua1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $agua2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $agua3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $agua4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();


      $agua5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();


     $agua6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();


      $agua7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');



     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $agua8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $agua9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');



     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

      $agua10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

      $agua11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');



     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

      $agua12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',11)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');




     return view('csn.relatorioGerencial.includes.relatoriosOleo.ura-problemasEncontrados')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('agua1', $agua1)->with('particulado1', $particulado1)->with('viscosidade1', $viscosidade1)->with('demulsibilidade1', $demulsibilidade1)->with('desgaste1', $desgaste1)
       ->with('dataFAnt2', $dataFAnt2)->with('agua2', $agua2)->with('particulado2', $particulado2)->with('viscosidade2', $viscosidade2)->with('demulsibilidade2', $demulsibilidade2)->with('desgaste2', $desgaste2)
       ->with('dataFAnt3', $dataFAnt3)->with('agua3', $agua3)->with('particulado3', $particulado3)->with('viscosidade3', $viscosidade3)->with('demulsibilidade3', $demulsibilidade3)->with('desgaste3', $desgaste3)
       ->with('dataFAnt4', $dataFAnt4)->with('agua4', $agua4)->with('particulado4', $particulado4)->with('viscosidade4', $viscosidade4)->with('demulsibilidade4', $demulsibilidade4)->with('desgaste4', $desgaste4)
       ->with('dataFAnt5', $dataFAnt5)->with('agua5', $agua5)->with('particulado5', $particulado5)->with('viscosidade5', $viscosidade5)->with('demulsibilidade5', $demulsibilidade5)->with('desgaste5', $desgaste5)
       ->with('dataFAnt6', $dataFAnt6)->with('agua6', $agua6)->with('particulado6', $particulado6)->with('viscosidade6', $viscosidade6)->with('demulsibilidade6', $demulsibilidade6)->with('desgaste6', $desgaste6)
       ->with('dataFAnt7', $dataFAnt7)->with('agua7', $agua7)->with('particulado7', $particulado7)->with('viscosidade7', $viscosidade7)->with('demulsibilidade7', $demulsibilidade7)->with('desgaste7', $desgaste7)
       ->with('dataFAnt8', $dataFAnt8)->with('agua8', $agua8)->with('particulado8', $particulado8)->with('viscosidade8', $viscosidade8)->with('demulsibilidade8', $demulsibilidade8)->with('desgaste8', $desgaste8)
       ->with('dataFAnt9', $dataFAnt9)->with('agua9', $agua9)->with('particulado9', $particulado9)->with('viscosidade9', $viscosidade9)->with('demulsibilidade9', $demulsibilidade9)->with('desgaste9', $desgaste9)
       ->with('dataFAnt10', $dataFAnt10)->with('agua10', $agua10)->with('particulado10', $particulado10)->with('viscosidade10', $viscosidade10)->with('demulsibilidade10', $demulsibilidade10)->with('desgaste10', $desgaste10)
       ->with('dataFAnt11', $dataFAnt11)->with('agua11', $agua11)->with('particulado11', $particulado11)->with('viscosidade11', $viscosidade11)->with('demulsibilidade11', $demulsibilidade11)->with('desgaste11', $desgaste11)
       ->with('dataFAnt12', $dataFAnt12)->with('agua12', $agua12)->with('particulado12', $particulado12)->with('viscosidade12', $viscosidade12)->with('demulsibilidade12', $demulsibilidade12)->with('desgaste12', $desgaste12);






   }

   public function LdsPerfil() {

    $title = 'LDS';
    $tecnica = DB::table('tecnicas')->where('id', '<', 6)->pluck("name_tecnica","id");
    //data do sistema
    $atualInicial = Carbon::today();
    $atual = Carbon::now();
    $dataAnterior = $atual->subMonths(1);

     $lds_manutencao = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',10)
                           ->where('preditiva_analises.status_id','=',1)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lds_standBy = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',10)
                           ->where('preditiva_analises.status_id','=',2)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lds_normal = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',10)
                           ->where('preditiva_analises.status_id','=',3)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lds_alarme = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',10)
                           ->where('preditiva_analises.status_id','=',4)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lds_critico = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',10)
                           ->where('preditiva_analises.status_id','=',5)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

      return view('csn.relatorioGerencial.includes.indexRelGerLB_lds_perfil')
     ->with('title', $title)->with('tecnica', $tecnica)->with('manutencao', $lds_manutencao)->with('standBy', $lds_standBy)
     ->with('normal', $lds_normal)->with('alarme', $lds_alarme)->with('critico', $lds_critico);
   }

   public function LdsAnormalidades() {
     $title = 'Anormalidades URA';
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();
     $normal1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();
     $normal2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $critico2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();
     $normal3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $critico3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();
     $normal4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $critico4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();
     $normal5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $critico5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();
     $normal6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $critico6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();
     $normal7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $critico7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();
     $normal8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $critico8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();
     $normal9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $critico9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();
     $normal10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $critico10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();
     $normal11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $critico11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();
     $normal12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $critico12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     return view('csn.relatorioGerencial.includes.relatoriosOleo.lds-anormalidades')
       ->with('title', $title)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);
   }

   public function LdsStatusPontos() {

     $title = 'LDS';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $normal001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $n1 = ($normal001+$alarme001+$critico001);
     $a1 = ($normal001+$alarme001+$critico001);
     $c1 = ($normal001+$alarme001+$critico001);

     if ($n1 > 0) {
       $normal1 = number_format((($normal001/$n1)*100),0,",",".");
     } else {
      $normal1 = 0;
    }
     if ($a1 > 0) {
       $alarme1 = number_format((($alarme001/$a1)*100),0,",",".");
     } else {
      $alarme1 = 0;
    }
     if ($c1 > 0) {
       $critico1 = number_format((($critico001/$c1)*100),0,",",".");
     } else {
      $critico1 = 0;
    }


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $normal002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $critico002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $n2 = ($normal002+$alarme002+$critico002);
     $a2 = ($normal002+$alarme002+$critico002);
     $c2 = ($normal002+$alarme002+$critico002);

     if ($n2 > 0) {
       $normal2 = number_format((($normal002/$n2)*100),0,",",".");
     } else {
      $normal2 = 0;
    }
     if ($a2 > 0) {
       $alarme2 = number_format((($alarme002/$a2)*100),0,",",".");
     } else {
      $alarme2 = 0;
    }
     if ($c2 > 0) {
       $critico2 = number_format((($critico002/$c2)*100),0,",",".");
     } else {
      $critico2 = 0;
    }



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $normal003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $critico003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $n3 = ($normal003+$alarme003+$critico003);
     $a3 = ($normal003+$alarme003+$critico003);
     $c3 = ($normal003+$alarme003+$critico003);

     if ($n3 > 0) {
       $normal3 = number_format((($normal003/$n3)*100),0,",",".");
     } else {
      $normal3 = 0;
    }
     if ($a3 > 0) {
       $alarme3 = number_format((($alarme003/$a3)*100),0,",",".");
     } else {
      $alarme3 = 0;
    }
     if ($c3 > 0) {
       $critico3 = number_format((($critico003/$c3)*100),0,",",".");
     } else {
      $critico3 = 0;
    }


     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $normal004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $critico004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $n4 = ($normal004+$alarme004+$critico004);
     $a4 = ($normal004+$alarme004+$critico004);
     $c4 = ($normal004+$alarme004+$critico004);

     if ($n4 > 0) {
       $normal4 = number_format((($normal004/$n4)*100),0,",",".");
     } else {
      $normal4 = 0;
    }
     if ($a4 > 0) {
       $alarme4 = number_format((($alarme004/$a4)*100),0,",",".");
     } else {
      $alarme4 = 0;
    }
     if ($c4 > 0) {
       $critico4 = number_format((($critico004/$c4)*100),0,",",".");
     } else {
      $critico4 = 0;
    }


     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();

     $normal005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $critico005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $n5 = ($normal005+$alarme005+$critico005);
     $a5 = ($normal005+$alarme005+$critico005);
     $c5 = ($normal005+$alarme005+$critico005);

     if ($n5 > 0) {
       $normal5 = number_format((($normal005/$n5)*100),0,",",".");
     } else {
      $normal5 = 0;
    }
     if ($a5 > 0)
     {
       $alarme5 = number_format((($alarme005/$a5)*100),0,",",".");
     }
     else
     {
        $alarme5 = 0;
     }
     if ($c5 > 0) {
       $critico5 = number_format((($critico005/$c5)*100),0,",",".");
     } else {
      $critico5 = 0;
    }


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();

     $normal006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $critico006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $n6 = ($normal006+$alarme006+$critico006);
     $a6 = ($normal006+$alarme006+$critico006);
     $c6 = ($normal006+$alarme006+$critico006);

     if ($n6 > 0) {
       $normal6 = number_format((($normal006/$n6)*100),0,",",".");
     } else {
      $normal6 = 0;
    }
     if ($a6 > 0) {
       $alarme6 = number_format((($alarme006/$a6)*100),0,",",".");
     } else {
      $alarme6 = 0;
    }
     if ($c6 > 0) {
       $critico6 = number_format((($critico006/$c6)*100),0,",",".");
     } else {
      $critico6 = 0;
    }


     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();

     $normal007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $critico007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $n7 = ($normal007+$alarme007+$critico007);
     $a7 = ($normal007+$alarme007+$critico007);
     $c7 = ($normal007+$alarme007+$critico007);

     if ($n7 > 0) {
       $normal7 = number_format((($normal007/$n7)*100),0,",",".");
     } else {
      $normal7 = 0;
    }
     if ($a7 > 0) {
       $alarme7 = number_format((($alarme007/$a7)*100),0,",",".");
     } else {
      $alarme7 = 0;
    }
     if ($c7 > 0) {
       $critico7 = number_format((($critico007/$c7)*100),0,",",".");
     } else {
      $critico7 = 0;
    }


     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $normal008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $critico008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $n8 = ($normal008+$alarme008+$critico008);
     $a8 = ($normal008+$alarme008+$critico008);
     $c8 = ($normal008+$alarme008+$critico008);

     if ($n8 > 0) {
       $normal8 = number_format((($normal008/$n8)*100),0,",",".");
     } else {
      $normal8 = 0;
    }
     if ($a8 > 0) {
       $alarme8 = number_format((($alarme008/$a8)*100),0,",",".");
     } else {
      $alarme8 = 0;
    }
     if ($c8 > 0) {
       $critico8 = number_format((($critico008/$c8)*100),0,",",".");
     } else {
      $critico8 = 0;
    }


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $normal009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $critico009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $n9 = ($normal009+$alarme009+$critico009);
     $a9 = ($normal009+$alarme009+$critico009);
     $c9 = ($normal009+$alarme009+$critico009);

     if ($n9 > 0) {
       $normal9 = number_format((($normal009/$n9)*100),0,",",".");
     } else {
      $normal9 = 0;
    }
     if ($a9 > 0) {
       $alarme9 = number_format((($alarme009/$a9)*100),0,",",".");
     } else {
      $alarme9 = 0;
    }
     if ($c9 > 0) {
       $critico9 = number_format((($critico009/$c9)*100),0,",",".");
     } else {
      $critico9 = 0;
    }


     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

     $normal010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $critico010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $n10 = ($normal010+$alarme010+$critico010);
     $a10 = ($normal010+$alarme010+$critico010);
     $c10 = ($normal010+$alarme010+$critico010);

     if ($n10 > 0) {
       $normal10 = number_format((($normal010/$n10)*100),0,",",".");
     } else {
      $normal10 = 0;
    }
     if ($a10 > 0) {
       $alarme10 = number_format((($alarme010/$a10)*100),0,",",".");
     } else {
      $alarme10 = 0;
    }
     if ($c10 > 0) {
       $critico10 = number_format((($critico010/$c10)*100),0,",",".");
     } else {
      $critico10 = 0;
    }


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

     $normal011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $critico011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $n11 = ($normal011+$alarme011+$critico011);
     $a11 = ($normal011+$alarme011+$critico011);
     $c11 = ($normal011+$alarme011+$critico011);

     if ($n11 > 0) {
       $normal11 = number_format((($normal011/$n11)*100),0,",",".");
     } else {
      $normal11 = 0;
    }
     if ($a11 > 0) {
       $alarme11 = number_format((($alarme011/$a11)*100),0,",",".");
     } else {
      $alarme11 = 0;
    }
     if ($c11 > 0) {
       $critico11 = number_format((($critico011/$c11)*100),0,",",".");
     } else {
      $critico11 = 0;
    }


     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

     $normal012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $critico012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $n12 = ($normal012+$alarme012+$critico012);
     $a12 = ($normal012+$alarme012+$critico012);
     $c12 = ($normal012+$alarme012+$critico012);

     if ($n12 > 0) {
       $normal12 = number_format((($normal012/$n12)*100),0,",",".");
     } else {
      $normal12 = 0;
    }
     if ($a12 > 0) {
       $alarme12 = number_format((($alarme012/$a12)*100),0,",",".");
     } else {
      $alarme12 = 0;
    }
     if ($c12 > 0) {
       $critico12 = number_format((($critico012/$c12)*100),0,",",".");
     } else {
      $critico12 = 0;
    }
     return view('csn.relatorioGerencial.includes.relatoriosOleo.lds-statusPontos')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);



   }

   public function LdsProblemasEncontrados()
   {

     $title = 'LDS';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $agua1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $agua2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $agua3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $agua4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();


      $agua5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();


     $agua6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();


      $agua7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');



     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $agua8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $agua9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');



     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

      $agua10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

      $agua11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');



     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

      $agua12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',10)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');




     return view('csn.relatorioGerencial.includes.relatoriosOleo.lds-problemasEncontrados')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('agua1', $agua1)->with('particulado1', $particulado1)->with('viscosidade1', $viscosidade1)->with('demulsibilidade1', $demulsibilidade1)->with('desgaste1', $desgaste1)
       ->with('dataFAnt2', $dataFAnt2)->with('agua2', $agua2)->with('particulado2', $particulado2)->with('viscosidade2', $viscosidade2)->with('demulsibilidade2', $demulsibilidade2)->with('desgaste2', $desgaste2)
       ->with('dataFAnt3', $dataFAnt3)->with('agua3', $agua3)->with('particulado3', $particulado3)->with('viscosidade3', $viscosidade3)->with('demulsibilidade3', $demulsibilidade3)->with('desgaste3', $desgaste3)
       ->with('dataFAnt4', $dataFAnt4)->with('agua4', $agua4)->with('particulado4', $particulado4)->with('viscosidade4', $viscosidade4)->with('demulsibilidade4', $demulsibilidade4)->with('desgaste4', $desgaste4)
       ->with('dataFAnt5', $dataFAnt5)->with('agua5', $agua5)->with('particulado5', $particulado5)->with('viscosidade5', $viscosidade5)->with('demulsibilidade5', $demulsibilidade5)->with('desgaste5', $desgaste5)
       ->with('dataFAnt6', $dataFAnt6)->with('agua6', $agua6)->with('particulado6', $particulado6)->with('viscosidade6', $viscosidade6)->with('demulsibilidade6', $demulsibilidade6)->with('desgaste6', $desgaste6)
       ->with('dataFAnt7', $dataFAnt7)->with('agua7', $agua7)->with('particulado7', $particulado7)->with('viscosidade7', $viscosidade7)->with('demulsibilidade7', $demulsibilidade7)->with('desgaste7', $desgaste7)
       ->with('dataFAnt8', $dataFAnt8)->with('agua8', $agua8)->with('particulado8', $particulado8)->with('viscosidade8', $viscosidade8)->with('demulsibilidade8', $demulsibilidade8)->with('desgaste8', $desgaste8)
       ->with('dataFAnt9', $dataFAnt9)->with('agua9', $agua9)->with('particulado9', $particulado9)->with('viscosidade9', $viscosidade9)->with('demulsibilidade9', $demulsibilidade9)->with('desgaste9', $desgaste9)
       ->with('dataFAnt10', $dataFAnt10)->with('agua10', $agua10)->with('particulado10', $particulado10)->with('viscosidade10', $viscosidade10)->with('demulsibilidade10', $demulsibilidade10)->with('desgaste10', $desgaste10)
       ->with('dataFAnt11', $dataFAnt11)->with('agua11', $agua11)->with('particulado11', $particulado11)->with('viscosidade11', $viscosidade11)->with('demulsibilidade11', $demulsibilidade11)->with('desgaste11', $desgaste11)
       ->with('dataFAnt12', $dataFAnt12)->with('agua12', $agua12)->with('particulado12', $particulado12)->with('viscosidade12', $viscosidade12)->with('demulsibilidade12', $demulsibilidade12)->with('desgaste12', $desgaste12);
   }


   public function LrfPerfil()
   {

     $title = 'LRF';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->pluck("name_tecnica","id");
     //data do sistema
     $atualInicial = Carbon::today();
     $atual = Carbon::now();
     $dataAnterior = $atual->subMonths(1);

      $lrf_manutencao = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',1)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $lrf_standBy = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',2)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $lrf_normal = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $lrf_alarme = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $lrf_critico = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                            ->count('preditiva_analises.status_id');

       return view('csn.relatorioGerencial.includes.indexRelGerLB_lrf_perfil')
      ->with('title', $title)->with('tecnica', $tecnica)->with('manutencao', $lrf_manutencao)->with('standBy', $lrf_standBy)
      ->with('normal', $lrf_normal)->with('alarme', $lrf_alarme)->with('critico', $lrf_critico);
   }

   public function LrfAnormalidades() {
     $title = 'Anormalidades LRF';
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();
     $normal1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();
     $normal2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $critico2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();
     $normal3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $critico3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();
     $normal4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $critico4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();
     $normal5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $critico5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();
     $normal6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $critico6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();
     $normal7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $critico7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();
     $normal8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $critico8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();
     $normal9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $critico9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();
     $normal10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $critico10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();
     $normal11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $critico11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();
     $normal12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $critico12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     return view('csn.relatorioGerencial.includes.relatoriosOleo.lrf-anormalidades')
       ->with('title', $title)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);


   }


   public function LrfStatusPontos()
   {

     $title = 'LRF';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $normal001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $n1 = ($normal001+$alarme001+$critico001);
     $a1 = ($normal001+$alarme001+$critico001);
     $c1 = ($normal001+$alarme001+$critico001);

     if ($n1 > 0) {
       $normal1 = number_format((($normal001/$n1)*100),0,",",".");
     } else {
      $normal1 = 0;
    }
     if ($a1 > 0) {
       $alarme1 = number_format((($alarme001/$a1)*100),0,",",".");
     } else {
      $alarme1 = 0;
    }
     if ($c1 > 0) {
       $critico1 = number_format((($critico001/$c1)*100),0,",",".");
     } else {
      $critico1 = 0;
    }


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $normal002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $critico002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $n2 = ($normal002+$alarme002+$critico002);
     $a2 = ($normal002+$alarme002+$critico002);
     $c2 = ($normal002+$alarme002+$critico002);

     if ($n2 > 0) {
       $normal2 = number_format((($normal002/$n2)*100),0,",",".");
     } else {
      $normal2 = 0;
    }
     if ($a2 > 0) {
       $alarme2 = number_format((($alarme002/$a2)*100),0,",",".");
     } else {
      $alarme2 = 0;
    }
     if ($c2 > 0) {
       $critico2 = number_format((($critico002/$c2)*100),0,",",".");
     } else {
      $critico2 = 0;
    }



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $normal003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $critico003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $n3 = ($normal003+$alarme003+$critico003);
     $a3 = ($normal003+$alarme003+$critico003);
     $c3 = ($normal003+$alarme003+$critico003);

     if ($n3 > 0) {
       $normal3 = number_format((($normal003/$n3)*100),0,",",".");
     } else {
      $normal3 = 0;
    }
     if ($a3 > 0) {
       $alarme3 = number_format((($alarme003/$a3)*100),0,",",".");
     } else {
      $alarme3 = 0;
    }
     if ($c3 > 0) {
       $critico3 = number_format((($critico003/$c3)*100),0,",",".");
     } else {
      $critico3 = 0;
    }


     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $normal004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $critico004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $n4 = ($normal004+$alarme004+$critico004);
     $a4 = ($normal004+$alarme004+$critico004);
     $c4 = ($normal004+$alarme004+$critico004);

     if ($n4 > 0) {
       $normal4 = number_format((($normal004/$n4)*100),0,",",".");
     } else {
      $normal4 = 0;
    }
     if ($a4 > 0) {
       $alarme4 = number_format((($alarme004/$a4)*100),0,",",".");
     } else {
      $alarme4 = 0;
    }
     if ($c4 > 0) {
       $critico4 = number_format((($critico004/$c4)*100),0,",",".");
     } else {
      $critico4 = 0;
    }


     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();

     $normal005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $critico005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $n5 = ($normal005+$alarme005+$critico005);
     $a5 = ($normal005+$alarme005+$critico005);
     $c5 = ($normal005+$alarme005+$critico005);

     if ($n5 > 0) {
       $normal5 = number_format((($normal005/$n5)*100),0,",",".");
     } else {
      $normal5 = 0;
    }
     if ($a5 > 0)
     {
       $alarme5 = number_format((($alarme005/$a5)*100),0,",",".");
     }
     else
     {
        $alarme5 = 0;
     }
     if ($c5 > 0) {
       $critico5 = number_format((($critico005/$c5)*100),0,",",".");
     } else {
      $critico5 = 0;
    }


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();

     $normal006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $critico006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $n6 = ($normal006+$alarme006+$critico006);
     $a6 = ($normal006+$alarme006+$critico006);
     $c6 = ($normal006+$alarme006+$critico006);

     if ($n6 > 0) {
       $normal6 = number_format((($normal006/$n6)*100),0,",",".");
     } else {
      $normal6 = 0;
    }
     if ($a6 > 0) {
       $alarme6 = number_format((($alarme006/$a6)*100),0,",",".");
     } else {
      $alarme6 = 0;
    }
     if ($c6 > 0) {
       $critico6 = number_format((($critico006/$c6)*100),0,",",".");
     } else {
      $critico6 = 0;
    }


     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();

     $normal007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $critico007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $n7 = ($normal007+$alarme007+$critico007);
     $a7 = ($normal007+$alarme007+$critico007);
     $c7 = ($normal007+$alarme007+$critico007);

     if ($n7 > 0) {
       $normal7 = number_format((($normal007/$n7)*100),0,",",".");
     } else {
      $normal7 = 0;
    }
     if ($a7 > 0) {
       $alarme7 = number_format((($alarme007/$a7)*100),0,",",".");
     } else {
      $alarme7 = 0;
    }
     if ($c7 > 0) {
       $critico7 = number_format((($critico007/$c7)*100),0,",",".");
     } else {
      $critico7 = 0;
    }


     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $normal008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $critico008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $n8 = ($normal008+$alarme008+$critico008);
     $a8 = ($normal008+$alarme008+$critico008);
     $c8 = ($normal008+$alarme008+$critico008);

     if ($n8 > 0) {
       $normal8 = number_format((($normal008/$n8)*100),0,",",".");
     } else {
      $normal8 = 0;
    }
     if ($a8 > 0) {
       $alarme8 = number_format((($alarme008/$a8)*100),0,",",".");
     } else {
      $alarme8 = 0;
    }
     if ($c8 > 0) {
       $critico8 = number_format((($critico008/$c8)*100),0,",",".");
     } else {
      $critico8 = 0;
    }


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $normal009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $critico009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $n9 = ($normal009+$alarme009+$critico009);
     $a9 = ($normal009+$alarme009+$critico009);
     $c9 = ($normal009+$alarme009+$critico009);

     if ($n9 > 0) {
       $normal9 = number_format((($normal009/$n9)*100),0,",",".");
     } else {
      $normal9 = 0;
    }
     if ($a9 > 0) {
       $alarme9 = number_format((($alarme009/$a9)*100),0,",",".");
     } else {
      $alarme9 = 0;
    }
     if ($c9 > 0) {
       $critico9 = number_format((($critico009/$c9)*100),0,",",".");
     } else {
      $critico9 = 0;
    }


     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

     $normal010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $critico010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $n10 = ($normal010+$alarme010+$critico010);
     $a10 = ($normal010+$alarme010+$critico010);
     $c10 = ($normal010+$alarme010+$critico010);

     if ($n10 > 0) {
       $normal10 = number_format((($normal010/$n10)*100),0,",",".");
     } else {
      $normal10 = 0;
    }
     if ($a10 > 0) {
       $alarme10 = number_format((($alarme010/$a10)*100),0,",",".");
     } else {
      $alarme10 = 0;
    }
     if ($c10 > 0) {
       $critico10 = number_format((($critico010/$c10)*100),0,",",".");
     } else {
      $critico10 = 0;
    }


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

     $normal011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $critico011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $n11 = ($normal011+$alarme011+$critico011);
     $a11 = ($normal011+$alarme011+$critico011);
     $c11 = ($normal011+$alarme011+$critico011);

     if ($n11 > 0) {
       $normal11 = number_format((($normal011/$n11)*100),0,",",".");
     } else {
      $normal11 = 0;
    }
     if ($a11 > 0) {
       $alarme11 = number_format((($alarme011/$a11)*100),0,",",".");
     } else {
      $alarme11 = 0;
    }
     if ($c11 > 0) {
       $critico11 = number_format((($critico011/$c11)*100),0,",",".");
     } else {
      $critico11 = 0;
    }


     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

     $normal012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $critico012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $n12 = ($normal012+$alarme012+$critico012);
     $a12 = ($normal012+$alarme012+$critico012);
     $c12 = ($normal012+$alarme012+$critico012);

     if ($n12 > 0) {
       $normal12 = number_format((($normal012/$n12)*100),0,",",".");
     } else {
      $normal12 = 0;
    }
     if ($a12 > 0) {
       $alarme12 = number_format((($alarme012/$a12)*100),0,",",".");
     } else {
      $alarme12 = 0;
    }
     if ($c12 > 0) {
       $critico12 = number_format((($critico012/$c12)*100),0,",",".");
     } else {
      $critico12 = 0;
    }
     return view('csn.relatorioGerencial.includes.relatoriosOleo.lrf-statusPontos')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);



   }
   public function LrfProblemasEncontrados()
   {

     $title = 'LRF';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $agua1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $agua2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $agua3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $agua4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();


      $agua5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();


     $agua6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();


      $agua7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');



     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $agua8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $agua9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');



     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

      $agua10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

      $agua11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');



     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

      $agua12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',12)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');




     return view('csn.relatorioGerencial.includes.relatoriosOleo.lrf-problemasEncontrados')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('agua1', $agua1)->with('particulado1', $particulado1)->with('viscosidade1', $viscosidade1)->with('demulsibilidade1', $demulsibilidade1)->with('desgaste1', $desgaste1)
       ->with('dataFAnt2', $dataFAnt2)->with('agua2', $agua2)->with('particulado2', $particulado2)->with('viscosidade2', $viscosidade2)->with('demulsibilidade2', $demulsibilidade2)->with('desgaste2', $desgaste2)
       ->with('dataFAnt3', $dataFAnt3)->with('agua3', $agua3)->with('particulado3', $particulado3)->with('viscosidade3', $viscosidade3)->with('demulsibilidade3', $demulsibilidade3)->with('desgaste3', $desgaste3)
       ->with('dataFAnt4', $dataFAnt4)->with('agua4', $agua4)->with('particulado4', $particulado4)->with('viscosidade4', $viscosidade4)->with('demulsibilidade4', $demulsibilidade4)->with('desgaste4', $desgaste4)
       ->with('dataFAnt5', $dataFAnt5)->with('agua5', $agua5)->with('particulado5', $particulado5)->with('viscosidade5', $viscosidade5)->with('demulsibilidade5', $demulsibilidade5)->with('desgaste5', $desgaste5)
       ->with('dataFAnt6', $dataFAnt6)->with('agua6', $agua6)->with('particulado6', $particulado6)->with('viscosidade6', $viscosidade6)->with('demulsibilidade6', $demulsibilidade6)->with('desgaste6', $desgaste6)
       ->with('dataFAnt7', $dataFAnt7)->with('agua7', $agua7)->with('particulado7', $particulado7)->with('viscosidade7', $viscosidade7)->with('demulsibilidade7', $demulsibilidade7)->with('desgaste7', $desgaste7)
       ->with('dataFAnt8', $dataFAnt8)->with('agua8', $agua8)->with('particulado8', $particulado8)->with('viscosidade8', $viscosidade8)->with('demulsibilidade8', $demulsibilidade8)->with('desgaste8', $desgaste8)
       ->with('dataFAnt9', $dataFAnt9)->with('agua9', $agua9)->with('particulado9', $particulado9)->with('viscosidade9', $viscosidade9)->with('demulsibilidade9', $demulsibilidade9)->with('desgaste9', $desgaste9)
       ->with('dataFAnt10', $dataFAnt10)->with('agua10', $agua10)->with('particulado10', $particulado10)->with('viscosidade10', $viscosidade10)->with('demulsibilidade10', $demulsibilidade10)->with('desgaste10', $desgaste10)
       ->with('dataFAnt11', $dataFAnt11)->with('agua11', $agua11)->with('particulado11', $particulado11)->with('viscosidade11', $viscosidade11)->with('demulsibilidade11', $demulsibilidade11)->with('desgaste11', $desgaste11)
       ->with('dataFAnt12', $dataFAnt12)->with('agua12', $agua12)->with('particulado12', $particulado12)->with('viscosidade12', $viscosidade12)->with('demulsibilidade12', $demulsibilidade12)->with('desgaste12', $desgaste12);





   }



   public function UtiPerfil()
   {

    $title = 'Perfil UTI';
    $tecnica = DB::table('tecnicas')->where('id', '<', 6)->pluck("name_tecnica","id");
    //data do sistema
    $atualInicial = Carbon::today();
    $atual = Carbon::now();
    $dataAnterior = $atual->subMonths(1);

     $lgc_manutencao = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->whereBetween('negocios.id', [21, 27])
                           ->where('preditiva_analises.status_id','=',1)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lgc_standBy = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->whereBetween('negocios.id', [21, 27])
                           ->where('preditiva_analises.status_id','=',2)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lgc_normal = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->whereBetween('negocios.id', [21, 27])
                           ->where('preditiva_analises.status_id','=',3)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lgc_alarme = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->whereBetween('negocios.id', [21, 27])
                           ->where('preditiva_analises.status_id','=',4)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lgc_critico = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->whereBetween('negocios.id', [21, 27])
                           ->where('preditiva_analises.status_id','=',5)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

   // dd("manutenção = ".$lds_manutencao, "standby = ".$lds_standBy, "normal = ".$lds_normal, "alarme = ".$lds_alarme, "critico = ".$lds_critico);


      return view('csn.relatorioGerencial.includes.indexRelGerLB_uti_perfil')
     ->with('title', $title)->with('tecnica', $tecnica)->with('manutencao', $lgc_manutencao)->with('standBy', $lgc_standBy)
     ->with('normal', $lgc_normal)->with('alarme', $lgc_alarme)->with('critico', $lgc_critico);
   }

    public function UtiAnormalidades()
   {

     $title = 'Anormalidades UTI';
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();
     $normal1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();
     $normal2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $critico2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();
     $normal3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $critico3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();
     $normal4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $critico4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();
     $normal5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $critico5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();
     $normal6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $critico6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();
     $normal7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $critico7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();
     $normal8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $critico8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();
     $normal9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $critico9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();
     $normal10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $critico10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();
     $normal11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $critico11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();
     $normal12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $critico12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     return view('csn.relatorioGerencial.includes.relatoriosOleo.uti-anormalidades')
       ->with('title', $title)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);
   }

    public function UtiStatusPontos()
   {
     $title = 'UTI';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $normal001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $n1 = ($normal001+$alarme001+$critico001);
     $a1 = ($normal001+$alarme001+$critico001);
     $c1 = ($normal001+$alarme001+$critico001);

     if ($n1 > 0) {
       $normal1 = number_format((($normal001/$n1)*100),0,",",".");
     } else {
      $normal1 = 0;
    }
     if ($a1 > 0) {
       $alarme1 = number_format((($alarme001/$a1)*100),0,",",".");
     } else {
      $alarme1 = 0;
    }
     if ($c1 > 0) {
       $critico1 = number_format((($critico001/$c1)*100),0,",",".");
     } else {
      $critico1 = 0;
    }


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $normal002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $critico002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $n2 = ($normal002+$alarme002+$critico002);
     $a2 = ($normal002+$alarme002+$critico002);
     $c2 = ($normal002+$alarme002+$critico002);

     if ($n2 > 0) {
       $normal2 = number_format((($normal002/$n2)*100),0,",",".");
     } else {
      $normal2 = 0;
    }
     if ($a2 > 0) {
       $alarme2 = number_format((($alarme002/$a2)*100),0,",",".");
     } else {
      $alarme2 = 0;
    }
     if ($c2 > 0) {
       $critico2 = number_format((($critico002/$c2)*100),0,",",".");
     } else {
      $critico2 = 0;
    }



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $normal003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $critico003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $n3 = ($normal003+$alarme003+$critico003);
     $a3 = ($normal003+$alarme003+$critico003);
     $c3 = ($normal003+$alarme003+$critico003);

     if ($n3 > 0) {
       $normal3 = number_format((($normal003/$n3)*100),0,",",".");
     } else {
      $normal3 = 0;
    }
     if ($a3 > 0) {
       $alarme3 = number_format((($alarme003/$a3)*100),0,",",".");
     } else {
      $alarme3 = 0;
    }
     if ($c3 > 0) {
       $critico3 = number_format((($critico003/$c3)*100),0,",",".");
     } else {
      $critico3 = 0;
    }


     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $normal004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $critico004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $n4 = ($normal004+$alarme004+$critico004);
     $a4 = ($normal004+$alarme004+$critico004);
     $c4 = ($normal004+$alarme004+$critico004);

     if ($n4 > 0) {
       $normal4 = number_format((($normal004/$n4)*100),0,",",".");
     } else {
      $normal4 = 0;
    }
     if ($a4 > 0) {
       $alarme4 = number_format((($alarme004/$a4)*100),0,",",".");
     } else {
      $alarme4 = 0;
    }
     if ($c4 > 0) {
       $critico4 = number_format((($critico004/$c4)*100),0,",",".");
     } else {
      $critico4 = 0;
    }


     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();

     $normal005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $critico005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $n5 = ($normal005+$alarme005+$critico005);
     $a5 = ($normal005+$alarme005+$critico005);
     $c5 = ($normal005+$alarme005+$critico005);

     if ($n5 > 0) {
       $normal5 = number_format((($normal005/$n5)*100),0,",",".");
     } else {
      $normal5 = 0;
    }
     if ($a5 > 0)
     {
       $alarme5 = number_format((($alarme005/$a5)*100),0,",",".");
     }
     else
     {
        $alarme5 = 0;
     }
     if ($c5 > 0) {
       $critico5 = number_format((($critico005/$c5)*100),0,",",".");
     } else {
      $critico5 = 0;
    }


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();

     $normal006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $critico006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $n6 = ($normal006+$alarme006+$critico006);
     $a6 = ($normal006+$alarme006+$critico006);
     $c6 = ($normal006+$alarme006+$critico006);

     if ($n6 > 0) {
       $normal6 = number_format((($normal006/$n6)*100),0,",",".");
     } else {
      $normal6 = 0;
    }
     if ($a6 > 0) {
       $alarme6 = number_format((($alarme006/$a6)*100),0,",",".");
     } else {
      $alarme6 = 0;
    }
     if ($c6 > 0) {
       $critico6 = number_format((($critico006/$c6)*100),0,",",".");
     } else {
      $critico6 = 0;
    }


     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();

     $normal007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $critico007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $n7 = ($normal007+$alarme007+$critico007);
     $a7 = ($normal007+$alarme007+$critico007);
     $c7 = ($normal007+$alarme007+$critico007);

     if ($n7 > 0) {
       $normal7 = number_format((($normal007/$n7)*100),0,",",".");
     } else {
      $normal7 = 0;
    }
     if ($a7 > 0) {
       $alarme7 = number_format((($alarme007/$a7)*100),0,",",".");
     } else {
      $alarme7 = 0;
    }
     if ($c7 > 0) {
       $critico7 = number_format((($critico007/$c7)*100),0,",",".");
     } else {
      $critico7 = 0;
    }


     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $normal008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $critico008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $n8 = ($normal008+$alarme008+$critico008);
     $a8 = ($normal008+$alarme008+$critico008);
     $c8 = ($normal008+$alarme008+$critico008);

     if ($n8 > 0) {
       $normal8 = number_format((($normal008/$n8)*100),0,",",".");
     } else {
      $normal8 = 0;
    }
     if ($a8 > 0) {
       $alarme8 = number_format((($alarme008/$a8)*100),0,",",".");
     } else {
      $alarme8 = 0;
    }
     if ($c8 > 0) {
       $critico8 = number_format((($critico008/$c8)*100),0,",",".");
     } else {
      $critico8 = 0;
    }


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $normal009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $critico009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $n9 = ($normal009+$alarme009+$critico009);
     $a9 = ($normal009+$alarme009+$critico009);
     $c9 = ($normal009+$alarme009+$critico009);

     if ($n9 > 0) {
       $normal9 = number_format((($normal009/$n9)*100),0,",",".");
     } else {
      $normal9 = 0;
    }
     if ($a9 > 0) {
       $alarme9 = number_format((($alarme009/$a9)*100),0,",",".");
     } else {
      $alarme9 = 0;
    }
     if ($c9 > 0) {
       $critico9 = number_format((($critico009/$c9)*100),0,",",".");
     } else {
      $critico9 = 0;
    }


     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

     $normal010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $critico010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $n10 = ($normal010+$alarme010+$critico010);
     $a10 = ($normal010+$alarme010+$critico010);
     $c10 = ($normal010+$alarme010+$critico010);

     if ($n10 > 0) {
       $normal10 = number_format((($normal010/$n10)*100),0,",",".");
     } else {
      $normal10 = 0;
    }
     if ($a10 > 0) {
       $alarme10 = number_format((($alarme010/$a10)*100),0,",",".");
     } else {
      $alarme10 = 0;
    }
     if ($c10 > 0) {
       $critico10 = number_format((($critico010/$c10)*100),0,",",".");
     } else {
      $critico10 = 0;
    }


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

     $normal011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $critico011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $n11 = ($normal011+$alarme011+$critico011);
     $a11 = ($normal011+$alarme011+$critico011);
     $c11 = ($normal011+$alarme011+$critico011);

     if ($n11 > 0) {
       $normal11 = number_format((($normal011/$n11)*100),0,",",".");
     } else {
      $normal11 = 0;
    }
     if ($a11 > 0) {
       $alarme11 = number_format((($alarme011/$a11)*100),0,",",".");
     } else {
      $alarme11 = 0;
    }
     if ($c11 > 0) {
       $critico11 = number_format((($critico011/$c11)*100),0,",",".");
     } else {
      $critico11 = 0;
    }


     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

     $normal012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $critico012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $n12 = ($normal012+$alarme012+$critico012);
     $a12 = ($normal012+$alarme012+$critico012);
     $c12 = ($normal012+$alarme012+$critico012);

     if ($n12 > 0) {
       $normal12 = number_format((($normal012/$n12)*100),0,",",".");
     } else {
      $normal12 = 0;
    }
     if ($a12 > 0) {
       $alarme12 = number_format((($alarme012/$a12)*100),0,",",".");
     } else {
      $alarme12 = 0;
    }
     if ($c12 > 0) {
       $critico12 = number_format((($critico012/$c12)*100),0,",",".");
     } else {
      $critico12 = 0;
    }
     return view('csn.relatorioGerencial.includes.relatoriosOleo.uti-statusPontos')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);
   }

    public function UtiProblemasEncontrados()
   {
      $title = 'URA';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $agua1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $agua2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $agua3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $agua4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();


      $agua5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();


     $agua6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();


      $agua7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');



     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $agua8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $agua9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');



     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

      $agua10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

      $agua11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');



     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

      $agua12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [21, 27])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');




     return view('csn.relatorioGerencial.includes.relatoriosOleo.ura-problemasEncontrados')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('agua1', $agua1)->with('particulado1', $particulado1)->with('viscosidade1', $viscosidade1)->with('demulsibilidade1', $demulsibilidade1)->with('desgaste1', $desgaste1)
       ->with('dataFAnt2', $dataFAnt2)->with('agua2', $agua2)->with('particulado2', $particulado2)->with('viscosidade2', $viscosidade2)->with('demulsibilidade2', $demulsibilidade2)->with('desgaste2', $desgaste2)
       ->with('dataFAnt3', $dataFAnt3)->with('agua3', $agua3)->with('particulado3', $particulado3)->with('viscosidade3', $viscosidade3)->with('demulsibilidade3', $demulsibilidade3)->with('desgaste3', $desgaste3)
       ->with('dataFAnt4', $dataFAnt4)->with('agua4', $agua4)->with('particulado4', $particulado4)->with('viscosidade4', $viscosidade4)->with('demulsibilidade4', $demulsibilidade4)->with('desgaste4', $desgaste4)
       ->with('dataFAnt5', $dataFAnt5)->with('agua5', $agua5)->with('particulado5', $particulado5)->with('viscosidade5', $viscosidade5)->with('demulsibilidade5', $demulsibilidade5)->with('desgaste5', $desgaste5)
       ->with('dataFAnt6', $dataFAnt6)->with('agua6', $agua6)->with('particulado6', $particulado6)->with('viscosidade6', $viscosidade6)->with('demulsibilidade6', $demulsibilidade6)->with('desgaste6', $desgaste6)
       ->with('dataFAnt7', $dataFAnt7)->with('agua7', $agua7)->with('particulado7', $particulado7)->with('viscosidade7', $viscosidade7)->with('demulsibilidade7', $demulsibilidade7)->with('desgaste7', $desgaste7)
       ->with('dataFAnt8', $dataFAnt8)->with('agua8', $agua8)->with('particulado8', $particulado8)->with('viscosidade8', $viscosidade8)->with('demulsibilidade8', $demulsibilidade8)->with('desgaste8', $desgaste8)
       ->with('dataFAnt9', $dataFAnt9)->with('agua9', $agua9)->with('particulado9', $particulado9)->with('viscosidade9', $viscosidade9)->with('demulsibilidade9', $demulsibilidade9)->with('desgaste9', $desgaste9)
       ->with('dataFAnt10', $dataFAnt10)->with('agua10', $agua10)->with('particulado10', $particulado10)->with('viscosidade10', $viscosidade10)->with('demulsibilidade10', $demulsibilidade10)->with('desgaste10', $desgaste10)
       ->with('dataFAnt11', $dataFAnt11)->with('agua11', $agua11)->with('particulado11', $particulado11)->with('viscosidade11', $viscosidade11)->with('demulsibilidade11', $demulsibilidade11)->with('desgaste11', $desgaste11)
       ->with('dataFAnt12', $dataFAnt12)->with('agua12', $agua12)->with('particulado12', $particulado12)->with('viscosidade12', $viscosidade12)->with('demulsibilidade12', $demulsibilidade12)->with('desgaste12', $desgaste12);



}


   public function LgcPerfil()
  {

    $title = 'LGC';
    $tecnica = DB::table('tecnicas')->where('id', '<', 6)->pluck("name_tecnica","id");
    //data do sistema
    $atualInicial = Carbon::today();
    $atual = Carbon::now();
    $dataAnterior = $atual->subMonths(1);

     $lds_manutencao = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',13)
                           ->where('preditiva_analises.status_id','=',1)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lds_standBy = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',13)
                           ->where('preditiva_analises.status_id','=',2)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lds_normal = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',13)
                           ->where('preditiva_analises.status_id','=',3)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lds_alarme = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',13)
                           ->where('preditiva_analises.status_id','=',4)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lds_critico = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',13)
                           ->where('preditiva_analises.status_id','=',5)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

      return view('csn.relatorioGerencial.includes.indexRelGerLB_lgc_perfil')
     ->with('title', $title)->with('tecnica', $tecnica)->with('manutencao', $lds_manutencao)->with('standBy', $lds_standBy)
     ->with('normal', $lds_normal)->with('alarme', $lds_alarme)->with('critico', $lds_critico);

   }


   public function LgcAnormalidades()
   {

     $title = 'Anormalidades LGC';
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();
     $normal1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();
     $normal2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $critico2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();
     $normal3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $critico3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();
     $normal4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $critico4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();
     $normal5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $critico5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();
     $normal6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $critico6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();
     $normal7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $critico7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();
     $normal8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $critico8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();
     $normal9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $critico9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();
     $normal10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $critico10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();
     $normal11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $critico11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();
     $normal12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $critico12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     return view('csn.relatorioGerencial.includes.relatoriosOleo.lgc-anormalidades')
       ->with('title', $title)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);




   }


   public function LgcStatusPontos()
   {

     $title = 'LGC';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $normal001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $n1 = ($normal001+$alarme001+$critico001);
     $a1 = ($normal001+$alarme001+$critico001);
     $c1 = ($normal001+$alarme001+$critico001);

     if ($n1 > 0) {
       $normal1 = number_format((($normal001/$n1)*100),0,",",".");
     } else {
      $normal1 = 0;
    }
     if ($a1 > 0) {
       $alarme1 = number_format((($alarme001/$a1)*100),0,",",".");
     } else {
      $alarme1 = 0;
    }
     if ($c1 > 0) {
       $critico1 = number_format((($critico001/$c1)*100),0,",",".");
     } else {
      $critico1 = 0;
    }


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $normal002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $critico002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $n2 = ($normal002+$alarme002+$critico002);
     $a2 = ($normal002+$alarme002+$critico002);
     $c2 = ($normal002+$alarme002+$critico002);

     if ($n2 > 0) {
       $normal2 = number_format((($normal002/$n2)*100),0,",",".");
     } else {
      $normal2 = 0;
    }
     if ($a2 > 0) {
       $alarme2 = number_format((($alarme002/$a2)*100),0,",",".");
     } else {
      $alarme2 = 0;
    }
     if ($c2 > 0) {
       $critico2 = number_format((($critico002/$c2)*100),0,",",".");
     } else {
      $critico2 = 0;
    }



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $normal003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $critico003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $n3 = ($normal003+$alarme003+$critico003);
     $a3 = ($normal003+$alarme003+$critico003);
     $c3 = ($normal003+$alarme003+$critico003);

     if ($n3 > 0) {
       $normal3 = number_format((($normal003/$n3)*100),0,",",".");
     } else {
      $normal3 = 0;
    }
     if ($a3 > 0) {
       $alarme3 = number_format((($alarme003/$a3)*100),0,",",".");
     } else {
      $alarme3 = 0;
    }
     if ($c3 > 0) {
       $critico3 = number_format((($critico003/$c3)*100),0,",",".");
     } else {
      $critico3 = 0;
    }


     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $normal004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $critico004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $n4 = ($normal004+$alarme004+$critico004);
     $a4 = ($normal004+$alarme004+$critico004);
     $c4 = ($normal004+$alarme004+$critico004);

     if ($n4 > 0) {
       $normal4 = number_format((($normal004/$n4)*100),0,",",".");
     } else {
      $normal4 = 0;
    }
     if ($a4 > 0) {
       $alarme4 = number_format((($alarme004/$a4)*100),0,",",".");
     } else {
      $alarme4 = 0;
    }
     if ($c4 > 0) {
       $critico4 = number_format((($critico004/$c4)*100),0,",",".");
     } else {
      $critico4 = 0;
    }


     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();

     $normal005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $critico005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $n5 = ($normal005+$alarme005+$critico005);
     $a5 = ($normal005+$alarme005+$critico005);
     $c5 = ($normal005+$alarme005+$critico005);

     if ($n5 > 0) {
       $normal5 = number_format((($normal005/$n5)*100),0,",",".");
     } else {
      $normal5 = 0;
    }
     if ($a5 > 0)
     {
       $alarme5 = number_format((($alarme005/$a5)*100),0,",",".");
     }
     else
     {
        $alarme5 = 0;
     }
     if ($c5 > 0) {
       $critico5 = number_format((($critico005/$c5)*100),0,",",".");
     } else {
      $critico5 = 0;
    }


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();

     $normal006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $critico006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $n6 = ($normal006+$alarme006+$critico006);
     $a6 = ($normal006+$alarme006+$critico006);
     $c6 = ($normal006+$alarme006+$critico006);

     if ($n6 > 0) {
       $normal6 = number_format((($normal006/$n6)*100),0,",",".");
     } else {
      $normal6 = 0;
    }
     if ($a6 > 0) {
       $alarme6 = number_format((($alarme006/$a6)*100),0,",",".");
     } else {
      $alarme6 = 0;
    }
     if ($c6 > 0) {
       $critico6 = number_format((($critico006/$c6)*100),0,",",".");
     } else {
      $critico6 = 0;
    }


     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();

     $normal007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $critico007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $n7 = ($normal007+$alarme007+$critico007);
     $a7 = ($normal007+$alarme007+$critico007);
     $c7 = ($normal007+$alarme007+$critico007);

     if ($n7 > 0) {
       $normal7 = number_format((($normal007/$n7)*100),0,",",".");
     } else {
      $normal7 = 0;
    }
     if ($a7 > 0) {
       $alarme7 = number_format((($alarme007/$a7)*100),0,",",".");
     } else {
      $alarme7 = 0;
    }
     if ($c7 > 0) {
       $critico7 = number_format((($critico007/$c7)*100),0,",",".");
     } else {
      $critico7 = 0;
    }


     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $normal008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $critico008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $n8 = ($normal008+$alarme008+$critico008);
     $a8 = ($normal008+$alarme008+$critico008);
     $c8 = ($normal008+$alarme008+$critico008);

     if ($n8 > 0) {
       $normal8 = number_format((($normal008/$n8)*100),0,",",".");
     } else {
      $normal8 = 0;
    }
     if ($a8 > 0) {
       $alarme8 = number_format((($alarme008/$a8)*100),0,",",".");
     } else {
      $alarme8 = 0;
    }
     if ($c8 > 0) {
       $critico8 = number_format((($critico008/$c8)*100),0,",",".");
     } else {
      $critico8 = 0;
    }


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $normal009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $critico009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $n9 = ($normal009+$alarme009+$critico009);
     $a9 = ($normal009+$alarme009+$critico009);
     $c9 = ($normal009+$alarme009+$critico009);

     if ($n9 > 0) {
       $normal9 = number_format((($normal009/$n9)*100),0,",",".");
     } else {
      $normal9 = 0;
    }
     if ($a9 > 0) {
       $alarme9 = number_format((($alarme009/$a9)*100),0,",",".");
     } else {
      $alarme9 = 0;
    }
     if ($c9 > 0) {
       $critico9 = number_format((($critico009/$c9)*100),0,",",".");
     } else {
      $critico9 = 0;
    }


     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

     $normal010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $critico010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $n10 = ($normal010+$alarme010+$critico010);
     $a10 = ($normal010+$alarme010+$critico010);
     $c10 = ($normal010+$alarme010+$critico010);

     if ($n10 > 0) {
       $normal10 = number_format((($normal010/$n10)*100),0,",",".");
     } else {
      $normal10 = 0;
    }
     if ($a10 > 0) {
       $alarme10 = number_format((($alarme010/$a10)*100),0,",",".");
     } else {
      $alarme10 = 0;
    }
     if ($c10 > 0) {
       $critico10 = number_format((($critico010/$c10)*100),0,",",".");
     } else {
      $critico10 = 0;
    }


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

     $normal011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $critico011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $n11 = ($normal011+$alarme011+$critico011);
     $a11 = ($normal011+$alarme011+$critico011);
     $c11 = ($normal011+$alarme011+$critico011);

     if ($n11 > 0) {
       $normal11 = number_format((($normal011/$n11)*100),0,",",".");
     } else {
      $normal11 = 0;
    }
     if ($a11 > 0) {
       $alarme11 = number_format((($alarme011/$a11)*100),0,",",".");
     } else {
      $alarme11 = 0;
    }
     if ($c11 > 0) {
       $critico11 = number_format((($critico011/$c11)*100),0,",",".");
     } else {
      $critico11 = 0;
    }


     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

     $normal012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $critico012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $n12 = ($normal012+$alarme012+$critico012);
     $a12 = ($normal012+$alarme012+$critico012);
     $c12 = ($normal012+$alarme012+$critico012);

     if ($n12 > 0) {
       $normal12 = number_format((($normal012/$n12)*100),0,",",".");
     } else {
      $normal12 = 0;
    }
     if ($a12 > 0) {
       $alarme12 = number_format((($alarme012/$a12)*100),0,",",".");
     } else {
      $alarme12 = 0;
    }
     if ($c12 > 0) {
       $critico12 = number_format((($critico012/$c12)*100),0,",",".");
     } else {
      $critico12 = 0;
    }
     return view('csn.relatorioGerencial.includes.relatoriosOleo.lgc-statusPontos')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);



   }
   public function LgcProblemasEncontrados()
   {


     $title = 'LGC';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $agua1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $agua2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $agua3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $agua4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();


      $agua5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();


     $agua6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();


      $agua7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');



     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $agua8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $agua9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');



     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

      $agua10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

      $agua11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');



     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

      $agua12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',13)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');




     return view('csn.relatorioGerencial.includes.relatoriosOleo.lgc-problemasEncontrados')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('agua1', $agua1)->with('particulado1', $particulado1)->with('viscosidade1', $viscosidade1)->with('demulsibilidade1', $demulsibilidade1)->with('desgaste1', $desgaste1)
       ->with('dataFAnt2', $dataFAnt2)->with('agua2', $agua2)->with('particulado2', $particulado2)->with('viscosidade2', $viscosidade2)->with('demulsibilidade2', $demulsibilidade2)->with('desgaste2', $desgaste2)
       ->with('dataFAnt3', $dataFAnt3)->with('agua3', $agua3)->with('particulado3', $particulado3)->with('viscosidade3', $viscosidade3)->with('demulsibilidade3', $demulsibilidade3)->with('desgaste3', $desgaste3)
       ->with('dataFAnt4', $dataFAnt4)->with('agua4', $agua4)->with('particulado4', $particulado4)->with('viscosidade4', $viscosidade4)->with('demulsibilidade4', $demulsibilidade4)->with('desgaste4', $desgaste4)
       ->with('dataFAnt5', $dataFAnt5)->with('agua5', $agua5)->with('particulado5', $particulado5)->with('viscosidade5', $viscosidade5)->with('demulsibilidade5', $demulsibilidade5)->with('desgaste5', $desgaste5)
       ->with('dataFAnt6', $dataFAnt6)->with('agua6', $agua6)->with('particulado6', $particulado6)->with('viscosidade6', $viscosidade6)->with('demulsibilidade6', $demulsibilidade6)->with('desgaste6', $desgaste6)
       ->with('dataFAnt7', $dataFAnt7)->with('agua7', $agua7)->with('particulado7', $particulado7)->with('viscosidade7', $viscosidade7)->with('demulsibilidade7', $demulsibilidade7)->with('desgaste7', $desgaste7)
       ->with('dataFAnt8', $dataFAnt8)->with('agua8', $agua8)->with('particulado8', $particulado8)->with('viscosidade8', $viscosidade8)->with('demulsibilidade8', $demulsibilidade8)->with('desgaste8', $desgaste8)
       ->with('dataFAnt9', $dataFAnt9)->with('agua9', $agua9)->with('particulado9', $particulado9)->with('viscosidade9', $viscosidade9)->with('demulsibilidade9', $demulsibilidade9)->with('desgaste9', $desgaste9)
       ->with('dataFAnt10', $dataFAnt10)->with('agua10', $agua10)->with('particulado10', $particulado10)->with('viscosidade10', $viscosidade10)->with('demulsibilidade10', $demulsibilidade10)->with('desgaste10', $desgaste10)
       ->with('dataFAnt11', $dataFAnt11)->with('agua11', $agua11)->with('particulado11', $particulado11)->with('viscosidade11', $viscosidade11)->with('demulsibilidade11', $demulsibilidade11)->with('desgaste11', $desgaste11)
       ->with('dataFAnt12', $dataFAnt12)->with('agua12', $agua12)->with('particulado12', $particulado12)->with('viscosidade12', $viscosidade12)->with('demulsibilidade12', $demulsibilidade12)->with('desgaste12', $desgaste12);


   }


   public function LpcPerfil()
   {

    $title = 'Perfil LPC';
    $tecnica = DB::table('tecnicas')->where('id', '<', 6)->pluck("name_tecnica","id");
    //data do sistema
    $atualInicial = Carbon::today();
    $atual = Carbon::now();
    $dataAnterior = $atual->subMonths(1);

     $lpc_manutencao = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',14)
                           ->where('preditiva_analises.status_id','=',1)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lpc_standBy = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',14)
                           ->where('preditiva_analises.status_id','=',2)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lpc_normal = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',14)
                           ->where('preditiva_analises.status_id','=',3)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lpc_alarme = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',14)
                           ->where('preditiva_analises.status_id','=',4)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $lpc_critico = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->where('negocios.id','=',14)
                           ->where('preditiva_analises.status_id','=',5)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

   // dd("manutenção = ".$lds_manutencao, "standby = ".$lds_standBy, "normal = ".$lds_normal, "alarme = ".$lds_alarme, "critico = ".$lds_critico);


      return view('csn.relatorioGerencial.includes.indexRelGerLB_lpc_perfil')
     ->with('title', $title)->with('tecnica', $tecnica)->with('manutencao', $lpc_manutencao)->with('standBy', $lpc_standBy)
     ->with('normal', $lpc_normal)->with('alarme', $lpc_alarme)->with('critico', $lpc_critico);

   }


   public function LpcAnormalidades()
   {

     $title = 'Anormalidades LPC';
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();
     $normal1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();
     $normal2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $critico2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();
     $normal3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $critico3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();
     $normal4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $critico4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();
     $normal5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $critico5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();
     $normal6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $critico6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();
     $normal7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $critico7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();
     $normal8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $critico8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();
     $normal9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $critico9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();
     $normal10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $critico10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();
     $normal11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $critico11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();
     $normal12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $critico12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     return view('csn.relatorioGerencial.includes.relatoriosOleo.lpc-anormalidades')
       ->with('title', $title)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);





   }


   public function LpcStatusPontos()
   {

     $title = 'LPC';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $normal001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $n1 = ($normal001+$alarme001+$critico001);
     $a1 = ($normal001+$alarme001+$critico001);
     $c1 = ($normal001+$alarme001+$critico001);

     if ($n1 > 0) {
       $normal1 = number_format((($normal001/$n1)*100),0,",",".");
     } else {
      $normal1 = 0;
    }
     if ($a1 > 0) {
       $alarme1 = number_format((($alarme001/$a1)*100),0,",",".");
     } else {
      $alarme1 = 0;
    }
     if ($c1 > 0) {
       $critico1 = number_format((($critico001/$c1)*100),0,",",".");
     } else {
      $critico1 = 0;
    }


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $normal002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $critico002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $n2 = ($normal002+$alarme002+$critico002);
     $a2 = ($normal002+$alarme002+$critico002);
     $c2 = ($normal002+$alarme002+$critico002);

     if ($n2 > 0) {
       $normal2 = number_format((($normal002/$n2)*100),0,",",".");
     } else {
      $normal2 = 0;
    }
     if ($a2 > 0) {
       $alarme2 = number_format((($alarme002/$a2)*100),0,",",".");
     } else {
      $alarme2 = 0;
    }
     if ($c2 > 0) {
       $critico2 = number_format((($critico002/$c2)*100),0,",",".");
     } else {
      $critico2 = 0;
    }



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $normal003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $critico003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $n3 = ($normal003+$alarme003+$critico003);
     $a3 = ($normal003+$alarme003+$critico003);
     $c3 = ($normal003+$alarme003+$critico003);

     if ($n3 > 0) {
       $normal3 = number_format((($normal003/$n3)*100),0,",",".");
     } else {
      $normal3 = 0;
    }
     if ($a3 > 0) {
       $alarme3 = number_format((($alarme003/$a3)*100),0,",",".");
     } else {
      $alarme3 = 0;
    }
     if ($c3 > 0) {
       $critico3 = number_format((($critico003/$c3)*100),0,",",".");
     } else {
      $critico3 = 0;
    }


     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $normal004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $critico004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $n4 = ($normal004+$alarme004+$critico004);
     $a4 = ($normal004+$alarme004+$critico004);
     $c4 = ($normal004+$alarme004+$critico004);

     if ($n4 > 0) {
       $normal4 = number_format((($normal004/$n4)*100),0,",",".");
     } else {
      $normal4 = 0;
    }
     if ($a4 > 0) {
       $alarme4 = number_format((($alarme004/$a4)*100),0,",",".");
     } else {
      $alarme4 = 0;
    }
     if ($c4 > 0) {
       $critico4 = number_format((($critico004/$c4)*100),0,",",".");
     } else {
      $critico4 = 0;
    }


     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();

     $normal005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $critico005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $n5 = ($normal005+$alarme005+$critico005);
     $a5 = ($normal005+$alarme005+$critico005);
     $c5 = ($normal005+$alarme005+$critico005);

     if ($n5 > 0) {
       $normal5 = number_format((($normal005/$n5)*100),0,",",".");
     } else {
      $normal5 = 0;
    }
     if ($a5 > 0)
     {
       $alarme5 = number_format((($alarme005/$a5)*100),0,",",".");
     }
     else
     {
        $alarme5 = 0;
     }
     if ($c5 > 0) {
       $critico5 = number_format((($critico005/$c5)*100),0,",",".");
     } else {
      $critico5 = 0;
    }


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();

     $normal006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $critico006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $n6 = ($normal006+$alarme006+$critico006);
     $a6 = ($normal006+$alarme006+$critico006);
     $c6 = ($normal006+$alarme006+$critico006);

     if ($n6 > 0) {
       $normal6 = number_format((($normal006/$n6)*100),0,",",".");
     } else {
      $normal6 = 0;
    }
     if ($a6 > 0) {
       $alarme6 = number_format((($alarme006/$a6)*100),0,",",".");
     } else {
      $alarme6 = 0;
    }
     if ($c6 > 0) {
       $critico6 = number_format((($critico006/$c6)*100),0,",",".");
     } else {
      $critico6 = 0;
    }


     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();

     $normal007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $critico007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $n7 = ($normal007+$alarme007+$critico007);
     $a7 = ($normal007+$alarme007+$critico007);
     $c7 = ($normal007+$alarme007+$critico007);

     if ($n7 > 0) {
       $normal7 = number_format((($normal007/$n7)*100),0,",",".");
     } else {
      $normal7 = 0;
    }
     if ($a7 > 0) {
       $alarme7 = number_format((($alarme007/$a7)*100),0,",",".");
     } else {
      $alarme7 = 0;
    }
     if ($c7 > 0) {
       $critico7 = number_format((($critico007/$c7)*100),0,",",".");
     } else {
      $critico7 = 0;
    }


     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $normal008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $critico008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $n8 = ($normal008+$alarme008+$critico008);
     $a8 = ($normal008+$alarme008+$critico008);
     $c8 = ($normal008+$alarme008+$critico008);

     if ($n8 > 0) {
       $normal8 = number_format((($normal008/$n8)*100),0,",",".");
     } else {
      $normal8 = 0;
    }
     if ($a8 > 0) {
       $alarme8 = number_format((($alarme008/$a8)*100),0,",",".");
     } else {
      $alarme8 = 0;
    }
     if ($c8 > 0) {
       $critico8 = number_format((($critico008/$c8)*100),0,",",".");
     } else {
      $critico8 = 0;
    }


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $normal009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $critico009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $n9 = ($normal009+$alarme009+$critico009);
     $a9 = ($normal009+$alarme009+$critico009);
     $c9 = ($normal009+$alarme009+$critico009);

     if ($n9 > 0) {
       $normal9 = number_format((($normal009/$n9)*100),0,",",".");
     } else {
      $normal9 = 0;
    }
     if ($a9 > 0) {
       $alarme9 = number_format((($alarme009/$a9)*100),0,",",".");
     } else {
      $alarme9 = 0;
    }
     if ($c9 > 0) {
       $critico9 = number_format((($critico009/$c9)*100),0,",",".");
     } else {
      $critico9 = 0;
    }


     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

     $normal010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $critico010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $n10 = ($normal010+$alarme010+$critico010);
     $a10 = ($normal010+$alarme010+$critico010);
     $c10 = ($normal010+$alarme010+$critico010);

     if ($n10 > 0) {
       $normal10 = number_format((($normal010/$n10)*100),0,",",".");
     } else {
      $normal10 = 0;
    }
     if ($a10 > 0) {
       $alarme10 = number_format((($alarme010/$a10)*100),0,",",".");
     } else {
      $alarme10 = 0;
    }
     if ($c10 > 0) {
       $critico10 = number_format((($critico010/$c10)*100),0,",",".");
     } else {
      $critico10 = 0;
    }


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

     $normal011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $critico011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $n11 = ($normal011+$alarme011+$critico011);
     $a11 = ($normal011+$alarme011+$critico011);
     $c11 = ($normal011+$alarme011+$critico011);

     if ($n11 > 0) {
       $normal11 = number_format((($normal011/$n11)*100),0,",",".");
     } else {
      $normal11 = 0;
    }
     if ($a11 > 0) {
       $alarme11 = number_format((($alarme011/$a11)*100),0,",",".");
     } else {
      $alarme11 = 0;
    }
     if ($c11 > 0) {
       $critico11 = number_format((($critico011/$c11)*100),0,",",".");
     } else {
      $critico11 = 0;
    }


     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

     $normal012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $critico012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $n12 = ($normal012+$alarme012+$critico012);
     $a12 = ($normal012+$alarme012+$critico012);
     $c12 = ($normal012+$alarme012+$critico012);

     if ($n12 > 0) {
       $normal12 = number_format((($normal012/$n12)*100),0,",",".");
     } else {
      $normal12 = 0;
    }
     if ($a12 > 0) {
       $alarme12 = number_format((($alarme012/$a12)*100),0,",",".");
     } else {
      $alarme12 = 0;
    }
     if ($c12 > 0) {
       $critico12 = number_format((($critico012/$c12)*100),0,",",".");
     } else {
      $critico12 = 0;
    }
     return view('csn.relatorioGerencial.includes.relatoriosOleo.lpc-statusPontos')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);



   }


   public function LpcProblemasEncontrados()
   {

     $title = 'LPC';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $agua1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $agua2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $agua3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $agua4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();


      $agua5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();


     $agua6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();


      $agua7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');



     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $agua8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $agua9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');



     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

      $agua10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

      $agua11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');



     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

      $agua12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->where('negocios.id','=',14)
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');




     return view('csn.relatorioGerencial.includes.relatoriosOleo.lds-problemasEncontrados')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('agua1', $agua1)->with('particulado1', $particulado1)->with('viscosidade1', $viscosidade1)->with('demulsibilidade1', $demulsibilidade1)->with('desgaste1', $desgaste1)
       ->with('dataFAnt2', $dataFAnt2)->with('agua2', $agua2)->with('particulado2', $particulado2)->with('viscosidade2', $viscosidade2)->with('demulsibilidade2', $demulsibilidade2)->with('desgaste2', $desgaste2)
       ->with('dataFAnt3', $dataFAnt3)->with('agua3', $agua3)->with('particulado3', $particulado3)->with('viscosidade3', $viscosidade3)->with('demulsibilidade3', $demulsibilidade3)->with('desgaste3', $desgaste3)
       ->with('dataFAnt4', $dataFAnt4)->with('agua4', $agua4)->with('particulado4', $particulado4)->with('viscosidade4', $viscosidade4)->with('demulsibilidade4', $demulsibilidade4)->with('desgaste4', $desgaste4)
       ->with('dataFAnt5', $dataFAnt5)->with('agua5', $agua5)->with('particulado5', $particulado5)->with('viscosidade5', $viscosidade5)->with('demulsibilidade5', $demulsibilidade5)->with('desgaste5', $desgaste5)
       ->with('dataFAnt6', $dataFAnt6)->with('agua6', $agua6)->with('particulado6', $particulado6)->with('viscosidade6', $viscosidade6)->with('demulsibilidade6', $demulsibilidade6)->with('desgaste6', $desgaste6)
       ->with('dataFAnt7', $dataFAnt7)->with('agua7', $agua7)->with('particulado7', $particulado7)->with('viscosidade7', $viscosidade7)->with('demulsibilidade7', $demulsibilidade7)->with('desgaste7', $desgaste7)
       ->with('dataFAnt8', $dataFAnt8)->with('agua8', $agua8)->with('particulado8', $particulado8)->with('viscosidade8', $viscosidade8)->with('demulsibilidade8', $demulsibilidade8)->with('desgaste8', $desgaste8)
       ->with('dataFAnt9', $dataFAnt9)->with('agua9', $agua9)->with('particulado9', $particulado9)->with('viscosidade9', $viscosidade9)->with('demulsibilidade9', $demulsibilidade9)->with('desgaste9', $desgaste9)
       ->with('dataFAnt10', $dataFAnt10)->with('agua10', $agua10)->with('particulado10', $particulado10)->with('viscosidade10', $viscosidade10)->with('demulsibilidade10', $demulsibilidade10)->with('desgaste10', $desgaste10)
       ->with('dataFAnt11', $dataFAnt11)->with('agua11', $agua11)->with('particulado11', $particulado11)->with('viscosidade11', $viscosidade11)->with('demulsibilidade11', $demulsibilidade11)->with('desgaste11', $desgaste11)
       ->with('dataFAnt12', $dataFAnt12)->with('agua12', $agua12)->with('particulado12', $particulado12)->with('viscosidade12', $viscosidade12)->with('demulsibilidade12', $demulsibilidade12)->with('desgaste12', $desgaste12);


   }
   public function CsPerfil()
   {

    $title = 'Perfil CS';
    $tecnica = DB::table('tecnicas')->where('id', '<', 6)->pluck("name_tecnica","id");
    //data do sistema
    $atualInicial = Carbon::today();
    $atual = Carbon::now();
    $dataAnterior = $atual->subMonths(1);

     $cs_manutencao = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->whereBetween('negocios.id', [15, 20])
                           ->where('preditiva_analises.status_id','=',1)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $cs_standBy = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->whereBetween('negocios.id', [15, 20])
                           ->where('preditiva_analises.status_id','=',2)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $cs_normal = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->whereBetween('negocios.id', [15, 20])
                           ->where('preditiva_analises.status_id','=',3)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $cs_alarme = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->whereBetween('negocios.id', [15, 20])
                           ->where('preditiva_analises.status_id','=',4)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $cs_critico = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->whereBetween('negocios.id', [15, 20])
                           ->where('preditiva_analises.status_id','=',5)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    //dd("manutenção = ".$cs_manutencao, "standby = ".$cs_standBy, "normal = ".$cs_normal, "alarme = ".$cs_alarme, "critico = ".$cs_critico);


      return view('csn.relatorioGerencial.includes.indexRelGerLB_cs_perfil')
     ->with('title', $title)->with('tecnica', $tecnica)->with('manutencao', $cs_manutencao)->with('standBy', $cs_standBy)
     ->with('normal', $cs_normal)->with('alarme', $cs_alarme)->with('critico', $cs_critico);



   }
   public function CsAnormalidades()
   {

     $title = 'Anormalidades CS';
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();
     $normal1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();
     $normal2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $critico2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();
     $normal3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $critico3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();
     $normal4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $critico4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();
     $normal5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $critico5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();
     $normal6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $critico6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();
     $normal7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $critico7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();
     $normal8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $critico8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();
     $normal9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $critico9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();
     $normal10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $critico10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();
     $normal11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $critico11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();
     $normal12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $critico12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     return view('csn.relatorioGerencial.includes.relatoriosOleo.cs-anormalidades')
       ->with('title', $title)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);







   }
   public function CsStatusPontos()
   {

     $title = 'CS';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $normal001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $n1 = ($normal001+$alarme001+$critico001);
     $a1 = ($normal001+$alarme001+$critico001);
     $c1 = ($normal001+$alarme001+$critico001);

     if ($n1 > 0) {
       $normal1 = number_format((($normal001/$n1)*100),0,",",".");
     } else {
      $normal1 = 0;
    }
     if ($a1 > 0) {
       $alarme1 = number_format((($alarme001/$a1)*100),0,",",".");
     } else {
      $alarme1 = 0;
    }
     if ($c1 > 0) {
       $critico1 = number_format((($critico001/$c1)*100),0,",",".");
     } else {
      $critico1 = 0;
    }


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $normal002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $critico002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $n2 = ($normal002+$alarme002+$critico002);
     $a2 = ($normal002+$alarme002+$critico002);
     $c2 = ($normal002+$alarme002+$critico002);

     if ($n2 > 0) {
       $normal2 = number_format((($normal002/$n2)*100),0,",",".");
     } else {
      $normal2 = 0;
    }
     if ($a2 > 0) {
       $alarme2 = number_format((($alarme002/$a2)*100),0,",",".");
     } else {
      $alarme2 = 0;
    }
     if ($c2 > 0) {
       $critico2 = number_format((($critico002/$c2)*100),0,",",".");
     } else {
      $critico2 = 0;
    }



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $normal003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $critico003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $n3 = ($normal003+$alarme003+$critico003);
     $a3 = ($normal003+$alarme003+$critico003);
     $c3 = ($normal003+$alarme003+$critico003);

     if ($n3 > 0) {
       $normal3 = number_format((($normal003/$n3)*100),0,",",".");
     } else {
      $normal3 = 0;
    }
     if ($a3 > 0) {
       $alarme3 = number_format((($alarme003/$a3)*100),0,",",".");
     } else {
      $alarme3 = 0;
    }
     if ($c3 > 0) {
       $critico3 = number_format((($critico003/$c3)*100),0,",",".");
     } else {
      $critico3 = 0;
    }


     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $normal004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $critico004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $n4 = ($normal004+$alarme004+$critico004);
     $a4 = ($normal004+$alarme004+$critico004);
     $c4 = ($normal004+$alarme004+$critico004);

     if ($n4 > 0) {
       $normal4 = number_format((($normal004/$n4)*100),0,",",".");
     } else {
      $normal4 = 0;
    }
     if ($a4 > 0) {
       $alarme4 = number_format((($alarme004/$a4)*100),0,",",".");
     } else {
      $alarme4 = 0;
    }
     if ($c4 > 0) {
       $critico4 = number_format((($critico004/$c4)*100),0,",",".");
     } else {
      $critico4 = 0;
    }


     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();

     $normal005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $critico005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $n5 = ($normal005+$alarme005+$critico005);
     $a5 = ($normal005+$alarme005+$critico005);
     $c5 = ($normal005+$alarme005+$critico005);

     if ($n5 > 0) {
       $normal5 = number_format((($normal005/$n5)*100),0,",",".");
     } else {
      $normal5 = 0;
    }
     if ($a5 > 0)
     {
       $alarme5 = number_format((($alarme005/$a5)*100),0,",",".");
     }
     else
     {
        $alarme5 = 0;
     }
     if ($c5 > 0) {
       $critico5 = number_format((($critico005/$c5)*100),0,",",".");
     } else {
      $critico5 = 0;
    }


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();

     $normal006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $critico006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $n6 = ($normal006+$alarme006+$critico006);
     $a6 = ($normal006+$alarme006+$critico006);
     $c6 = ($normal006+$alarme006+$critico006);

     if ($n6 > 0) {
       $normal6 = number_format((($normal006/$n6)*100),0,",",".");
     } else {
      $normal6 = 0;
    }
     if ($a6 > 0) {
       $alarme6 = number_format((($alarme006/$a6)*100),0,",",".");
     } else {
      $alarme6 = 0;
    }
     if ($c6 > 0) {
       $critico6 = number_format((($critico006/$c6)*100),0,",",".");
     } else {
      $critico6 = 0;
    }


     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();

     $normal007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $critico007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $n7 = ($normal007+$alarme007+$critico007);
     $a7 = ($normal007+$alarme007+$critico007);
     $c7 = ($normal007+$alarme007+$critico007);

     if ($n7 > 0) {
       $normal7 = number_format((($normal007/$n7)*100),0,",",".");
     } else {
      $normal7 = 0;
    }
     if ($a7 > 0) {
       $alarme7 = number_format((($alarme007/$a7)*100),0,",",".");
     } else {
      $alarme7 = 0;
    }
     if ($c7 > 0) {
       $critico7 = number_format((($critico007/$c7)*100),0,",",".");
     } else {
      $critico7 = 0;
    }


     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $normal008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $critico008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $n8 = ($normal008+$alarme008+$critico008);
     $a8 = ($normal008+$alarme008+$critico008);
     $c8 = ($normal008+$alarme008+$critico008);

     if ($n8 > 0) {
       $normal8 = number_format((($normal008/$n8)*100),0,",",".");
     } else {
      $normal8 = 0;
    }
     if ($a8 > 0) {
       $alarme8 = number_format((($alarme008/$a8)*100),0,",",".");
     } else {
      $alarme8 = 0;
    }
     if ($c8 > 0) {
       $critico8 = number_format((($critico008/$c8)*100),0,",",".");
     } else {
      $critico8 = 0;
    }


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $normal009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $critico009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $n9 = ($normal009+$alarme009+$critico009);
     $a9 = ($normal009+$alarme009+$critico009);
     $c9 = ($normal009+$alarme009+$critico009);

     if ($n9 > 0) {
       $normal9 = number_format((($normal009/$n9)*100),0,",",".");
     } else {
      $normal9 = 0;
    }
     if ($a9 > 0) {
       $alarme9 = number_format((($alarme009/$a9)*100),0,",",".");
     } else {
      $alarme9 = 0;
    }
     if ($c9 > 0) {
       $critico9 = number_format((($critico009/$c9)*100),0,",",".");
     } else {
      $critico9 = 0;
    }


     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

     $normal010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $critico010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $n10 = ($normal010+$alarme010+$critico010);
     $a10 = ($normal010+$alarme010+$critico010);
     $c10 = ($normal010+$alarme010+$critico010);

     if ($n10 > 0) {
       $normal10 = number_format((($normal010/$n10)*100),0,",",".");
     } else {
      $normal10 = 0;
    }
     if ($a10 > 0) {
       $alarme10 = number_format((($alarme010/$a10)*100),0,",",".");
     } else {
      $alarme10 = 0;
    }
     if ($c10 > 0) {
       $critico10 = number_format((($critico010/$c10)*100),0,",",".");
     } else {
      $critico10 = 0;
    }


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

     $normal011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $critico011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $n11 = ($normal011+$alarme011+$critico011);
     $a11 = ($normal011+$alarme011+$critico011);
     $c11 = ($normal011+$alarme011+$critico011);

     if ($n11 > 0) {
       $normal11 = number_format((($normal011/$n11)*100),0,",",".");
     } else {
      $normal11 = 0;
    }
     if ($a11 > 0) {
       $alarme11 = number_format((($alarme011/$a11)*100),0,",",".");
     } else {
      $alarme11 = 0;
    }
     if ($c11 > 0) {
       $critico11 = number_format((($critico011/$c11)*100),0,",",".");
     } else {
      $critico11 = 0;
    }


     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

     $normal012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $critico012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $n12 = ($normal012+$alarme012+$critico012);
     $a12 = ($normal012+$alarme012+$critico012);
     $c12 = ($normal012+$alarme012+$critico012);

     if ($n12 > 0) {
       $normal12 = number_format((($normal012/$n12)*100),0,",",".");
     } else {
      $normal12 = 0;
    }
     if ($a12 > 0) {
       $alarme12 = number_format((($alarme012/$a12)*100),0,",",".");
     } else {
      $alarme12 = 0;
    }
     if ($c12 > 0) {
       $critico12 = number_format((($critico012/$c12)*100),0,",",".");
     } else {
      $critico12 = 0;
    }
     return view('csn.relatorioGerencial.includes.relatoriosOleo.cs-statusPontos')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);



   }
   public function CsProblemasEncontrados()
   {

       $title = 'LDS';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $agua1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $agua2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $agua3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $agua4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();


      $agua5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();


     $agua6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();


      $agua7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');



     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $agua8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $agua9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');



     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

      $agua10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

      $agua11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');



     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

      $agua12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');




     return view('csn.relatorioGerencial.includes.relatoriosOleo.cs-problemasEncontrados')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('agua1', $agua1)->with('particulado1', $particulado1)->with('viscosidade1', $viscosidade1)->with('demulsibilidade1', $demulsibilidade1)->with('desgaste1', $desgaste1)
       ->with('dataFAnt2', $dataFAnt2)->with('agua2', $agua2)->with('particulado2', $particulado2)->with('viscosidade2', $viscosidade2)->with('demulsibilidade2', $demulsibilidade2)->with('desgaste2', $desgaste2)
       ->with('dataFAnt3', $dataFAnt3)->with('agua3', $agua3)->with('particulado3', $particulado3)->with('viscosidade3', $viscosidade3)->with('demulsibilidade3', $demulsibilidade3)->with('desgaste3', $desgaste3)
       ->with('dataFAnt4', $dataFAnt4)->with('agua4', $agua4)->with('particulado4', $particulado4)->with('viscosidade4', $viscosidade4)->with('demulsibilidade4', $demulsibilidade4)->with('desgaste4', $desgaste4)
       ->with('dataFAnt5', $dataFAnt5)->with('agua5', $agua5)->with('particulado5', $particulado5)->with('viscosidade5', $viscosidade5)->with('demulsibilidade5', $demulsibilidade5)->with('desgaste5', $desgaste5)
       ->with('dataFAnt6', $dataFAnt6)->with('agua6', $agua6)->with('particulado6', $particulado6)->with('viscosidade6', $viscosidade6)->with('demulsibilidade6', $demulsibilidade6)->with('desgaste6', $desgaste6)
       ->with('dataFAnt7', $dataFAnt7)->with('agua7', $agua7)->with('particulado7', $particulado7)->with('viscosidade7', $viscosidade7)->with('demulsibilidade7', $demulsibilidade7)->with('desgaste7', $desgaste7)
       ->with('dataFAnt8', $dataFAnt8)->with('agua8', $agua8)->with('particulado8', $particulado8)->with('viscosidade8', $viscosidade8)->with('demulsibilidade8', $demulsibilidade8)->with('desgaste8', $desgaste8)
       ->with('dataFAnt9', $dataFAnt9)->with('agua9', $agua9)->with('particulado9', $particulado9)->with('viscosidade9', $viscosidade9)->with('demulsibilidade9', $demulsibilidade9)->with('desgaste9', $desgaste9)
       ->with('dataFAnt10', $dataFAnt10)->with('agua10', $agua10)->with('particulado10', $particulado10)->with('viscosidade10', $viscosidade10)->with('demulsibilidade10', $demulsibilidade10)->with('desgaste10', $desgaste10)
       ->with('dataFAnt11', $dataFAnt11)->with('agua11', $agua11)->with('particulado11', $particulado11)->with('viscosidade11', $viscosidade11)->with('demulsibilidade11', $demulsibilidade11)->with('desgaste11', $desgaste11)
       ->with('dataFAnt12', $dataFAnt12)->with('agua12', $agua12)->with('particulado12', $particulado12)->with('viscosidade12', $viscosidade12)->with('demulsibilidade12', $demulsibilidade12)->with('desgaste12', $desgaste12);




   }
   public function PrPerfil()
   {

    $title = 'Perfil PR';
    $tecnica = DB::table('tecnicas')->where('id', '<', 6)->pluck("name_tecnica","id");
    //data do sistema
    $atualInicial = Carbon::today();
    $atual = Carbon::now();
    $dataAnterior = $atual->subMonths(1);

     $pr_manutencao = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->whereBetween('negocios.id', [28, 41])
                           ->where('preditiva_analises.status_id','=',1)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $pr_standBy = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                           ->where('preditiva_analises.status_id','=',2)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $pr_normal = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                           ->where('preditiva_analises.status_id','=',3)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $pr_alarme = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->whereBetween('negocios.id', [28, 41])
                           ->where('preditiva_analises.status_id','=',4)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

    $pr_critico = DB::table('preditiva_analises')
                           ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                           ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                           ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                           ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                           ->whereBetween('negocios.id', [28, 41])
                           ->where('preditiva_analises.status_id','=',5)
                           ->where('preditiva_analises.tecnicas_id','=',4)
                           ->whereBetween('date_analise', [$dataAnterior, $atualInicial])
                           ->count('preditiva_analises.status_id');

   // dd("manutenção = ".$lds_manutencao, "standby = ".$lds_standBy, "normal = ".$lds_normal, "alarme = ".$lds_alarme, "critico = ".$lds_critico);


      return view('csn.relatorioGerencial.includes.indexRelGerLB_pr_perfil')
     ->with('title', $title)->with('tecnica', $tecnica)->with('manutencao', $pr_manutencao)->with('standBy', $pr_standBy)
     ->with('normal', $pr_normal)->with('alarme', $pr_alarme)->with('critico', $pr_critico);


   }
   public function PrAnormalidades()
   {

     $title = 'Anormalidades PR';
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();
     $normal1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();
     $normal2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $critico2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.status_id');

     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();
     $normal3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $critico3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.status_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();
     $normal4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $critico4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.status_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();
     $normal5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $critico5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.status_id');

     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();
     $normal6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $critico6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.status_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();
     $normal7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $critico7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.status_id');

     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();
     $normal8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $critico8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.status_id');

     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();
     $normal9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [15, 20])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $critico9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.status_id');

     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();
     $normal10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $critico10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.status_id');

     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();
     $normal11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $critico11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.status_id');

     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();
     $normal12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     $critico12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.status_id');

     return view('csn.relatorioGerencial.includes.relatoriosOleo.pr-anormalidades')
       ->with('title', $title)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);



   }

   public function PrStatusPontos()
   {

     $title = 'PR';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $normal001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $alarme001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $critico001 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.status_id');

     $n1 = ($normal001+$alarme001+$critico001);
     $a1 = ($normal001+$alarme001+$critico001);
     $c1 = ($normal001+$alarme001+$critico001);

     if ($n1 > 0) {
       $normal1 = number_format((($normal001/$n1)*100),0,",",".");
     } else {
      $normal1 = 0;
    }
     if ($a1 > 0) {
       $alarme1 = number_format((($alarme001/$a1)*100),0,",",".");
     } else {
      $alarme1 = 0;
    }
     if ($c1 > 0) {
       $critico1 = number_format((($critico001/$c1)*100),0,",",".");
     } else {
      $critico1 = 0;
    }


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $normal002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $alarme002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $critico002 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataAnt1])
                            ->count('preditiva_analises.status_id');

     $n2 = ($normal002+$alarme002+$critico002);
     $a2 = ($normal002+$alarme002+$critico002);
     $c2 = ($normal002+$alarme002+$critico002);

     if ($n2 > 0) {
       $normal2 = number_format((($normal002/$n2)*100),0,",",".");
     } else {
      $normal2 = 0;
    }
     if ($a2 > 0) {
       $alarme2 = number_format((($alarme002/$a2)*100),0,",",".");
     } else {
      $alarme2 = 0;
    }
     if ($c2 > 0) {
       $critico2 = number_format((($critico002/$c2)*100),0,",",".");
     } else {
      $critico2 = 0;
    }



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $normal003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $alarme003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $critico003 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataAnt2])
                            ->count('preditiva_analises.status_id');

     $n3 = ($normal003+$alarme003+$critico003);
     $a3 = ($normal003+$alarme003+$critico003);
     $c3 = ($normal003+$alarme003+$critico003);

     if ($n3 > 0) {
       $normal3 = number_format((($normal003/$n3)*100),0,",",".");
     } else {
      $normal3 = 0;
    }
     if ($a3 > 0) {
       $alarme3 = number_format((($alarme003/$a3)*100),0,",",".");
     } else {
      $alarme3 = 0;
    }
     if ($c3 > 0) {
       $critico3 = number_format((($critico003/$c3)*100),0,",",".");
     } else {
      $critico3 = 0;
    }


     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $normal004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $alarme004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $critico004 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataAnt3])
                            ->count('preditiva_analises.status_id');

     $n4 = ($normal004+$alarme004+$critico004);
     $a4 = ($normal004+$alarme004+$critico004);
     $c4 = ($normal004+$alarme004+$critico004);

     if ($n4 > 0) {
       $normal4 = number_format((($normal004/$n4)*100),0,",",".");
     } else {
      $normal4 = 0;
    }
     if ($a4 > 0) {
       $alarme4 = number_format((($alarme004/$a4)*100),0,",",".");
     } else {
      $alarme4 = 0;
    }
     if ($c4 > 0) {
       $critico4 = number_format((($critico004/$c4)*100),0,",",".");
     } else {
      $critico4 = 0;
    }


     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();

     $normal005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $alarme005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $critico005 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataAnt4])
                            ->count('preditiva_analises.status_id');

     $n5 = ($normal005+$alarme005+$critico005);
     $a5 = ($normal005+$alarme005+$critico005);
     $c5 = ($normal005+$alarme005+$critico005);

     if ($n5 > 0) {
       $normal5 = number_format((($normal005/$n5)*100),0,",",".");
     } else {
      $normal5 = 0;
    }
     if ($a5 > 0)
     {
       $alarme5 = number_format((($alarme005/$a5)*100),0,",",".");
     }
     else
     {
        $alarme5 = 0;
     }
     if ($c5 > 0) {
       $critico5 = number_format((($critico005/$c5)*100),0,",",".");
     } else {
      $critico5 = 0;
    }


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();

     $normal006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $alarme006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $critico006 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataAnt5])
                            ->count('preditiva_analises.status_id');

     $n6 = ($normal006+$alarme006+$critico006);
     $a6 = ($normal006+$alarme006+$critico006);
     $c6 = ($normal006+$alarme006+$critico006);

     if ($n6 > 0) {
       $normal6 = number_format((($normal006/$n6)*100),0,",",".");
     } else {
      $normal6 = 0;
    }
     if ($a6 > 0) {
       $alarme6 = number_format((($alarme006/$a6)*100),0,",",".");
     } else {
      $alarme6 = 0;
    }
     if ($c6 > 0) {
       $critico6 = number_format((($critico006/$c6)*100),0,",",".");
     } else {
      $critico6 = 0;
    }


     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();

     $normal007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $alarme007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $critico007 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataAnt6])
                            ->count('preditiva_analises.status_id');

     $n7 = ($normal007+$alarme007+$critico007);
     $a7 = ($normal007+$alarme007+$critico007);
     $c7 = ($normal007+$alarme007+$critico007);

     if ($n7 > 0) {
       $normal7 = number_format((($normal007/$n7)*100),0,",",".");
     } else {
      $normal7 = 0;
    }
     if ($a7 > 0) {
       $alarme7 = number_format((($alarme007/$a7)*100),0,",",".");
     } else {
      $alarme7 = 0;
    }
     if ($c7 > 0) {
       $critico7 = number_format((($critico007/$c7)*100),0,",",".");
     } else {
      $critico7 = 0;
    }


     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $normal008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $alarme008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $critico008 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataAnt7])
                            ->count('preditiva_analises.status_id');

     $n8 = ($normal008+$alarme008+$critico008);
     $a8 = ($normal008+$alarme008+$critico008);
     $c8 = ($normal008+$alarme008+$critico008);

     if ($n8 > 0) {
       $normal8 = number_format((($normal008/$n8)*100),0,",",".");
     } else {
      $normal8 = 0;
    }
     if ($a8 > 0) {
       $alarme8 = number_format((($alarme008/$a8)*100),0,",",".");
     } else {
      $alarme8 = 0;
    }
     if ($c8 > 0) {
       $critico8 = number_format((($critico008/$c8)*100),0,",",".");
     } else {
      $critico8 = 0;
    }


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $normal009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $alarme009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $critico009 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataAnt8])
                            ->count('preditiva_analises.status_id');

     $n9 = ($normal009+$alarme009+$critico009);
     $a9 = ($normal009+$alarme009+$critico009);
     $c9 = ($normal009+$alarme009+$critico009);

     if ($n9 > 0) {
       $normal9 = number_format((($normal009/$n9)*100),0,",",".");
     } else {
      $normal9 = 0;
    }
     if ($a9 > 0) {
       $alarme9 = number_format((($alarme009/$a9)*100),0,",",".");
     } else {
      $alarme9 = 0;
    }
     if ($c9 > 0) {
       $critico9 = number_format((($critico009/$c9)*100),0,",",".");
     } else {
      $critico9 = 0;
    }


     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

     $normal010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $alarme010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $critico010 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataAnt9])
                            ->count('preditiva_analises.status_id');

     $n10 = ($normal010+$alarme010+$critico010);
     $a10 = ($normal010+$alarme010+$critico010);
     $c10 = ($normal010+$alarme010+$critico010);

     if ($n10 > 0) {
       $normal10 = number_format((($normal010/$n10)*100),0,",",".");
     } else {
      $normal10 = 0;
    }
     if ($a10 > 0) {
       $alarme10 = number_format((($alarme010/$a10)*100),0,",",".");
     } else {
      $alarme10 = 0;
    }
     if ($c10 > 0) {
       $critico10 = number_format((($critico010/$c10)*100),0,",",".");
     } else {
      $critico10 = 0;
    }


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

     $normal011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $alarme011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $critico011 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataAnt10])
                            ->count('preditiva_analises.status_id');

     $n11 = ($normal011+$alarme011+$critico011);
     $a11 = ($normal011+$alarme011+$critico011);
     $c11 = ($normal011+$alarme011+$critico011);

     if ($n11 > 0) {
       $normal11 = number_format((($normal011/$n11)*100),0,",",".");
     } else {
      $normal11 = 0;
    }
     if ($a11 > 0) {
       $alarme11 = number_format((($alarme011/$a11)*100),0,",",".");
     } else {
      $alarme11 = 0;
    }
     if ($c11 > 0) {
       $critico11 = number_format((($critico011/$c11)*100),0,",",".");
     } else {
      $critico11 = 0;
    }


     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

     $normal012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',3)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $alarme012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',4)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $critico012 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.status_id','=',5)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataAnt11])
                            ->count('preditiva_analises.status_id');

     $n12 = ($normal012+$alarme012+$critico012);
     $a12 = ($normal012+$alarme012+$critico012);
     $c12 = ($normal012+$alarme012+$critico012);

     if ($n12 > 0) {
       $normal12 = number_format((($normal012/$n12)*100),0,",",".");
     } else {
      $normal12 = 0;
    }
     if ($a12 > 0) {
       $alarme12 = number_format((($alarme012/$a12)*100),0,",",".");
     } else {
      $alarme12 = 0;
    }
     if ($c12 > 0) {
       $critico12 = number_format((($critico012/$c12)*100),0,",",".");
     } else {
      $critico12 = 0;
    }
     return view('csn.relatorioGerencial.includes.relatoriosOleo.pr-statusPontos')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('normal1', $normal1)->with('alarme1', $alarme1)->with('critico1', $critico1)
       ->with('dataFAnt2', $dataFAnt2)->with('normal2', $normal2)->with('alarme2', $alarme2)->with('critico2', $critico2)
       ->with('dataFAnt3', $dataFAnt3)->with('normal3', $normal3)->with('alarme3', $alarme3)->with('critico3', $critico3)
       ->with('dataFAnt4', $dataFAnt4)->with('normal4', $normal4)->with('alarme4', $alarme4)->with('critico4', $critico4)
       ->with('dataFAnt5', $dataFAnt5)->with('normal5', $normal5)->with('alarme5', $alarme5)->with('critico5', $critico5)
       ->with('dataFAnt6', $dataFAnt6)->with('normal6', $normal6)->with('alarme6', $alarme6)->with('critico6', $critico6)
       ->with('dataFAnt7', $dataFAnt7)->with('normal7', $normal7)->with('alarme7', $alarme7)->with('critico7', $critico7)
       ->with('dataFAnt8', $dataFAnt8)->with('normal8', $normal8)->with('alarme8', $alarme8)->with('critico8', $critico8)
       ->with('dataFAnt9', $dataFAnt9)->with('normal9', $normal9)->with('alarme9', $alarme9)->with('critico9', $critico9)
       ->with('dataFAnt10', $dataFAnt10)->with('normal10', $normal10)->with('alarme10', $alarme10)->with('critico10', $critico10)
       ->with('dataFAnt11', $dataFAnt11)->with('normal11', $normal11)->with('alarme11', $alarme11)->with('critico11', $critico11)
       ->with('dataFAnt12', $dataFAnt12)->with('normal12', $normal12)->with('alarme12', $alarme12)->with('critico12', $critico12);

   }

   public function PrProblemasEncontrados()
   {

          $title = 'LDS';
     $tecnica = DB::table('tecnicas')->where('id', '<', 6)->value("name_tecnica","id");
     //data do sistema
     $atual = Carbon::now();
     $atualInicial = $atual->toDateString();

     $atual1 = Carbon::now();
     $dataAnt1 = $atual1->subMonths(1);
     $dataFAnt1 = $dataAnt1->toDateString();

     $agua1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste1 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt1, $atualInicial])
                            ->count('preditiva_analises.diagnostico_id');


     $atual2 = Carbon::now();
     $dataAnt2 = $atual2->subMonths(2);
     $dataFAnt2 = $dataAnt2->toDateString();

     $agua2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste2 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt2, $dataFAnt1])
                            ->count('preditiva_analises.diagnostico_id');



     $atual3 = Carbon::now();
     $dataAnt3 = $atual3->subMonths(3);
     $dataFAnt3 = $dataAnt3->toDateString();

     $agua3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste3 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt3, $dataFAnt2])
                            ->count('preditiva_analises.diagnostico_id');

     $atual4 = Carbon::now();
     $dataAnt4 = $atual4->subMonths(4);
     $dataFAnt4 = $dataAnt4->toDateString();

     $agua4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste4 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt4, $dataFAnt3])
                            ->count('preditiva_analises.diagnostico_id');

     $atual5 = Carbon::now();
     $dataAnt5 = $atual5->subMonths(5);
     $dataFAnt5 = $dataAnt5->toDateString();


      $agua5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste5 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt5, $dataFAnt4])
                            ->count('preditiva_analises.diagnostico_id');


     $atual6 = Carbon::now();
     $dataAnt6 = $atual6->subMonths(6);
     $dataFAnt6 = $dataAnt6->toDateString();


     $agua6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste6 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt6, $dataFAnt5])
                            ->count('preditiva_analises.diagnostico_id');

     $atual7 = Carbon::now();
     $dataAnt7 = $atual7->subMonths(7);
     $dataFAnt7 = $dataAnt7->toDateString();


      $agua7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste7 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt7, $dataFAnt6])
                            ->count('preditiva_analises.diagnostico_id');



     $atual8 = Carbon::now();
     $dataAnt8 = $atual8->subMonths(8);
     $dataFAnt8 = $dataAnt8->toDateString();

     $agua8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste8 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt8, $dataFAnt7])
                            ->count('preditiva_analises.diagnostico_id');


     $atual9 = Carbon::now();
     $dataAnt9 = $atual9->subMonths(9);
     $dataFAnt9 = $dataAnt9->toDateString();

     $agua9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste9 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt9, $dataFAnt8])
                            ->count('preditiva_analises.diagnostico_id');



     $atual10 = Carbon::now();
     $dataAnt10 = $atual10->subMonths(10);
     $dataFAnt10 = $dataAnt10->toDateString();

      $agua10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste10 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt10, $dataFAnt9])
                            ->count('preditiva_analises.diagnostico_id');


     $atual11 = Carbon::now();
     $dataAnt11 = $atual11->subMonths(11);
     $dataFAnt11 = $dataAnt11->toDateString();

      $agua11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                             ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste11 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt11, $dataFAnt10])
                            ->count('preditiva_analises.diagnostico_id');



     $atual12 = Carbon::now();
     $dataAnt12 = $atual12->subMonths(12);
     $dataFAnt12 = $dataAnt12->toDateString();

      $agua12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 17)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $particulado12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 18)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $viscosidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 19)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $demulsibilidade12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 20)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');

     $desgaste12 = DB::table('preditiva_analises')
                            ->join('preditiva_atividades', 'preditiva_atividades.id', '=', 'preditiva_analises.atividade_id')
                            ->join('ativos', 'ativos.id', '=', 'preditiva_atividades.ativo_id')
                            ->join('sistemas', 'sistemas.id', '=', 'ativos.sistema_id')
                            ->join('negocios', 'negocios.id', '=', 'sistemas.negocio_id')
                            ->whereBetween('negocios.id', [28, 41])
                            ->where('preditiva_analises.diagnostico_id', '=', 21)
                            ->where('preditiva_analises.tecnicas_id','=',4)
                            ->whereBetween('date_analise', [$dataFAnt12, $dataFAnt11])
                            ->count('preditiva_analises.diagnostico_id');




     return view('csn.relatorioGerencial.includes.relatoriosOleo.pr-problemasEncontrados')
       ->with('title', $title)->with('tecnica', $tecnica)->with('atualInicial', $atualInicial)
       ->with('dataFAnt1', $dataFAnt1)->with('agua1', $agua1)->with('particulado1', $particulado1)->with('viscosidade1', $viscosidade1)->with('demulsibilidade1', $demulsibilidade1)->with('desgaste1', $desgaste1)
       ->with('dataFAnt2', $dataFAnt2)->with('agua2', $agua2)->with('particulado2', $particulado2)->with('viscosidade2', $viscosidade2)->with('demulsibilidade2', $demulsibilidade2)->with('desgaste2', $desgaste2)
       ->with('dataFAnt3', $dataFAnt3)->with('agua3', $agua3)->with('particulado3', $particulado3)->with('viscosidade3', $viscosidade3)->with('demulsibilidade3', $demulsibilidade3)->with('desgaste3', $desgaste3)
       ->with('dataFAnt4', $dataFAnt4)->with('agua4', $agua4)->with('particulado4', $particulado4)->with('viscosidade4', $viscosidade4)->with('demulsibilidade4', $demulsibilidade4)->with('desgaste4', $desgaste4)
       ->with('dataFAnt5', $dataFAnt5)->with('agua5', $agua5)->with('particulado5', $particulado5)->with('viscosidade5', $viscosidade5)->with('demulsibilidade5', $demulsibilidade5)->with('desgaste5', $desgaste5)
       ->with('dataFAnt6', $dataFAnt6)->with('agua6', $agua6)->with('particulado6', $particulado6)->with('viscosidade6', $viscosidade6)->with('demulsibilidade6', $demulsibilidade6)->with('desgaste6', $desgaste6)
       ->with('dataFAnt7', $dataFAnt7)->with('agua7', $agua7)->with('particulado7', $particulado7)->with('viscosidade7', $viscosidade7)->with('demulsibilidade7', $demulsibilidade7)->with('desgaste7', $desgaste7)
       ->with('dataFAnt8', $dataFAnt8)->with('agua8', $agua8)->with('particulado8', $particulado8)->with('viscosidade8', $viscosidade8)->with('demulsibilidade8', $demulsibilidade8)->with('desgaste8', $desgaste8)
       ->with('dataFAnt9', $dataFAnt9)->with('agua9', $agua9)->with('particulado9', $particulado9)->with('viscosidade9', $viscosidade9)->with('demulsibilidade9', $demulsibilidade9)->with('desgaste9', $desgaste9)
       ->with('dataFAnt10', $dataFAnt10)->with('agua10', $agua10)->with('particulado10', $particulado10)->with('viscosidade10', $viscosidade10)->with('demulsibilidade10', $demulsibilidade10)->with('desgaste10', $desgaste10)
       ->with('dataFAnt11', $dataFAnt11)->with('agua11', $agua11)->with('particulado11', $particulado11)->with('viscosidade11', $viscosidade11)->with('demulsibilidade11', $demulsibilidade11)->with('desgaste11', $desgaste11)
       ->with('dataFAnt12', $dataFAnt12)->with('agua12', $agua12)->with('particulado12', $particulado12)->with('viscosidade12', $viscosidade12)->with('demulsibilidade12', $demulsibilidade12)->with('desgaste12', $desgaste12);
   }
}
//==========================================fim=================================================================
